<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <title>2022 CryptoCTF | Van1sh的小屋</title>
  <meta name="keywords" content>
  <meta name="description" content="2022 CryptoCTF | Van1sh的小屋">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="&amp;emsp;&amp;emsp; Van1sh，也用ID：V、Vanish，主要是有的网站昵称至少两个字符，Vanish也容易被注册&amp;emsp;现就读于杭州电子科技大学。是一只究极大菜鸡加懒狗。自2019.2.14的2019Hctf-Game接触CTF，由于零基础，目前还菜的一批，可能还会继续菜下去。现在还只会做一点Crypto方向的题，其他什么Web，Pwn，Reverse, Misc….俺都不知道。">
<meta property="og:type" content="website">
<meta property="og:title" content="Van1sh的小屋">
<meta property="og:url" content="http://jayxv.github.io/about/index.html">
<meta property="og:site_name" content="Van1sh的小屋">
<meta property="og:description" content="&amp;emsp;&amp;emsp; Van1sh，也用ID：V、Vanish，主要是有的网站昵称至少两个字符，Vanish也容易被注册&amp;emsp;现就读于杭州电子科技大学。是一只究极大菜鸡加懒狗。自2019.2.14的2019Hctf-Game接触CTF，由于零基础，目前还菜的一批，可能还会继续菜下去。现在还只会做一点Crypto方向的题，其他什么Web，Pwn，Reverse, Misc….俺都不知道。">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-04-30T11:44:36.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Van1sh的小屋">
<meta name="twitter:description" content="&amp;emsp;&amp;emsp; Van1sh，也用ID：V、Vanish，主要是有的网站昵称至少两个字符，Vanish也容易被注册&amp;emsp;现就读于杭州电子科技大学。是一只究极大菜鸡加懒狗。自2019.2.14的2019Hctf-Game接触CTF，由于零基础，目前还菜的一批，可能还会继续菜下去。现在还只会做一点Crypto方向的题，其他什么Web，Pwn，Reverse, Misc….俺都不知道。">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.0.1" rel="stylesheet">

<link href="/css/hl_theme/sublime.css?v=1.0.1" rel="stylesheet">

<link href="//cdn.bootcss.com/animate.css/3.5.2/animate.min.css" rel="stylesheet">
<link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="/js/jquery.autocomplete.min.js?v=1.0.1"></script>

<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script>



<script src="//cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>

<script src="/js/iconfont.js?v=1.0.1"></script>

</head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="false">
  <input class="theme_blog_path" value>
</div>

<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/" class="avatar_target">
    <img class="avatar" src="/img/avatar.jpg" />
</a>
<div class="author">
    <span>Van1sh</span>
</div>

<div class="icon">
    
        
    
        
        <a title="github" href="https://github.com/JayxV" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-github"></use>
                </svg>
            
        </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a title="email" href="mailto:643713081@qq.com" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-email"></use>
                </svg>
            
        </a>
        
    
        
        <a title="qq" href="http://wpa.qq.com/msgrd?v=3&uin=643713081&site=qq&menu=yes" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-qq"></use>
                </svg>
            
        </a>
        
    
        
    
        
    
</div>




<ul>
    <li><div class="all active">全部文章<small>(57)</small></div></li>
    
        
            
            <li><div data-rel="比赛小屋">比赛小屋<small>(18)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="工具小屋">工具小屋<small>(5)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="合约小屋"><i class="fold iconfont icon-right"></i>合约小屋<small>(8)</small></div>
                
                    <ul class="sub hide">
                        
                        <li><div data-rel="contract">contract<small>(6)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="区块链靶场">区块链靶场<small>(1)</small></div>
                            
                        </li>
                            
                    </ul>
                
            </li>
            
        
    
        
            
            <li><div data-rel="密码小屋"><i class="fold iconfont icon-right"></i>密码小屋<small>(17)</small></div>
                
                    <ul class="sub hide">
                        
                        <li><div data-rel="ECC">ECC<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="Paillier">Paillier<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="Lattice">Lattice<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="Stream">Stream<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="Knapsack">Knapsack<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="Rsa">Rsa<small>(3)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="Block">Block<small>(3)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="Basic">Basic<small>(2)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="CTF">CTF<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="RSA">RSA<small>(1)</small></div>
                            
                        </li>
                            
                    </ul>
                
            </li>
            
        
    
        
            
        
    
        
            
            <li><div data-rel="协议小屋">协议小屋<small>(2)</small></div>
                
            </li>
            
        
    
        
            
        
    
        
            
        
    
        
            
            <li><div data-rel="Web小屋"><i class="fold iconfont icon-right"></i>Web小屋<small>(3)</small></div>
                
                    <ul class="sub hide">
                        
                        <li><div data-rel="Files related">Files related<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="SQL">SQL<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="XSS">XSS<small>(1)</small></div>
                            
                        </li>
                            
                    </ul>
                
            </li>
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
            <li><div data-rel="论文小屋">论文小屋<small>(1)</small></div>
                
            </li>
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
            <li><div data-rel="逆向小屋"><i class="fold iconfont icon-right"></i>逆向小屋<small>(1)</small></div>
                
                    <ul class="sub hide">
                        
                        <li><div data-rel="patch">patch<small>(1)</small></div>
                            
                        </li>
                            
                    </ul>
                
            </li>
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
            <li><div data-rel="漏洞小屋">漏洞小屋<small>(1)</small></div>
                
            </li>
            
        
    
        
            
        
    
        
            
        
    
        
            
            <li><div data-rel="小书屋">小书屋<small>(1)</small></div>
                
            </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
    
    
    
    
    </div>
    <div><a class="about  hasFriend  site_url"  href="/about">关于</a><a style="width: 50%"  class="friends">友链</a></div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="57">
<input type="hidden" id="yelog_site_word_count" value="270.8k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        友情链接
        <i class="back-title-list"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="http://www.fzwjscj.xyz/">fzwjscj</a></li>
            
            <li><a target="_blank" href="http://dldxz.cn/">DLDXZ</a></li>
            
            <li><a target="_blank" href="http://fanda.cloud/">fanda</a></li>
            
            <li><a target="_blank" href="http://passingfoam.com/">PassingFoam&#39;s blog</a></li>
            
            <li><a target="_blank" href="https://eqqie.cn/">赤道企鹅</a></li>
            
            <li><a target="_blank" href="http://blog.ragdoll.work/">咲夜南梦</a></li>
            
            <li><a target="_blank" href="https://www.zhaoj.in/">glzjin</a></li>
            
            <li><a target="_blank" href="https://coinc1dens.github.io/">Coinc1dens</a></li>
            
            <li><a target="_blank" href="http://blog.soreatu.com/">soreatu</a></li>
            
            <li><a target="_blank" href="http://www.ga1axy.top/">盖乐希</a></li>
            
            <li><a target="_blank" href="https://shawroot.cc/">Root.</a></li>
            
            <li><a target="_blank" href="https://l1near.top/">l1near</a></li>
            
            <li><a target="_blank" href="https://0xdktb.top/">0xDktb</a></li>
            
            <li><a target="_blank" href="https://www.wootec.top/">Reverier</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <form onkeydown="if(event.keyCode === 13){return false;}">
        <input id="local-search-input" class="search" type="text" placeholder="以 in: 开头进行全文搜索" />
        <i class="cross"></i>
        <span>
            <label for="tagswitch">Tags:</label>
            <input id="tagswitch" type="checkbox" style="display: none" />
            <i id="tagsWitchIcon"></i>
        </span>
    </form>
    <div class="tags-list">
    
    <li class="article-tag-list-item">
        <a class="color4">Write Up</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color2">docker</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">Sage</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">CTF</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">ECC</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">TLS 1.2</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color2">Crypto</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">Paillier</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">Web</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">Files</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">Serialization</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">Lattice</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">Dsa</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">LCG</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">Rc4</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">SM4</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">paper</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">small private exponent</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">SQL</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color2">python</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">Knapsack</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">Rsa</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">continued_fraction</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">RE</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">DES</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color2">差分密码分析</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">操作模式</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">number theory</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color2">Abstract algebra</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">ETH</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">SPN</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color2">线性密码分析</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">Book</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color2">Shadowsocks</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">Nmap</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">XSS</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">Linux</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">Coppersmith’s Method</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">book</a>
    </li>
    
    <div class="clearfix"></div>
</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        <a id="top" class="密码小屋 Basic "
           href="/2020/05/27/密码学学习笔记之introduction to mathematical cryptography/"
           data-tag="Book"
           data-author="Van1sh" >
            <span class="post-title" title="密码学学习笔记 之 introduction to mathematical cryptography">密码学学习笔记 之 introduction to mathematical cryptography</span>
            <span class="post-date" title="2020-05-27 21:05:00">2020/05/27</span>
        </a>
        
        <a  class="漏洞小屋 "
           href="/2023/01/30/Shadowsocks Redirect Attack/"
           data-tag="Shadowsocks"
           data-author="Van1sh" >
            <span class="post-title" title="Shadowsocks Redirect Attack">Shadowsocks Redirect Attack</span>
            <span class="post-date" title="2023-01-30 17:14:00">2023/01/30</span>
        </a>
        
        <a  class="协议小屋 "
           href="/2022/12/15/TLS1.2协议分析（二）/"
           data-tag="TLS 1.2"
           data-author="Van1sh" >
            <span class="post-title" title="TLS 1.2 协议（二）">TLS 1.2 协议（二）</span>
            <span class="post-date" title="2022-12-15 10:24:00">2022/12/15</span>
        </a>
        
        <a  class="协议小屋 "
           href="/2022/12/08/TLS1.2协议分析（一）/"
           data-tag="TLS 1.2"
           data-author="Van1sh" >
            <span class="post-title" title="TLS 1.2 协议（一）">TLS 1.2 协议（一）</span>
            <span class="post-date" title="2022-12-08 21:10:00">2022/12/08</span>
        </a>
        
        <a  class="密码小屋 "
           href="/2022/11/15/密码学学习笔记之连分数/"
           data-tag="continued_fraction"
           data-author="Van1sh" >
            <span class="post-title" title="密码学学习笔记之连分数">密码学学习笔记之连分数</span>
            <span class="post-date" title="2022-11-15 17:59:00">2022/11/15</span>
        </a>
        
        <a  class="论文小屋 "
           href="/2022/10/17/Generalization of Some Attacks on RSA with Small Prime Combination and Small Private Exponent/"
           data-tag="paper,small private exponent"
           data-author="Van1sh" >
            <span class="post-title" title="Generalization of Some Attacks on RSA with Small Prime Combination and Small Private Exponent">Generalization of Some Attacks on RSA with Small Prime Combination and Small Private Exponent</span>
            <span class="post-date" title="2022-10-17 15:31:00">2022/10/17</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2022/09/14/2022 cryptoctf/"
           data-tag=""
           data-author="Van1sh" >
            <span class="post-title" title="2022 CryptoCTF">2022 CryptoCTF</span>
            <span class="post-date" title="2022-09-14 17:16:00">2022/09/14</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2022/08/30/2021 cryptoctf/"
           data-tag=""
           data-author="Van1sh" >
            <span class="post-title" title="2021 CryptoCTF">2021 CryptoCTF</span>
            <span class="post-date" title="2022-08-30 13:30:00">2022/08/30</span>
        </a>
        
        <a  class="合约小屋 contract "
           href="/2022/06/29/区块链学习笔记之2022ACTF-bet2loss/"
           data-tag="CTF"
           data-author="Van1sh" >
            <span class="post-title" title="区块链学习笔记之2022ACTF—bet2loss">区块链学习笔记之2022ACTF—bet2loss</span>
            <span class="post-date" title="2022-06-29 15:23:00">2022/06/29</span>
        </a>
        
        <a  class="合约小屋 contract "
           href="/2022/04/19/区块链学习笔记之2022starCTF/"
           data-tag="CTF"
           data-author="Van1sh" >
            <span class="post-title" title="区块链学习笔记之2022starCTF——TreasureHunter">区块链学习笔记之2022starCTF——TreasureHunter</span>
            <span class="post-date" title="2022-04-19 15:23:00">2022/04/19</span>
        </a>
        
        <a  class="合约小屋 区块链靶场 "
           href="/2022/03/08/区块链靶场刷题之cpaturetheether/"
           data-tag="CTF"
           data-author="Van1sh" >
            <span class="post-title" title="cpature the ether">cpature the ether</span>
            <span class="post-date" title="2022-03-08 11:03:00">2022/03/08</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2022/02/28/2022 SUSCTF/"
           data-tag="Write Up"
           data-author="Van1sh" >
            <span class="post-title" title="2022 SUSCTF">2022 SUSCTF</span>
            <span class="post-date" title="2022-02-28 11:18:35">2022/02/28</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2022/02/22/2021TQLCTF/"
           data-tag="Write Up"
           data-author="Van1sh" >
            <span class="post-title" title="2022 TQLCTF">2022 TQLCTF</span>
            <span class="post-date" title="2022-02-22 22:22:22">2022/02/22</span>
        </a>
        
        <a  class="合约小屋 contract "
           href="/2022/02/18/区块链学习笔记之BalsnCTF 2019 Bank/"
           data-tag="CTF"
           data-author="Van1sh" >
            <span class="post-title" title="区块链学习笔记之Balsn CTF 2019 - Bank">区块链学习笔记之Balsn CTF 2019 - Bank</span>
            <span class="post-date" title="2022-02-18 14:45:00">2022/02/18</span>
        </a>
        
        <a  class="合约小屋 contract "
           href="/2022/02/15/区块链学习笔记之BalsnCTF 2020 IdleGame/"
           data-tag="CTF"
           data-author="Van1sh" >
            <span class="post-title" title="区块链学习笔记之BalsnCTF 2020 IdleGame">区块链学习笔记之BalsnCTF 2020 IdleGame</span>
            <span class="post-date" title="2022-02-15 15:39:00">2022/02/15</span>
        </a>
        
        <a  class="合约小屋 contract "
           href="/2022/02/11/区块链学习笔记之paradigm-CTF babysandbox/"
           data-tag="CTF"
           data-author="Van1sh" >
            <span class="post-title" title="区块链学习笔记之paradigm-CTF babysandbox">区块链学习笔记之paradigm-CTF babysandbox</span>
            <span class="post-date" title="2022-02-11 16:22:00">2022/02/11</span>
        </a>
        
        <a  class="合约小屋 contract "
           href="/2022/01/23/区块链学习笔记之RealWorld体验赛/"
           data-tag="CTF"
           data-author="Van1sh" >
            <span class="post-title" title="区块链学习笔记之RealWorld体验赛——TransferFrom">区块链学习笔记之RealWorld体验赛——TransferFrom</span>
            <span class="post-date" title="2022-01-23 00:11:00">2022/01/23</span>
        </a>
        
        <a  class="合约小屋 "
           href="/2021/12/22/区块链学习笔记之初探以太坊/"
           data-tag="ETH"
           data-author="Van1sh" >
            <span class="post-title" title="区块链学习笔记之初探以太坊">区块链学习笔记之初探以太坊</span>
            <span class="post-date" title="2021-12-22 10:16:00">2021/12/22</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2021/08/23/2021 祥云杯/"
           data-tag="Write Up"
           data-author="Van1sh" >
            <span class="post-title" title="2021 祥云杯">2021 祥云杯</span>
            <span class="post-date" title="2021-08-23 14:07:00">2021/08/23</span>
        </a>
        
        <a  class="密码小屋 Block "
           href="/2021/08/06/密码学学习笔记之线性分析入门篇——EzSPN/"
           data-tag="SPN,线性密码分析"
           data-author="Van1sh" >
            <span class="post-title" title="密码学学习笔记 之 线性分析入门篇——EzSPN">密码学学习笔记 之 线性分析入门篇——EzSPN</span>
            <span class="post-date" title="2021-08-06 09:24:25">2021/08/06</span>
        </a>
        
        <a  class="密码小屋 Block "
           href="/2021/07/16/密码学学习笔记之差分分析入门篇——四轮DES/"
           data-tag="DES,差分密码分析"
           data-author="Van1sh" >
            <span class="post-title" title="密码学学习笔记 之 差分分析入门篇——四轮DES">密码学学习笔记 之 差分分析入门篇——四轮DES</span>
            <span class="post-date" title="2021-07-16 09:24:25">2021/07/16</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2021/04/04/2021HFCTF/"
           data-tag="Write Up"
           data-author="Van1sh" >
            <span class="post-title" title="2021 HFCTF">2021 HFCTF</span>
            <span class="post-date" title="2021-04-04 11:02:47">2021/04/04</span>
        </a>
        
        <a  class="逆向小屋 patch "
           href="/2021/03/27/逆向学习笔记之drinkSomeTea/"
           data-tag="RE"
           data-author="Van1sh" >
            <span class="post-title" title="逆向学习笔记 之 drinkSomeTea">逆向学习笔记 之 drinkSomeTea</span>
            <span class="post-date" title="2021-03-27 19:22:00">2021/03/27</span>
        </a>
        
        <a  class="密码小屋 "
           href="/2021/01/01/密码学学习笔记之密码学随笔/"
           data-tag="Crypto"
           data-author="Van1sh" >
            <span class="post-title" title="密码学学习笔记 之 密码学随笔">密码学学习笔记 之 密码学随笔</span>
            <span class="post-date" title="2021-01-01 00:00:00">2021/01/01</span>
        </a>
        
        <a  class="密码小屋 RSA "
           href="/2020/12/18/密码学学习笔记之RSA的一些套路/"
           data-tag="Rsa"
           data-author="Van1sh" >
            <span class="post-title" title="密码学学习笔记 之 RSA的一些套路">密码学学习笔记 之 RSA的一些套路</span>
            <span class="post-date" title="2020-12-18 14:32:00">2020/12/18</span>
        </a>
        
        <a  class="密码小屋 CTF "
           href="/2020/12/18/密码学学习笔记之CTF/"
           data-tag="CTF"
           data-author="Van1sh" >
            <span class="post-title" title="密码学学习笔记 之 CTF">密码学学习笔记 之 CTF</span>
            <span class="post-date" title="2020-12-18 00:00:00">2020/12/18</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2020/12/10/2020RoarCTF/"
           data-tag="Write Up"
           data-author="Van1sh" >
            <span class="post-title" title="2020 RoarCTF">2020 RoarCTF</span>
            <span class="post-date" title="2020-12-10 10:00:00">2020/12/10</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2020/11/04/2020ByteCTF&X-NUCA部分密码学题解/"
           data-tag="Write Up"
           data-author="Van1sh" >
            <span class="post-title" title="2020 ByteCTF&amp;X-NUCA">2020 ByteCTF&amp;X-NUCA</span>
            <span class="post-date" title="2020-11-04 10:00:00">2020/11/04</span>
        </a>
        
        <a  class="密码小屋 Rsa "
           href="/2020/08/13/密码学学习笔记之coppersmith/"
           data-tag="Coppersmith’s Method"
           data-author="Van1sh" >
            <span class="post-title" title="密码学学习笔记 之 Coppersmith’s Method">密码学学习笔记 之 Coppersmith’s Method</span>
            <span class="post-date" title="2020-08-13 10:00:00">2020/08/13</span>
        </a>
        
        <a  class="Web小屋 Files related "
           href="/2020/08/09/Web学习笔记之文件与序列化/"
           data-tag="Web,Files,Serialization"
           data-author="Van1sh" >
            <span class="post-title" title="Web学习笔记 之 文件与序列化">Web学习笔记 之 文件与序列化</span>
            <span class="post-date" title="2020-08-09 14:16:00">2020/08/09</span>
        </a>
        
        <a  class="Web小屋 SQL "
           href="/2020/08/07/Web学习笔记之SQL注入/"
           data-tag="Web,SQL"
           data-author="Van1sh" >
            <span class="post-title" title="Web学习笔记 之 SQL注入">Web学习笔记 之 SQL注入</span>
            <span class="post-date" title="2020-08-07 13:18:00">2020/08/07</span>
        </a>
        
        <a  class="Web小屋 XSS "
           href="/2020/07/26/Web学习笔记之XSS/"
           data-tag="Web,XSS"
           data-author="Van1sh" >
            <span class="post-title" title="Web学习笔记 之 XSS">Web学习笔记 之 XSS</span>
            <span class="post-date" title="2020-07-26 10:44:00">2020/07/26</span>
        </a>
        
        <a  class="密码小屋 Knapsack "
           href="/2020/06/08/密码学学习笔记之knapsack/"
           data-tag="Knapsack"
           data-author="Van1sh" >
            <span class="post-title" title="密码学学习笔记 之 knapsack">密码学学习笔记 之 knapsack</span>
            <span class="post-date" title="2020-06-08 10:30:43">2020/06/08</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2020/05/26/2020BJD3rd/"
           data-tag="Write Up"
           data-author="Van1sh &amp; FzWjScJ" >
            <span class="post-title" title="2020 BJD3rd">2020 BJD3rd</span>
            <span class="post-date" title="2020-05-26 16:00:47">2020/05/26</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2020/05/24/2020GKCTF/"
           data-tag="Write Up"
           data-author="Van1sh" >
            <span class="post-title" title="2020 GKCTF">2020 GKCTF</span>
            <span class="post-date" title="2020-05-24 17:05:00">2020/05/24</span>
        </a>
        
        <a  class="工具小屋 "
           href="/2020/05/20/sage常用命令/"
           data-tag="Sage"
           data-author="Van1sh" >
            <span class="post-title" title="sage常用命令">sage常用命令</span>
            <span class="post-date" title="2020-05-20 11:22:00">2020/05/20</span>
        </a>
        
        <a  class="密码小屋 Paillier "
           href="/2020/05/14/密码学学习笔记之paillier cryptosystem/"
           data-tag="Paillier"
           data-author="Van1sh" >
            <span class="post-title" title="密码学学习笔记 之 paillier cryptosystem">密码学学习笔记 之 paillier cryptosystem</span>
            <span class="post-date" title="2020-05-14 11:00:19">2020/05/14</span>
        </a>
        
        <a  class="密码小屋 Lattice "
           href="/2020/05/12/密码学学习笔记之HNP/"
           data-tag="Lattice,Dsa,LCG"
           data-author="Van1sh" >
            <span class="post-title" title="密码学学习笔记 之 HNP">密码学学习笔记 之 HNP</span>
            <span class="post-date" title="2020-05-12 10:00:57">2020/05/12</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2020/05/10/2020网鼎杯/"
           data-tag="Write Up"
           data-author="Van1sh" >
            <span class="post-title" title="2020 网鼎杯">2020 网鼎杯</span>
            <span class="post-date" title="2020-05-10 21:15:00">2020/05/10</span>
        </a>
        
        <a  class="密码小屋 ECC "
           href="/2020/05/07/密码学学习笔记之NCCIP/"
           data-tag="ECC"
           data-author="Van1sh" >
            <span class="post-title" title="密码学学习笔记 之 NCCIP">密码学学习笔记 之 NCCIP</span>
            <span class="post-date" title="2020-05-07 10:30:43">2020/05/07</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2020/05/05/2020De1CTF/"
           data-tag="Write Up"
           data-author="Van1sh" >
            <span class="post-title" title="2020 De1CTF">2020 De1CTF</span>
            <span class="post-date" title="2020-05-05 15:57:00">2020/05/05</span>
        </a>
        
        <a  class="密码小屋 Block "
           href="/2020/03/03/密码学学习笔记之分组密码操作模式/"
           data-tag="操作模式"
           data-author="Van1sh" >
            <span class="post-title" title="密码学学习笔记 之 分组密码操作模式">密码学学习笔记 之 分组密码操作模式</span>
            <span class="post-date" title="2020-03-03 15:15:00">2020/03/03</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2020/02/18/2020hgame_week1/"
           data-tag="Write Up"
           data-author="Van1sh" >
            <span class="post-title" title="2020 hgame week1">2020 hgame week1</span>
            <span class="post-date" title="2020-02-18 16:22:35">2020/02/18</span>
        </a>
        
        <a  class="密码小屋 Stream "
           href="/2020/01/30/密码学学习笔记之RC4与SM4/"
           data-tag="Rc4,SM4"
           data-author="Van1sh" >
            <span class="post-title" title="密码学学习笔记 之 RC4与SM4">密码学学习笔记 之 RC4与SM4</span>
            <span class="post-date" title="2020-01-30 00:05:00">2020/01/30</span>
        </a>
        
        <a  class="密码小屋 Rsa "
           href="/2019/12/04/密码学学习笔记之浅析On r-th Root Extraction Algorithm in Fq/"
           data-tag="Rsa"
           data-author="Van1sh" >
            <span class="post-title" title="密码学学习笔记 之 浅析On r-th Root Extraction Algorithm in Fq">密码学学习笔记 之 浅析On r-th Root Extraction Algorithm in Fq</span>
            <span class="post-date" title="2019-12-04 14:30:46">2019/12/04</span>
        </a>
        
        <a  class="密码小屋 Basic "
           href="/2019/12/03/密码学学习笔记之数论四大定理及应用/"
           data-tag="number theory,Abstract algebra"
           data-author="Van1sh" >
            <span class="post-title" title="密码学学习笔记 之 数论四大定理及应用">密码学学习笔记 之 数论四大定理及应用</span>
            <span class="post-date" title="2019-12-03 15:30:25">2019/12/03</span>
        </a>
        
        <a  class="密码小屋 Rsa "
           href="/2019/11/11/密码学学习笔记之浅析Pollard's rho algorithm及其应用/"
           data-tag="Rsa"
           data-author="Van1sh" >
            <span class="post-title" title="密码学学习笔记 之 浅析Pollard&#39;s rho algorithm及其应用">密码学学习笔记 之 浅析Pollard&#39;s rho algorithm及其应用</span>
            <span class="post-date" title="2019-11-11 15:32:00">2019/11/11</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2019/11/08/2019UNCTF/"
           data-tag="Write Up"
           data-author="Van1sh" >
            <span class="post-title" title="2019 UNCTF">2019 UNCTF</span>
            <span class="post-date" title="2019-11-08 11:30:30">2019/11/08</span>
        </a>
        
        <a  class="工具小屋 "
           href="/2019/11/01/docker和docker-compose的安装/"
           data-tag="docker"
           data-author="Van1sh" >
            <span class="post-title" title="安装Docker 和 Docker-Compose以及docker images的制作及上传">安装Docker 和 Docker-Compose以及docker images的制作及上传</span>
            <span class="post-date" title="2019-11-01 21:00:00">2019/11/01</span>
        </a>
        
        <a  class="工具小屋 "
           href="/2019/09/12/Linux 基础/"
           data-tag="Linux"
           data-author="Vanish" >
            <span class="post-title" title="Linux 基础">Linux 基础</span>
            <span class="post-date" title="2019-09-12 00:17:00">2019/09/12</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2019/08/29/2019第五空间/"
           data-tag="Write Up"
           data-author="Van1sh" >
            <span class="post-title" title="2019 第五空间">2019 第五空间</span>
            <span class="post-date" title="2019-08-29 12:18:35">2019/08/29</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2019/08/27/2019OGeek/"
           data-tag="Write Up"
           data-author="Van1sh" >
            <span class="post-title" title="2019 OGeek">2019 OGeek</span>
            <span class="post-date" title="2019-08-27 11:02:35">2019/08/27</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2019/08/03/2019De1CTF/"
           data-tag="Write Up"
           data-author="Van1sh" >
            <span class="post-title" title="2019 De1CTF">2019 De1CTF</span>
            <span class="post-date" title="2019-08-03 22:14:55">2019/08/03</span>
        </a>
        
        <a  class="小书屋 "
           href="/2019/08/02/三体/"
           data-tag="book"
           data-author="Van1sh" >
            <span class="post-title" title="三体">三体</span>
            <span class="post-date" title="2019-08-02 12:56:00">2019/08/02</span>
        </a>
        
        <a  class="工具小屋 "
           href="/2019/07/22/nmap/"
           data-tag="Nmap"
           data-author="Van1sh" >
            <span class="post-title" title="初遇Nmap">初遇Nmap</span>
            <span class="post-date" title="2019-07-22 16:07:55">2019/07/22</span>
        </a>
        
        <a  class="工具小屋 "
           href="/2019/07/21/python 正则/"
           data-tag="python"
           data-author="Van1sh" >
            <span class="post-title" title="python 之 正则">python 之 正则</span>
            <span class="post-date" title="2019-07-21 22:30:35">2019/07/21</span>
        </a>
        
        <a  class="比赛小屋 "
           href="/2019/07/15/2019赛博杯/"
           data-tag="Write Up"
           data-author="Van1sh" >
            <span class="post-title" title="2019 赛博杯">2019 赛博杯</span>
            <span class="post-date" title="2019-07-15 16:22:35">2019/07/15</span>
        </a>
        
    </nav>
</div>
    </div>
    <div class="hide-list">
        <div class="semicircle">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div class="post">
    <div class="pjax">
        <article id="post-2022 cryptoctf" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">2022 CryptoCTF</h1>
    
    <div class="article-meta">
        
        
        <span class="author"><a>Van1sh</a></span>
        
        
        <span class="book">
            
                <a  data-rel="比赛小屋">比赛小屋</a>
            
        </span>
        
        
    </div>
    <div class="article-meta">
        
        创建时间:<time class="date" title='更新时间: 2023-01-31 16:22:22'>2022-09-14 17:16</time>
        
    </div>
    <div class="article-meta">
        
        <span>字数:16.8k</span>
        
        
        <span id="busuanzi_container_page_pv">
            阅读:<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#warm-up"><span class="toc-text">warm-up</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Mic-Check"><span class="toc-text">Mic-Check</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy"><span class="toc-text">easy</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Klamkin"><span class="toc-text">Klamkin</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#thought"><span class="toc-text">thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Baphomet"><span class="toc-text">Baphomet</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-1"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#thought-1"><span class="toc-text">thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-1"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-1"><span class="toc-text">result</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#medium-easy"><span class="toc-text">medium-easy</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SOTS"><span class="toc-text">SOTS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-2"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-2"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-2"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#polyRSA"><span class="toc-text">polyRSA</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-3"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-1"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-3"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-3"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Infinity-castle"><span class="toc-text">Infinity castle</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-4"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-2"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-4"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-4"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Keydream"><span class="toc-text">Keydream</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-5"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-3"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-5"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-5"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jeksign"><span class="toc-text">Jeksign</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-6"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-4"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-6"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-6"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Volgo"><span class="toc-text">Volgo</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-7"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-5"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-7"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-7"><span class="toc-text">result</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#medium"><span class="toc-text">medium</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Aniely"><span class="toc-text">Aniely</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-8"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-6"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-8"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-8"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Diploma"><span class="toc-text">Diploma</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-9"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-7"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-9"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-9"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Oak-land"><span class="toc-text">Oak land</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-10"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-8"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-10"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-10"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cantilever"><span class="toc-text">Cantilever</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-11"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-9"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-11"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-11"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Side-step"><span class="toc-text">Side step</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-12"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-10"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-12"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-12"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Faonsa"><span class="toc-text">Faonsa *</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-13"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-11"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-13"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-13"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Resign"><span class="toc-text">Resign</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-14"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-12"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-14"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-14"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DBB"><span class="toc-text">DBB</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-15"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-13"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-15"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-15"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fiercest"><span class="toc-text">Fiercest</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-16"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-14"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-16"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-16"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mino"><span class="toc-text">Mino *</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-17"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-15"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-17"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-17"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Starter-ECC"><span class="toc-text">Starter ECC</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-18"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-16"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-18"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-18"><span class="toc-text">result</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#medium-hard"><span class="toc-text">medium-hard</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Watery-soup"><span class="toc-text">Watery soup</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-19"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-17"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-19"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-19"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#313-Loyal"><span class="toc-text">313 Loyal</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-20"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-18"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-20"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-20"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Soda"><span class="toc-text">Soda*</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-21"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-19"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-21"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-21"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sparse"><span class="toc-text">Sparse*</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-22"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-20"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-22"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-22"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Larisa"><span class="toc-text">Larisa</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-23"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-21"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-23"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-23"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Shaim"><span class="toc-text">Shaim</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-24"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-22"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-24"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-24"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Lagima"><span class="toc-text">Lagima</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-25"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-23"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-25"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-25"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Versace"><span class="toc-text">Versace</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-26"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-24"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-26"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-26"><span class="toc-text">result</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hard"><span class="toc-text">hard</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GSDP"><span class="toc-text">GSDP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-27"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-25"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-27"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#result-27"><span class="toc-text">result</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Persian-cat"><span class="toc-text">Persian cat</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-28"><span class="toc-text">challenge</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought-26"><span class="toc-text">Thought</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-28"><span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NLCS-x"><span class="toc-text">NLCS x</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#challenge-29"><span class="toc-text">challenge</span></a></li></ol></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="warm-up"><a href="#warm-up" class="headerlink" title="warm-up"></a>warm-up</h2><h3 id="Mic-Check"><a href="#Mic-Check" class="headerlink" title="Mic-Check"></a>Mic-Check</h3><p>分值：19</p>
<p>考点：签到</p>
<p>Can you hear me?2022-Jul-Thu 12:20:26</p>
<p>If you can, enter your first flag:</p>
<figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CCTF&#123;Th3_B3sT_1S_Yet_t0_C0m3!!&#125;</span><br></pre></td></tr></table></figure>

<h2 id="easy"><a href="#easy" class="headerlink" title="easy"></a>easy</h2><h3 id="Klamkin"><a href="#Klamkin" class="headerlink" title="Klamkin"></a>Klamkin</h3><p>分值：61</p>
<p>考点：Congruence</p>
<h4 id="challenge"><a href="#challenge" class="headerlink" title="challenge"></a>challenge</h4><p>We need to have a correct solution!</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc <span class="number">04</span><span class="selector-class">.cr</span><span class="selector-class">.yp</span><span class="selector-class">.toc</span><span class="selector-class">.tf</span> <span class="number">13777</span></span><br></pre></td></tr></table></figure>

<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-<span class="number">0</span>-<span class="number">7</span>-centos ~]<span class="comment"># nc 04.cr.yp.toc.tf 13777</span></span><br><span class="line"><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span></span><br><span class="line"><span class="params">|  Hello, now we are finding the integer solution of two divisibility  |</span></span><br><span class="line"><span class="params">|  relation. In each stage send the requested solution. Have fun :)    |</span></span><br><span class="line"><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span></span><br><span class="line"><span class="params">| We know (ax + by) % q = 0 <span class="keyword">for</span> any (a, b) such that (ar + bs) % q = 0</span></span><br><span class="line"><span class="params">|</span> <span class="keyword">and</span> (q, r, s) are given!</span><br><span class="line"><span class="params">| Options: </span></span><br><span class="line"><span class="params">|</span>	[G]et the parameters </span><br><span class="line"><span class="params">|	[S]<span class="keyword">end</span> solution </span></span><br><span class="line"><span class="params">|</span>	[Q]uit</span><br><span class="line">G</span><br><span class="line"><span class="params">| q = 289932383341902531151841340632555887679</span></span><br><span class="line"><span class="params">|</span> r = <span class="number">197196838427345567639010598439485580615</span></span><br><span class="line"><span class="params">| s = 59132640739541526585077026866726580617</span></span><br><span class="line"><span class="params">|</span> <span class="symbol">Options:</span> </span><br><span class="line"><span class="params">|	[G]et the parameters </span></span><br><span class="line"><span class="params">|</span>	[S]<span class="keyword">end</span> solution </span><br><span class="line"><span class="params">|	[Q]uit</span></span><br><span class="line"><span class="params">S</span></span><br><span class="line"><span class="params">|</span> please send requested solution like x, y such that y is <span class="number">12</span>-<span class="symbol">bit:</span></span><br></pre></td></tr></table></figure>

<h4 id="thought"><a href="#thought" class="headerlink" title="thought"></a>thought</h4><h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def x(<span class="keyword">n</span>):</span><br><span class="line">    x = getPrime(<span class="keyword">n</span>)</span><br><span class="line">    y = -a*x*inverse(b,q) % <span class="built_in">q</span></span><br><span class="line">    <span class="keyword">assert</span> (a*x + b*y) % q == 0</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(x)+<span class="string">","</span>+str(y))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def <span class="built_in">y</span>(<span class="keyword">n</span>):</span><br><span class="line">    y = getPrime(<span class="keyword">n</span>)</span><br><span class="line">    x = -b*y*inverse(a,q) % <span class="built_in">q</span></span><br><span class="line">    <span class="keyword">assert</span> (a*x + b*y) % q == 0</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(x)+<span class="string">","</span>+str(y))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">sh</span> = remote(<span class="string">"04.cr.yp.toc.tf"</span>,13777)</span><br><span class="line">context.log_level = 'debug'</span><br><span class="line"></span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"[Q]uit"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">"G"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"| q = "</span>)</span><br><span class="line">q = int(<span class="keyword">sh</span>.recvuntil(<span class="string">"\n"</span>)[:-1])</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"| r = "</span>)</span><br><span class="line">r = int(<span class="keyword">sh</span>.recvuntil(<span class="string">"\n"</span>)[:-1])</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"| s = "</span>)</span><br><span class="line">s = int(<span class="keyword">sh</span>.recvuntil(<span class="string">"\n"</span>)[:-1])</span><br><span class="line"></span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"[Q]uit"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">"S"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    a = inverse(r,q)</span><br><span class="line">    b = inverse(-s,q)</span><br><span class="line">    <span class="keyword">assert</span> (a*r + b*s) % q == 0</span><br><span class="line"></span><br><span class="line">    ch = <span class="keyword">sh</span>.recvuntil(<span class="string">"bit: \n"</span>).<span class="keyword">split</span>(b<span class="string">" "</span>)</span><br><span class="line">    <span class="keyword">print</span>(ch)</span><br><span class="line">    <span class="keyword">if</span> ch[-4]== b<span class="string">"x"</span>:</span><br><span class="line">        x(int(ch[-2][:2]))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">y</span>(int(ch[-2][:2]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">sh</span>.interactive()</span><br></pre></td></tr></table></figure>

<h4 id="result"><a href="#result" class="headerlink" title="result"></a>result</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">[+] Opening connection to 04.cr.yp.toc.tf on port 13777: Done</span><br><span class="line">[DEBUG] Received 0xdb bytes:</span><br><span class="line">    b'||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n'</span><br><span class="line">    b'|  Hello, now we are finding the integer solution of two divisibility  |\n'</span><br><span class="line">    b'|  relation. In each stage send the requested solution. Have fun :)    |\n'</span><br><span class="line">[DEBUG] Received 0xeb bytes:</span><br><span class="line">    b'||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n'</span><br><span class="line">    b'| We know (ax + by) % q = 0 for any (a, b) such that (ar + bs) % q = 0\n'</span><br><span class="line">    b'| and (q, r, s) are given!\n'</span><br><span class="line">    b'| Options: \n'</span><br><span class="line">    b'|\t[G]et the parameters \n'</span><br><span class="line">    b'|\t[S]<span class="keyword">end</span> solution \n<span class="string">'</span></span><br><span class="line"><span class="string">    b'</span>|\t[Q]uit\n<span class="string">'</span></span><br><span class="line"><span class="string">[DEBUG] Sent 0x2 bytes:</span></span><br><span class="line"><span class="string">    b'</span>G\n<span class="string">'</span></span><br><span class="line"><span class="string">[DEBUG] Received 0xc7 bytes:</span></span><br><span class="line"><span class="string">    b'</span>| q = <span class="number">248930089074638341399935646008896010497</span>\n<span class="string">'</span></span><br><span class="line"><span class="string">    b'</span>| r = <span class="number">65697821096685931683761068135861058583</span>\n<span class="string">'</span></span><br><span class="line"><span class="string">    b'</span>| s = <span class="number">8664059547396611157411147813907067755</span>\n<span class="string">'</span></span><br><span class="line"><span class="string">    b'</span>| Options: \n<span class="string">'</span></span><br><span class="line"><span class="string">    b'</span>|\t[G]et the <span class="keyword">parameters</span> \n<span class="string">'</span></span><br><span class="line"><span class="string">    b'</span>|\t[S]<span class="keyword">end</span> solution \n<span class="string">'</span></span><br><span class="line"><span class="string">    b'</span>|\t[Q]uit\n<span class="string">'</span></span><br><span class="line"><span class="string">[DEBUG] Sent 0x2 bytes:</span></span><br><span class="line"><span class="string">    b'</span>S\n<span class="string">'</span></span><br><span class="line"><span class="string">[DEBUG] Received 0x43 bytes:</span></span><br><span class="line"><span class="string">    b'</span>| please send requested solution <span class="keyword">like</span> x, y such that y <span class="keyword">is</span> <span class="number">12</span>-<span class="built_in">bit</span>: \n<span class="string">'</span></span><br><span class="line"><span class="string">[b'</span>\n|<span class="string">', b'</span>please<span class="string">', b'</span>send<span class="string">', b'</span>requested<span class="string">', b'</span>solution<span class="string">', b'</span><span class="keyword">like</span><span class="string">', b'</span>x,<span class="string">', b'</span>y<span class="string">', b'</span>such<span class="string">', b'</span>that<span class="string">', b'</span>y<span class="string">', b'</span><span class="keyword">is</span><span class="string">', b'</span><span class="number">12</span>-<span class="built_in">bit</span>:<span class="string">', b'</span>\n<span class="string">']</span></span><br><span class="line"><span class="string">[DEBUG] Sent 0x2c bytes:</span></span><br><span class="line"><span class="string">    b'</span><span class="number">36385751892032159627624237030492875755</span>,<span class="number">3539</span>\n<span class="string">'</span></span><br><span class="line"><span class="string">[DEBUG] Received 0x72 bytes:</span></span><br><span class="line"><span class="string">    b'</span>| good job, try <span class="keyword">to</span> solve the <span class="keyword">next</span> challenge :P\n<span class="string">'</span></span><br><span class="line"><span class="string">    b'</span>| please send requested solution <span class="keyword">like</span> x, y such that y <span class="keyword">is</span> <span class="number">13</span>-<span class="built_in">bit</span>: \n<span class="string">'</span></span><br><span class="line"><span class="string">[b'</span>|<span class="string">', b'</span>good<span class="string">', b'</span>job,<span class="string">', b'</span>try<span class="string">', b'</span><span class="keyword">to</span><span class="string">', b'</span>solve<span class="string">', b'</span>the<span class="string">', b'</span><span class="keyword">next</span><span class="string">', b'</span>challenge<span class="string">', b'</span>:P\n|<span class="string">', b'</span>please<span class="string">', b'</span>send<span class="string">', b'</span>requested<span class="string">', b'</span>solution<span class="string">', b'</span><span class="keyword">like</span><span class="string">', b'</span>x,<span class="string">', b'</span>y<span class="string">', b'</span>such<span class="string">', b'</span>that<span class="string">', b'</span>y<span class="string">', b'</span><span class="keyword">is</span><span class="string">', b'</span><span class="number">13</span>-<span class="built_in">bit</span>:<span class="string">', b'</span>\n<span class="string">']</span></span><br><span class="line"><span class="string">[DEBUG] Sent 0x2d bytes:</span></span><br><span class="line"><span class="string">    b'</span><span class="number">134300229126114739440789160858242865128</span>,<span class="number">7993</span>\n<span class="string">'</span></span><br><span class="line"><span class="string">[DEBUG] Received 0x72 bytes:</span></span><br><span class="line"><span class="string">    b'</span>| good job, try <span class="keyword">to</span> solve the <span class="keyword">next</span> challenge :P\n<span class="string">'</span></span><br><span class="line"><span class="string">    b'</span>| please send requested solution <span class="keyword">like</span> x, y such that y <span class="keyword">is</span> <span class="number">16</span>-<span class="built_in">bit</span>: \n<span class="string">'</span></span><br><span class="line"><span class="string">[b'</span>|<span class="string">', b'</span>good<span class="string">', b'</span>job,<span class="string">', b'</span>try<span class="string">', b'</span><span class="keyword">to</span><span class="string">', b'</span>solve<span class="string">', b'</span>the<span class="string">', b'</span><span class="keyword">next</span><span class="string">', b'</span>challenge<span class="string">', b'</span>:P\n|<span class="string">', b'</span>please<span class="string">', b'</span>send<span class="string">', b'</span>requested<span class="string">', b'</span>solution<span class="string">', b'</span><span class="keyword">like</span><span class="string">', b'</span>x,<span class="string">', b'</span>y<span class="string">', b'</span>such<span class="string">', b'</span>that<span class="string">', b'</span>y<span class="string">', b'</span><span class="keyword">is</span><span class="string">', b'</span><span class="number">16</span>-<span class="built_in">bit</span>:<span class="string">', b'</span>\n<span class="string">']</span></span><br><span class="line"><span class="string">[DEBUG] Sent 0x2e bytes:</span></span><br><span class="line"><span class="string">    b'</span><span class="number">196535357683169499069413298376157574596</span>,<span class="number">49991</span>\n<span class="string">'</span></span><br><span class="line"><span class="string">[DEBUG] Received 0x72 bytes:</span></span><br><span class="line"><span class="string">    b'</span>| good job, try <span class="keyword">to</span> solve the <span class="keyword">next</span> challenge :P\n<span class="string">'</span></span><br><span class="line"><span class="string">    b'</span>| please send requested solution <span class="keyword">like</span> x, y such that x <span class="keyword">is</span> <span class="number">16</span>-<span class="built_in">bit</span>: \n<span class="string">'</span></span><br><span class="line"><span class="string">[b'</span>|<span class="string">', b'</span>good<span class="string">', b'</span>job,<span class="string">', b'</span>try<span class="string">', b'</span><span class="keyword">to</span><span class="string">', b'</span>solve<span class="string">', b'</span>the<span class="string">', b'</span><span class="keyword">next</span><span class="string">', b'</span>challenge<span class="string">', b'</span>:P\n|<span class="string">', b'</span>please<span class="string">', b'</span>send<span class="string">', b'</span>requested<span class="string">', b'</span>solution<span class="string">', b'</span><span class="keyword">like</span><span class="string">', b'</span>x,<span class="string">', b'</span>y<span class="string">', b'</span>such<span class="string">', b'</span>that<span class="string">', b'</span>x<span class="string">', b'</span><span class="keyword">is</span><span class="string">', b'</span><span class="number">16</span>-<span class="built_in">bit</span>:<span class="string">', b'</span>\n<span class="string">']</span></span><br><span class="line"><span class="string">[DEBUG] Sent 0x2e bytes:</span></span><br><span class="line"><span class="string">    b'</span><span class="number">36847</span>,<span class="number">229436344314746801153667328942317085633</span>\n<span class="string">'</span></span><br><span class="line"><span class="string">[DEBUG] Received 0x72 bytes:</span></span><br><span class="line"><span class="string">    b'</span>| good job, try <span class="keyword">to</span> solve the <span class="keyword">next</span> challenge :P\n<span class="string">'</span></span><br><span class="line"><span class="string">    b'</span>| please send requested solution <span class="keyword">like</span> x, y such that y <span class="keyword">is</span> <span class="number">19</span>-<span class="built_in">bit</span>: \n<span class="string">'</span></span><br><span class="line"><span class="string">[b'</span>|<span class="string">', b'</span>good<span class="string">', b'</span>job,<span class="string">', b'</span>try<span class="string">', b'</span><span class="keyword">to</span><span class="string">', b'</span>solve<span class="string">', b'</span>the<span class="string">', b'</span><span class="keyword">next</span><span class="string">', b'</span>challenge<span class="string">', b'</span>:P\n|<span class="string">', b'</span>please<span class="string">', b'</span>send<span class="string">', b'</span>requested<span class="string">', b'</span>solution<span class="string">', b'</span><span class="keyword">like</span><span class="string">', b'</span>x,<span class="string">', b'</span>y<span class="string">', b'</span>such<span class="string">', b'</span>that<span class="string">', b'</span>y<span class="string">', b'</span><span class="keyword">is</span><span class="string">', b'</span><span class="number">19</span>-<span class="built_in">bit</span>:<span class="string">', b'</span>\n<span class="string">']</span></span><br><span class="line"><span class="string">[DEBUG] Sent 0x2e bytes:</span></span><br><span class="line"><span class="string">    b'</span><span class="number">90733961161770834421760416122416141408</span>,<span class="number">462541</span>\n<span class="string">'</span></span><br><span class="line"><span class="string">[DEBUG] Received 0x4e bytes:</span></span><br><span class="line"><span class="string">    b'</span>| Congrats, you got the flag: CCTF&#123;f1nDin9_In7Eg3R_50Lut1Ons_iZ_in73rEStIn9!&#125;\n<span class="string">'</span></span><br></pre></td></tr></table></figure>

<h3 id="Baphomet"><a href="#Baphomet" class="headerlink" title="Baphomet"></a>Baphomet</h3><p>分值：56</p>
<p>考点：已知明文攻击</p>
<h4 id="challenge-1"><a href="#challenge-1" class="headerlink" title="challenge"></a>challenge</h4><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">from</span> base64 import b64encode</span><br><span class="line"><span class="built_in">from</span> flag import flag</span><br><span class="line"></span><br><span class="line">def <span class="built_in">encrypt</span>(msg):</span><br><span class="line">	ba = b64encode(msg.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">	baph, key = <span class="string">''</span>, <span class="string">''</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> b <span class="keyword">in</span> ba.decode(<span class="string">'utf-8'</span>):</span><br><span class="line">		<span class="keyword">if</span> b.islower():</span><br><span class="line">			baph += b.<span class="built_in">upper</span>()</span><br><span class="line">			key += <span class="string">'0'</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			baph += b.<span class="built_in">lower</span>()</span><br><span class="line">			key += <span class="string">'1'</span></span><br><span class="line"></span><br><span class="line">	baph = baph.encode(<span class="string">'utf-8'</span>)</span><br><span class="line">	key = int(key, <span class="number">2</span>).to_bytes(<span class="built_in">len</span>(key)<span class="comment"> // 8, 'big')</span></span><br><span class="line"></span><br><span class="line">	enc = b<span class="string">''</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="built_in">len</span>(baph)):</span><br><span class="line">		enc += (baph[i] ^ key[i % <span class="built_in">len</span>(key)]).to_bytes(<span class="number">1</span>, <span class="string">'big'</span>)</span><br><span class="line"></span><br><span class="line">	<span class="literal">return</span> enc</span><br><span class="line"></span><br><span class="line">enc = <span class="built_in">encrypt</span>(flag)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">'flag.enc'</span>, <span class="string">'wb'</span>)</span><br><span class="line">f.<span class="built_in">write</span>(enc)</span><br><span class="line">f.<span class="built_in">close</span>()</span><br></pre></td></tr></table></figure>

<h4 id="thought-1"><a href="#thought-1" class="headerlink" title="thought"></a>thought</h4><h4 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="keyword">with</span> <span class="keyword">open</span>(<span class="string">"flag.enc"</span>,<span class="string">"rb"</span>) <span class="keyword">as</span> f:</span><br><span class="line">	enc = f.read()</span><br><span class="line">print(<span class="keyword">len</span>(enc))</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode,b64decode</span><br><span class="line">msg=b<span class="string">"CCTF&#123;"</span></span><br><span class="line">ba = b64encode(msg)</span><br><span class="line">baph, <span class="keyword">key</span> = <span class="string">''</span>, <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> ba.decode(<span class="string">'utf-8'</span>):</span><br><span class="line">	<span class="keyword">if</span> b.islower():</span><br><span class="line">		baph += b.upper()</span><br><span class="line">		<span class="keyword">key</span> += <span class="string">'0'</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		baph += b.lower()</span><br><span class="line">		<span class="keyword">key</span> += <span class="string">'1'</span></span><br><span class="line"></span><br><span class="line">baph = baph.encode(<span class="string">'utf-8'</span>)[:<span class="number">6</span>]</span><br><span class="line">print(baph)</span><br><span class="line"></span><br><span class="line"><span class="keyword">key</span> = b<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">range</span>(<span class="keyword">len</span>(baph)):</span><br><span class="line">	<span class="keyword">key</span> += (baph[i] ^ enc[i]).to_bytes(<span class="number">1</span>, <span class="string">'big'</span>)</span><br><span class="line">print(<span class="keyword">key</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">dec</span> = b<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">range</span>(<span class="keyword">len</span>(enc)):</span><br><span class="line">	<span class="built_in">dec</span> += (enc[i] ^ <span class="keyword">key</span>[i % <span class="keyword">len</span>(<span class="keyword">key</span>)]).to_bytes(<span class="number">1</span>, <span class="string">'big'</span>)</span><br><span class="line">print(<span class="built_in">dec</span>)</span><br><span class="line"></span><br><span class="line">flag=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> dec.decode(<span class="string">'utf-8'</span>):</span><br><span class="line">	<span class="keyword">if</span> b.islower():</span><br><span class="line">		flag += b.upper()</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		flag += b.lower()</span><br><span class="line">print(b64decode(flag.encode(<span class="string">'utf-8'</span>)))</span><br><span class="line"><span class="comment">#key = int(key, 2).to_bytes(len(key) // 8, 'big')</span></span><br></pre></td></tr></table></figure>

<h4 id="result-1"><a href="#result-1" class="headerlink" title="result"></a>result</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">48</span></span><br><span class="line"><span class="string">b'q0nurN'</span></span><br><span class="line"><span class="string">b'\xf9b\xad\xacN\xff'</span></span><br><span class="line"><span class="string">b'q0nurNTvCfaZCL8WuL9St3DfuL8Xn1PFDeGZx1bYmgjmm019'</span></span><br><span class="line"><span class="string">b'CCTF&#123;UpP3r_0R_lOwER_17Z_tH3_Pr0bL3M&#125;'</span></span><br><span class="line">[Finished <span class="keyword">in</span> <span class="number">0.2</span>s]</span><br></pre></td></tr></table></figure>

<h2 id="medium-easy"><a href="#medium-easy" class="headerlink" title="medium-easy"></a>medium-easy</h2><h3 id="SOTS"><a href="#SOTS" class="headerlink" title="SOTS"></a>SOTS</h3><p>分值：49</p>
<p>考点：two_square</p>
<h4 id="challenge-2"><a href="#challenge-2" class="headerlink" title="challenge"></a>challenge</h4><p>He who abides far away from his home, is ever longing for the day he shall return.</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc <span class="number">05</span><span class="selector-class">.cr</span><span class="selector-class">.yp</span><span class="selector-class">.toc</span><span class="selector-class">.tf</span> <span class="number">37331</span></span><br></pre></td></tr></table></figure>

<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-<span class="number">0</span>-<span class="number">7</span>-centos ~]<span class="comment"># nc 05.cr.yp.toc.tf 37331</span></span><br><span class="line"><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span></span><br><span class="line"><span class="params">|  Hey math experts, <span class="keyword">in</span> this challenge we will deal with the numbers   |</span></span><br><span class="line"><span class="params">|  those are the sum of two perfect square, now try hard to find them! |</span></span><br><span class="line"><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span></span><br><span class="line"><span class="params">| Generating the `n', please wait...</span></span><br><span class="line"><span class="params">|</span> <span class="symbol">Options:</span> </span><br><span class="line"><span class="params">|	[G]et the n </span></span><br><span class="line"><span class="params">|</span>	[S]olve the challenge! </span><br><span class="line"><span class="params">|	[Q]uit</span></span><br><span class="line"><span class="params">G</span></span><br><span class="line"><span class="params">|</span> n = <span class="number">1243565868390316746681363697659435925395524656187056587629633961874200469</span></span><br><span class="line"><span class="params">| Options: </span></span><br><span class="line"><span class="params">|</span>	[G]et the n </span><br><span class="line"><span class="params">|	[S]olve the challenge! </span></span><br><span class="line"><span class="params">|</span>	[Q]uit</span><br><span class="line">S</span><br><span class="line"><span class="params">| Send your pair x, y here:</span></span><br></pre></td></tr></table></figure>

<h4 id="Thought"><a href="#Thought" class="headerlink" title="Thought"></a>Thought</h4><h4 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h4><p><a href="https://www.alpertron.com.ar/QUAD.HTM" target="_blank" rel="noopener">https://www.alpertron.com.ar/QUAD.HTM</a></p>
<p><img src="https://s2.loli.net/2022/07/19/wQSg3OTz7N1jJoH.png" alt="image-20220718153538221"></p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># sagemath</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">sage:</span> two_squares(<span class="number">5545629715339564937545617256977338230363684107665849984098838446686735017</span>)</span><br><span class="line">(<span class="number">1166738044093249132248421369078945211</span>, <span class="number">2045568882195127737861825295828693636</span>)</span><br></pre></td></tr></table></figure>

<h4 id="result-2"><a href="#result-2" class="headerlink" title="result"></a>result</h4><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">root@VM-<span class="number">0</span>-<span class="number">7</span>-centos ~]<span class="comment"># nc 05.cr.yp.toc.tf 37331</span></span><br><span class="line"><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span></span><br><span class="line"><span class="params">|  Hey math experts, <span class="keyword">in</span> this challenge we will deal with the numbers   |</span></span><br><span class="line"><span class="params">|  those are the sum of two perfect square, now try hard to find them! |</span></span><br><span class="line"><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span></span><br><span class="line"><span class="params">| Generating the `n', please wait...</span></span><br><span class="line"><span class="params">|</span> <span class="symbol">Options:</span> </span><br><span class="line"><span class="params">|	[G]et the n </span></span><br><span class="line"><span class="params">|</span>	[S]olve the challenge! </span><br><span class="line"><span class="params">|	[Q]uit</span></span><br><span class="line"><span class="params">g</span></span><br><span class="line"><span class="params">|</span> n = <span class="number">5545629715339564937545617256977338230363684107665849984098838446686735017</span></span><br><span class="line"><span class="params">| Options: </span></span><br><span class="line"><span class="params">|</span>	[G]et the n </span><br><span class="line"><span class="params">|	[S]olve the challenge! </span></span><br><span class="line"><span class="params">|</span>	[Q]uit</span><br><span class="line">s</span><br><span class="line"><span class="params">| Send your pair x, y here: </span></span><br><span class="line"><span class="params">2010025793396973084655790372917576051,1226958037268770577663190958375036304</span></span><br><span class="line"><span class="params">|</span> Congratz! the flag is CCTF&#123;<span class="number">3</span>Xpr3sS_4z_Th3_sUm_oF_7w0_Squ4rE5!&#125;</span><br></pre></td></tr></table></figure>

<h3 id="polyRSA"><a href="#polyRSA" class="headerlink" title="polyRSA"></a>polyRSA</h3><p>分值：42</p>
<p>考点：RSA</p>
<h4 id="challenge-3"><a href="#challenge-3" class="headerlink" title="challenge"></a>challenge</h4><p>Hello RSA, my old <a href="https://cr.yp.toc.tf/tasks/polyRSA_dd6449ca48958d11c0c3331e0b3df2c736979056.txz" target="_blank" rel="noopener">friend</a>!</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">keygen</span><span class="params">(nbit = <span class="number">64</span>)</span>:</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		k = getRandomNBitInteger(nbit)</span><br><span class="line">		p = k**<span class="number">6</span> + <span class="number">7</span>*k**<span class="number">4</span> - <span class="number">40</span>*k**<span class="number">3</span> + <span class="number">12</span>*k**<span class="number">2</span> - <span class="number">114</span>*k + <span class="number">31377</span></span><br><span class="line">		q = k**<span class="number">5</span> - <span class="number">8</span>*k**<span class="number">4</span> + <span class="number">19</span>*k**<span class="number">3</span> - <span class="number">313</span>*k**<span class="number">2</span> - <span class="number">14</span>*k + <span class="number">14011</span></span><br><span class="line">		<span class="keyword">if</span> isPrime(p) <span class="keyword">and</span> isPrime(q):</span><br><span class="line">			<span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(msg, n, e = <span class="number">31337</span>)</span>:</span></span><br><span class="line">	m = bytes_to_long(msg)</span><br><span class="line">	<span class="keyword">return</span> pow(m, e, n)</span><br><span class="line"></span><br><span class="line">p, q = keygen()</span><br><span class="line">n = p * q</span><br><span class="line">enc = encrypt(flag, n)</span><br><span class="line">print(<span class="string">f'n = <span class="subst">&#123;n&#125;</span>'</span>)</span><br><span class="line">print(<span class="string">f'enc = <span class="subst">&#123;enc&#125;</span>'</span>)</span><br></pre></td></tr></table></figure>

<h4 id="Thought-1"><a href="#Thought-1" class="headerlink" title="Thought"></a>Thought</h4><h4 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h4><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">44538727182858207226040251762322467288176239968967952269350336889655421753182750730773886813281253762528207970314694060562016861614492626112150259048393048617529867598499261392152098087985858905944606287003243</span></span><br><span class="line">enc = <span class="number">37578889436345667053409195986387874079577521081198523844555524501835825138236698001996990844798291201187483119265306641889824719989940722147655181198458261772053545832559971159703922610578530282146835945192532</span></span><br><span class="line">R.&lt;k&gt; = ZZ[]</span><br><span class="line"></span><br><span class="line">p = k**<span class="number">6</span> + <span class="number">7</span>*k**<span class="number">4</span> - <span class="number">40</span>*k**<span class="number">3</span> + <span class="number">12</span>*k**<span class="number">2</span> - <span class="number">114</span>*k + <span class="number">31377</span></span><br><span class="line">q = k**<span class="number">5</span> - <span class="number">8</span>*k**<span class="number">4</span> + <span class="number">19</span>*k**<span class="number">3</span> - <span class="number">313</span>*k**<span class="number">2</span> - <span class="number">14</span>*k + <span class="number">14011</span></span><br><span class="line"></span><br><span class="line">f = p*q-n</span><br><span class="line">x = f.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">pp=p(x)</span><br><span class="line">qq=q(x)</span><br><span class="line">phi = (pp<span class="number">-1</span>)*(qq<span class="number">-1</span>)</span><br><span class="line">d = inverse_mod(<span class="number">31337</span>,phi)</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">print(long_to_bytes(pow(enc,d,n)))</span><br></pre></td></tr></table></figure>

<h4 id="result-3"><a href="#result-3" class="headerlink" title="result"></a>result</h4><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b'CCTF&#123;F4C70r!N9_tRIcK5_aR3_fUN_iN_RSA?!!!&#125;<span class="string">'</span></span><br></pre></td></tr></table></figure>

<h3 id="Infinity-castle"><a href="#Infinity-castle" class="headerlink" title="Infinity castle"></a>Infinity castle</h3><p>分值：131</p>
<p>考点：二次方、三次方、立方和、平方差、积分、泰勒展开</p>
<h4 id="challenge-4"><a href="#challenge-4" class="headerlink" title="challenge"></a>challenge</h4><p>Can you break our new schema and decrypt the mixed <a href="https://cr.yp.toc.tf/tasks/infinity_castle_f388a20a0653cb1be6e9729bd8af8a41c9d55bce.txz" target="_blank" rel="noopener">encrypted message</a> without having the public key and shared secret?!</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TaylorSeries</span><span class="params">()</span>:</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, order)</span>:</span></span><br><span class="line">		self.order = order</span><br><span class="line">		</span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">coefficient</span><span class="params">(self, n)</span>:</span></span><br><span class="line">		i = <span class="number">0</span></span><br><span class="line">		coef = <span class="number">1</span></span><br><span class="line">		<span class="keyword">while</span> i &lt; n:</span><br><span class="line">			i += <span class="number">1</span></span><br><span class="line">			coef *= (coef * (<span class="number">1</span>/<span class="number">2</span>-i+<span class="number">1</span>)) / i</span><br><span class="line">		<span class="keyword">return</span> coef</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">find</span><span class="params">(self, center)</span>:</span></span><br><span class="line">		sum = <span class="number">0</span></span><br><span class="line">		center -= <span class="number">1</span></span><br><span class="line">		i = <span class="number">0</span></span><br><span class="line">		<span class="keyword">while</span> i &lt; self.order:</span><br><span class="line">			sum += (center**(<span class="number">1</span>/<span class="number">2</span>-i) * self.coefficient(i))</span><br><span class="line">			i += <span class="number">1</span></span><br><span class="line">		<span class="keyword">return</span> sum</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span><span class="params">(cip, key)</span>:</span></span><br><span class="line">	repeation = <span class="number">1</span> + (len(cip) // len(key))</span><br><span class="line">	key = key * repeation</span><br><span class="line">	key = key[:len(cip)]</span><br><span class="line">	</span><br><span class="line">	msg = bytes([c ^ k <span class="keyword">for</span> c, k <span class="keyword">in</span> zip(cip, key)])</span><br><span class="line">	<span class="keyword">return</span> msg</span><br><span class="line"></span><br><span class="line"><span class="comment"># If you run these 3 functions (diamond, triage, summarize) with big numbers, they will never end</span></span><br><span class="line"><span class="comment"># You need to optimize them first</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">diamond</span><span class="params">(num)</span>:</span></span><br><span class="line">	output = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(num):</span><br><span class="line">		output += i*<span class="number">2</span> + <span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">triage</span><span class="params">(num)</span>:</span></span><br><span class="line">	output = <span class="number">0</span></span><br><span class="line">	index = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(num):</span><br><span class="line">		output += (i+index)*<span class="number">6</span> + <span class="number">1</span></span><br><span class="line">		index += i</span><br><span class="line">	<span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">summarize</span><span class="params">(b)</span>:</span></span><br><span class="line">	order = getRandomRange(<span class="number">1000</span>, <span class="number">2000</span>)</span><br><span class="line">	t = TaylorSeries(order)</span><br><span class="line">	output = <span class="number">0</span></span><br><span class="line">	</span><br><span class="line">	i = <span class="number">2</span></span><br><span class="line">	<span class="keyword">while</span> i &lt; b:</span><br><span class="line">		b1 = t.find(i)</span><br><span class="line">		b2 = t.find(i+<span class="number">1</span>)</span><br><span class="line">		output += (b1+b2) / <span class="number">2</span></span><br><span class="line">		i += <span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">KEY_SIZE = <span class="number">2048</span></span><br><span class="line">p, q = [getPrime(KEY_SIZE) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">'01'</span>]</span><br><span class="line"></span><br><span class="line">e, n = <span class="number">0x10001</span>, p*q</span><br><span class="line"></span><br><span class="line">f = open (<span class="string">'./message.txt'</span>, <span class="string">'rb'</span>)</span><br><span class="line">message = f.read()</span><br><span class="line">f.close()</span><br><span class="line">msg_length = len(message)</span><br><span class="line">padded_msg = message + urandom(len(long_to_bytes(n)) - msg_length)</span><br><span class="line">padded_msg_length = len(padded_msg)</span><br><span class="line"></span><br><span class="line">xor_key = long_to_bytes(int(summarize(n)))[:padded_msg_length]</span><br><span class="line"><span class="keyword">assert</span>(len(xor_key) == <span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">enc0 = xor(padded_msg, xor_key)</span><br><span class="line"><span class="keyword">assert</span>(bytes_to_long(enc0) &lt; n)</span><br><span class="line"></span><br><span class="line">c0 =  abs(diamond(p) - diamond(q))</span><br><span class="line">c1 =  triage(p)</span><br><span class="line">c1 += <span class="number">3</span>*n*(p+q)</span><br><span class="line">c1 += triage(q)</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(enc0)</span><br><span class="line">enc1 = pow(m, e, n)</span><br><span class="line"></span><br><span class="line">print(<span class="string">f"c0 = <span class="subst">&#123;c0&#125;</span>"</span>)</span><br><span class="line">print(<span class="string">f"c1 = <span class="subst">&#123;c1&#125;</span>"</span>)</span><br><span class="line">print(<span class="string">f"enc = <span class="subst">&#123;enc1&#125;</span>"</span>)</span><br></pre></td></tr></table></figure>

<h4 id="Thought-2"><a href="#Thought-2" class="headerlink" title="Thought"></a>Thought</h4><p>diamond：$n^2$</p>
<p>triage：$n^3$</p>
<p>summarize：$\int_\infin \sqrt{n}=\frac{2}{3}n^{\frac{3}{2}}$</p>
<h4 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">def xor(cip, key):</span><br><span class="line">	repeation = 1 + (len(cip) // len(key))</span><br><span class="line">	key = key * repeation</span><br><span class="line">	key = key[:len(cip)]</span><br><span class="line">	msg = bytes([c ^^ k for c, k in zip(cip, key)])</span><br><span class="line">	return msg</span><br><span class="line"></span><br><span class="line">c0 = 194487778980461745865921475300460852453586088781074246328543689440168930873549359227127363759885970436167330043371627413542337857082400024590112412164095470165662281502211335756288082198009158469871465280749846525326701136380764079685636158337203211609233704905784093776008350120607841177268965738426317288541638374141671346404729428158104872411498098187946543666987926130124245185069569476433120128275581891425551325847219504501925282012199947834686225770246801353666030075146469275695499044424390475398423700504158154044180028733800154044746648133536737830623670383925046006108348861714435567006327619892239876863209887013290251890513192375749866675256952802329688897844132157098061758362137357387787072005860610663777569670198971946904157425377235056152628515775755249828721767845990597859165193162537676147173896835503209596955703313430433124688537275895468076469102220355973904702901083642275544954262724054693167603475188412046722656788470695566949847884250306735314144182029335732280420629131990311054229665691517003924788583771265625694414774865289407885678238795596912006567817508035434074250123869676396153982762032750080222602796273083162627489526255501643913672882350236497429678928099868244687228703074267962827621792960</span><br><span class="line">c1 = 102325064080381160170299055162846304227217463467232681115953623386548494169967745781550171804781503102663445039561476870208178139548389771866145006535051362059443515034504958703659546162037904784821960707630188600064568878674788077706711506213779443920430038560373854184526850365974450688458342413544179732143225845085164110594063440979455274250021370090572731855665413325275414458572412561502408983107820534723804225765540316307539962199024757378469001612921489902325166003841336027940632451584642359132723894801946906069322200784708303615779699081247051006259449466759863245508473429631466831174013498995506423210088549372249221415401309493511477847517923201080509933268996867995533386571564898914042844521373220497356837599443280354679778455765441375957556266205953496871475611269965949025704864246188576674107448587696941054123618319505271195780178776338475090463487960063464172195337956577785477587755181298859587398321270677790915227557908728226236404532915215698698185501562405374498053670694387354757252731874312411228777004316623425843477845333936913444143768519959591070492639650368662529749434618783626718975406802741753688956961837855306815380844030665696781685152837849982159679122660714556706669865596780528277684800454866433826417980212164051043504955615794706595412705883261111953152250227679858538249797999044336210905975316421254442221408945203647754303635775048438188044803368249944201671941949138202928389951227347433255867504906597772044398973241425387514239164853656233776024571606159378910745571588836981735827902305330330946219857271646498602227088657739442867033212012876837654750348578740516798444734534291467314881324902354425889448102902750077077381896216130734894767553834949561471219923459897244690006643798812989271282475503126962274052192342840870308710338336817452628324667507548265612892611100350882163205858101959976</span><br><span class="line">enc = 122235247669762131006183252122503937958296387791525458429403709404875223067116491817728568224832483391622109986550732469556761300197133827976956875865159629512476600711420561872409721582387803219651736262581445978042694384374119142613277808898398213602093802571586386354257378956087240174787723503606671543195193114158641301908622673736098768829071270132073818245595918660134745516367731595853832524328488074054536278197115937409643221809577554866060292157239061557708159310445977052686561229611117673473208278176118561352693319461471419694590218295911647368543698198762827636021268989705079848502749837879584394379300566277359149621932579222865430374652678738198451655509408564586496375811666876030847654260305392984710580761255795785508407844683687773983669843744274915862335181251050775093896006210092665809300090715190088851654138383362259256212093670748527819287681468901379286722214112321906917311154811516336259463356911326393701445497605365038857575515541024824906818473933597129846235905072394148879079996812146836910199111439031562946495046766063326815863624262541346543552652673629442370320109404700346028639853707278295255350982238521659924641921142615894039995513480511108116053798143154593343124822462519555715118822045</span><br><span class="line"></span><br><span class="line">var('p,q')</span><br><span class="line"></span><br><span class="line">f1 = p^2-q^2 - c0</span><br><span class="line">f2 = (p+q)^3 - c1</span><br><span class="line"></span><br><span class="line"><span class="comment">#solve([f1,f2],p,q)</span></span><br><span class="line">p=25465500595039564722385454268618341460440964303654692306893194812608651011894765148023201769023925823267446913594798724374078776058926548056279105656348138942211069695157129067986030357247987537066065195208337853580939616954961742954173270603234042184081995050125067398704045490448077961447418406856674045777724275017678698252609741079175784928310951915104807404003531834525200421059550762294584722178356010146438598799668537922242765662363844939035164178525445220653839693135494967926642943210917823981779895464411806829004306900926935124663285407830585204630912848783431051369106939431567473170247979142455819150893</span><br><span class="line">q=21307368246113800130311098641506744510559988209047095448061577734947715969121645982743962584143752085867914325394457857827478912559095766977509129246922499990951138184298921892924074303356650532229644986118338361761354192554363128824141104808606558539422865199413633150757655174985683830034245659632460363700309887626934298289805670092066041542014924213128271705967504359900458092855272034197878632989626323553684162988741101770565319360726673172671459797955787997515498457867020749156835947018833861229200382521269341946614058721285386773372009177934062994798868703374266787876752211055631019633581263575312198649933</span><br><span class="line">phi=(p-1)*(q-1)</span><br><span class="line">e=0x10001</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">d=inverse(e,phi)</span><br><span class="line">n = p*q</span><br><span class="line">padded_msg = long_to_bytes(pow(enc,d,n))</span><br><span class="line"></span><br><span class="line">xor_key = long_to_bytes(int(2/3*n^(3/2)))[:512]</span><br><span class="line">enc0 = xor(padded_msg, xor_key)</span><br><span class="line">print(enc0)</span><br></pre></td></tr></table></figure>

<h4 id="result-4"><a href="#result-4" class="headerlink" title="result"></a>result</h4><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b'Never heard of using taylor series and integral beside RSA?!<span class="symbol">\n</span>But there are always ways to make things complicated<span class="symbol">\n</span><span class="symbol">\n</span>CCTF&#123;Mix1ng_c4lcUluS_w17h_Numb3r_The0Rry_S33ms_s7r0ng_cRyp70_Sch3m4!!&#125;<span class="symbol">\n</span><span class="symbol">\n</span>We compute integrals with just measuring the area with a little fraction, forget about tough works!<span class="symbol">\n</span>Good luck with the rest of CryptoCTF2022<span class="symbol">\x</span>9a<span class="symbol">\x</span>92W<span class="symbol">\x</span>cf<span class="symbol">\x</span>a2dl<span class="symbol">\x</span>1a<span class="symbol">\x</span>91<span class="symbol">\x</span>96<span class="symbol">\'</span><span class="symbol">\x</span>88<span class="symbol">\x</span>ec<span class="symbol">\x</span>fez<span class="symbol">\x</span>cd<span class="symbol">\x</span>c2<span class="symbol">\x</span>e7<span class="symbol">\x</span>0bC<span class="symbol">\x</span>90<span class="symbol">\x</span>a3<span class="symbol">\x</span>c7<span class="symbol">\x</span>e7U<span class="symbol">\x</span>b4F<span class="symbol">\x</span>a535V<span class="symbol">\x</span>19<span class="symbol">\x</span>9b<span class="symbol">\x</span>9e<span class="symbol">\x</span>d4<span class="symbol">\x</span>f7<span class="symbol">\x</span>e7X<span class="symbol">\x</span>02<span class="symbol">\x</span>19Y<span class="symbol">\x</span>86<span class="symbol">\x</span>fa<span class="symbol">\x</span>9f<span class="symbol">\x</span>0b!<span class="symbol">\x</span>9a<span class="symbol">\x</span>c1<span class="symbol">\x</span>d2<span class="symbol">\x</span>cayG<span class="symbol">\x</span>8af/<span class="symbol">\x</span>14<span class="symbol">\x</span>ef<span class="symbol">\x</span>f9<span class="symbol">\x</span>1d<span class="symbol">\x</span>c2<span class="symbol">\x</span>9a<span class="symbol">\x</span>cb<span class="symbol">\x</span>9da&#125;g8<span class="symbol">\x</span>b8<span class="symbol">\\</span> 2~<span class="symbol">\x</span>f3<span class="symbol">\x</span>e3<span class="symbol">\x</span>b6$<span class="symbol">\x</span>b6i<span class="symbol">\x</span>12<span class="symbol">\x</span>d6<span class="symbol">\x</span>82<span class="symbol">\x</span>fac<span class="symbol">\x</span>15<span class="symbol">\x</span>eeVa[s<span class="symbol">\x</span>a0S<span class="symbol">\x</span>00y<span class="symbol">\x</span>0c<span class="symbol">\x</span>18<span class="symbol">\x</span>c34<span class="symbol">\x</span>bd<span class="symbol">\x</span>96fd<span class="symbol">\x</span>ec<span class="symbol">\x</span>cf<span class="symbol">\x</span>b9<span class="symbol">\x</span>02&lt;Q<span class="symbol">\x</span>8b<span class="symbol">\x</span>b8<span class="symbol">\x</span>9d<span class="symbol">\x</span>d5<span class="symbol">\x</span>efDu<span class="symbol">\x</span>da<span class="symbol">\x</span>d2<span class="symbol">\x</span>f0<span class="symbol">\x</span>c6g<span class="symbol">\x</span>97<span class="symbol">\x</span>f8<span class="symbol">\x</span>952<span class="symbol">\x</span>0c<span class="symbol">\r</span>s=<span class="symbol">\x</span>19.<span class="symbol">\x</span>11"<span class="symbol">\x</span>08<span class="symbol">\x</span>81<span class="symbol">\x</span>e7*<span class="symbol">\x</span>87<span class="symbol">\x</span>b8<span class="symbol">\x</span>bd&gt;<span class="symbol">\x</span>82<span class="symbol">\n</span>~<span class="symbol">\x</span>f7l,<span class="symbol">\t</span>u<span class="symbol">\x</span>96&#125;*<span class="symbol">\x</span>ab`<span class="symbol">\x</span>17<span class="symbol">\x</span>e7<span class="symbol">\x</span>f4<span class="symbol">\x</span>d7N^<span class="symbol">\x</span>e3<span class="symbol">\x</span>fe<span class="symbol">\x</span>f3@<span class="symbol">\x</span>1e<span class="symbol">\x</span>1c<span class="symbol">\x</span>15<span class="symbol">\x</span>ffC<span class="symbol">\x</span>ecVVr<span class="symbol">\x</span>ca<span class="symbol">\x</span>8d<span class="symbol">\x</span>03<span class="symbol">\x</span>c5<span class="symbol">\x</span>da<span class="symbol">\x</span>d6<span class="symbol">\x</span>bf=<span class="symbol">\x</span>c6<span class="symbol">\x</span>14+<span class="symbol">\x</span>f2<span class="symbol">\x</span>14N'</span><br></pre></td></tr></table></figure>

<h3 id="Keydream"><a href="#Keydream" class="headerlink" title="Keydream"></a>Keydream</h3><p>分值：105</p>
<p>考点：RSA</p>
<h4 id="challenge-5"><a href="#challenge-5" class="headerlink" title="challenge"></a>challenge</h4><p>Everything is better homemade, we developed a <a href="https://cr.yp.toc.tf/tasks/keydream_c42e7317248d8c69e0069e6684a4a18ceedbe902.txz" target="_blank" rel="noopener">homemade RSA</a>, test it to see if it’s really better?</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">randstr</span><span class="params">(l)</span>:</span></span><br><span class="line">	rstr = [(string.printable[:<span class="number">62</span>] + <span class="string">'_'</span>)[getRandomRange(<span class="number">0</span>, <span class="number">62</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> range(l)]</span><br><span class="line">	<span class="keyword">return</span> <span class="string">''</span>.join(rstr)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(msg, l)</span>:</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		rstr = <span class="string">'CCTF&#123;it_is_fake_flag_'</span> + randstr(l) + <span class="string">'_90OD_luCk___!!&#125;'</span></span><br><span class="line">		p = bytes_to_long(rstr.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">		q = bytes_to_long(rstr[::<span class="number">-1</span>].encode(<span class="string">'utf-8'</span>))</span><br><span class="line">		<span class="keyword">if</span> isPrime(p) <span class="keyword">and</span> isPrime(q):</span><br><span class="line">			n = p * q</span><br><span class="line">			e, m = <span class="number">65537</span>, bytes_to_long(msg.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">			c = pow(m, e, n)</span><br><span class="line">			<span class="keyword">return</span> n, c</span><br><span class="line"></span><br><span class="line">n, c = encrypt(flag, <span class="number">27</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">f'n = <span class="subst">&#123;n&#125;</span>'</span>)</span><br><span class="line">print(<span class="string">f'c = <span class="subst">&#123;c&#125;</span>'</span>)</span><br></pre></td></tr></table></figure>

<h4 id="Thought-3"><a href="#Thought-3" class="headerlink" title="Thought"></a>Thought</h4><p>$f = phigh\cdot 2^x+unknow \cdot 2^y+plow$</p>
<h4 id="exp-5"><a href="#exp-5" class="headerlink" title="exp"></a>exp</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">n = 23087202318856030774680571525957068827041569782431397956837104908189620961469336659300387982516148407611623358654041246574100274275974799587138270853364165853708786079644741407579091918180874935364024818882648063256767259283714592098555858095373381673229188828791636142379379969143042636324982275996627729079</span><br><span class="line">c = 3621516728616736303019716820373078604485184090642291670706733720518953475684497936351864366709813094154736213978864841551795776449242009307288704109630747654430068522939150168228783644831299534766861590666590062361030323441362406214182358585821009335369275098938212859113101297279381840308568293108965668609</span><br><span class="line"></span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">phigh = bytes_to_long(b<span class="string">"CCTF&#123;it_is_fake_flag_"</span>)</span><br><span class="line">plow = bytes_to_long(b'_90OD_luCk___!!&#125;')</span><br><span class="line">P.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = (phigh &lt;&lt; 344) + (x * 2^128) + plow</span><br><span class="line">x0 = f.monic().small_roots(X=2^216, beta=0.4,epsilon=0.02)[0]</span><br><span class="line">p = int(f(x0))</span><br><span class="line">q = n//p</span><br><span class="line">e = 65537</span><br><span class="line">phi = (p-1)*(q-1)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">print(long_to_bytes(pow(c,d,n)))</span><br></pre></td></tr></table></figure>

<h4 id="result-5"><a href="#result-5" class="headerlink" title="result"></a>result</h4><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">'Congratz</span>, the flag <span class="keyword">is</span>: CCTF&#123;h0M3_m4dE_k3Y_Dr1vEn_CrYp7O_5ySTeM!&#125;'</span><br></pre></td></tr></table></figure>

<h3 id="Jeksign"><a href="#Jeksign" class="headerlink" title="Jeksign"></a>Jeksign</h3><p>分值：100</p>
<p>考点：丢番图方程</p>
<h4 id="challenge-6"><a href="#challenge-6" class="headerlink" title="challenge"></a>challenge</h4><p>Solve the equation, we like to have the <a href="https://cr.yp.toc.tf/tasks/jeksign_506ccee11765a9f97d3eb861f1ce947cd831f454.txz" target="_blank" rel="noopener">solution</a>!</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc <span class="number">02</span><span class="selector-class">.cr</span><span class="selector-class">.yp</span><span class="selector-class">.toc</span><span class="selector-class">.tf</span> <span class="number">17113</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> gensol, nbit_gensol</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">print(m)</span><br><span class="line"></span><br><span class="line">a = <span class="number">1337</span></span><br><span class="line">b = <span class="number">31337</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">die</span><span class="params">(*args)</span>:</span></span><br><span class="line">	pr(*args)</span><br><span class="line">	quit()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pr</span><span class="params">(*args)</span>:</span></span><br><span class="line">	s = <span class="string">" "</span>.join(map(str, args))</span><br><span class="line">	sys.stdout.write(s + <span class="string">"\n"</span>)</span><br><span class="line">	sys.stdout.flush()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sc</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="keyword">return</span> sys.stdin.readline().strip()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">	border = <span class="string">"|"</span></span><br><span class="line">	pr(border*<span class="number">72</span>)</span><br><span class="line">	pr(border, <span class="string">"Welcome crypto guys! Here we are looking for the solution of special"</span>, border)</span><br><span class="line">	pr(border, <span class="string">"Diophantine equation: 1337(z^4 - x^2) = 31337(y^2 - z^4) in natural "</span>, border)</span><br><span class="line">	pr(border, <span class="string">"numbers, in each stage solve the equation in mentioned interval :)  "</span>, border)</span><br><span class="line">	pr(border*<span class="number">72</span>)</span><br><span class="line"></span><br><span class="line">	STEP, level = <span class="number">0</span>, <span class="number">19</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		p, q = nbit_gensol(<span class="number">1337</span>, <span class="number">31337</span>, STEP + <span class="number">30</span>)</span><br><span class="line">		x, y, z = gensol(a, b, p, q)</span><br><span class="line">		pr(border, <span class="string">f"Send a solution like `x, y, z' such that the `z' is <span class="subst">&#123;STEP + <span class="number">30</span>&#125;</span>-bit: "</span>)</span><br><span class="line">		ans = sc()</span><br><span class="line">		<span class="keyword">try</span>:</span><br><span class="line">			X, Y, Z = [int(_) <span class="keyword">for</span> _ <span class="keyword">in</span> ans.split(<span class="string">','</span>)]</span><br><span class="line">			NBIT = Z.bit_length()</span><br><span class="line">		<span class="keyword">except</span>:</span><br><span class="line">			die(border, <span class="string">'Your input is not valid, Bye!'</span>)</span><br><span class="line">		<span class="keyword">if</span> <span class="number">1337</span>*(Z**<span class="number">4</span> - X**<span class="number">2</span>) == <span class="number">31337</span>*(Y**<span class="number">2</span> - Z**<span class="number">4</span>) <span class="keyword">and</span> NBIT == STEP + <span class="number">30</span>:</span><br><span class="line">			<span class="keyword">if</span> STEP == level - <span class="number">1</span>:</span><br><span class="line">				die(border, <span class="string">f'Congrats, you got the flag: <span class="subst">&#123;flag&#125;</span>'</span>)</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				pr(<span class="string">'| good job, try to solve the next challenge :P'</span>)</span><br><span class="line">				STEP += <span class="number">1</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			die(border, <span class="string">'your answer is not correct, Bye!!'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>

<h4 id="Thought-4"><a href="#Thought-4" class="headerlink" title="Thought"></a>Thought</h4><p>$1337(z^4-x2)=31337(y^2-z^4)$</p>
<p>$(1337+31337)z^4=1337x^2+31337y^2$</p>
<p>$x=y=z^2$</p>
<h4 id="exp-6"><a href="#exp-6" class="headerlink" title="exp"></a>exp</h4><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number <span class="built_in">import</span> *</span><br><span class="line">from sympy <span class="built_in">import</span> *</span><br><span class="line"></span><br><span class="line">from pwn <span class="built_in">import</span> *</span><br><span class="line">context.<span class="attr">log_level</span> = 'debug'</span><br><span class="line"><span class="attr">sh</span> = remote(<span class="string">"02.cr.yp.toc.tf"</span>,<span class="number">17113</span>)</span><br><span class="line">for i <span class="keyword">in</span> range(<span class="number">30</span>,<span class="number">49</span>):</span><br><span class="line">	<span class="attr">ch</span> = sh.recvuntil(<span class="string">"-bit: \n"</span>)</span><br><span class="line">	<span class="attr">z</span> = getPrime(i)</span><br><span class="line">	<span class="attr">x</span> = z**<span class="number">2</span></span><br><span class="line">	<span class="attr">y</span> = x</span><br><span class="line">	sh.sendline(str(x)+<span class="string">","</span>+str(y)+<span class="string">","</span>+str(z))</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h4 id="result-6"><a href="#result-6" class="headerlink" title="result"></a>result</h4><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">| Congrats, you got the flag: CCTF&#123;<span class="number">4</span>_diOpH4nT1nE_3Qua7i0n__8Y__Jekuthiel_Ginsbur!!&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Volgo"><a href="#Volgo" class="headerlink" title="Volgo"></a>Volgo</h3><p>分值：</p>
<p>考点：</p>
<h4 id="challenge-7"><a href="#challenge-7" class="headerlink" title="challenge"></a>challenge</h4><p>There is no land behind the Volga!! The Soviets surround us,and we have only a single key table to communicate to the outside!! Hopefully, the Soviets wouldn’t be able read our messages.</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span><span class="comment">//03.cr.yp.toc.tf:11117/</span></span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/07/19/CnJdpaWS7wNctPX.png" alt="image-20220719094430434"></p>
<p>GET ENCRYPTDE FLAG :)</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"flag"</span>: <span class="string">"ZZNVH EOOAA JSGPB DAKCP MQRGM MBXDT NAULS MYJRI USVAY WQGUK KEWRJ BAPPW YDWQU KFDHC OOOWF QVANE XLEEK MVFBX HYQOR SFKGU AKWEB LEPXV LHRCG MKMSO DVOZS JFESS LTUEY QUGAA IODSI IZEQJ ROTBS TKSEH JBORC ZZNVH EOOAA"</span>&#125;</span><br><span class="line"></span><br><span class="line">&#123;<span class="attr">"flag"</span>: <span class="string">"GGMCT NJOAA QAEYB FJZLP VKZTA DHIIG RVYGC RPQQN LHWRR YSDXM YDSJL ZUROG KHXNX DGPSM PPEBK INKSS WEVSH ZNEKW OTZNR NFLYQ KLIRC JVWLI PSNBF OEFHC NDUVO CABZC LCTEN NMDSI XVDEL DRADR YIPBQ IKOLM DJAQA GGMCT NJOAA"</span>&#125;</span><br><span class="line"></span><br><span class="line">&#123;<span class="attr">"flag"</span>: <span class="string">"IISNJ IFFAA TYPMO WDJHA ZMNBD LKUAY TYPVD UGAYU OQMOO YRVUS SLFZI IXKVW LYUGT JWTYV XNEYU HLQVV IXUMJ BKNUQ WMLQT QKIWV UXOCA CVSPG UKJQG XCSFI RJEKU BWLBM AVRFW DMOPT VFXTD VROND XSEHF ZLWEJ VOVSX IISNJ IFFAA"</span>&#125;</span><br><span class="line"></span><br><span class="line">&#123;<span class="attr">"flag"</span>: <span class="string">"BBHAC QDFAA KGBMH RVZSK RNVZH NGRAM WYHHE HKHJU UCQBL HPVAP TXDCZ ZMKWX ETCKC CMBSC VKUUF BMAIV RTAJE EWOUS SMOTQ KNQBF IRDVZ YJWQK WEAIA TONBI MMBUI RCULP BKEIO LNOAM XLUDR XJYAM DMWJN DUXXV FDVOC BBHAC QDFAA"</span>&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Thought-5"><a href="#Thought-5" class="headerlink" title="Thought"></a>Thought</h4><h4 id="exp-7"><a href="#exp-7" class="headerlink" title="exp"></a>exp</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">from string <span class="keyword">import</span> ascii_uppercase</span><br><span class="line"></span><br><span class="line">ct = '<span class="type">QAEYBFJZLPVKZTADHIIGRVYGCRPQQNLHWRRYSDXMYDSJLZUROGKHXNXDGPSMPPEBKINKSSWEVSHZNEKWOTZNRNFLYQKLIRCJVWLIPSNBFOEFHCNDUVOCABZCLCTENNMDSIXVDELDRADRYIPBQIKOLMDJAQA'</span></span><br><span class="line"><span class="built_in">print</span>(ct)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def rua(<span class="built_in">c</span>, i):</span><br><span class="line">    pre = <span class="string">"A"</span> * i</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> ascii_uppercase:</span><br><span class="line">        cipher = requests.post(<span class="string">"http://03.cr.yp.toc.tf:11117/m209/encipher"</span>,</span><br><span class="line">                               data=&#123;</span><br><span class="line">                                   <span class="string">"plain"</span>: pre + ch</span><br><span class="line">                               &#125;).json()[<span class="string">"cipher"</span>]</span><br><span class="line"></span><br><span class="line">        cipher = cipher.replace(<span class="string">" "</span>, <span class="string">""</span>)[<span class="number">10</span>:-<span class="number">10</span>]        # remove head and tail</span><br><span class="line">        <span class="built_in">print</span>(cipher)</span><br><span class="line">        <span class="keyword">if</span> cipher[i] == <span class="built_in">c</span>:</span><br><span class="line">            <span class="built_in">print</span>('flag[i] <span class="keyword">is</span>', ch)</span><br><span class="line">            <span class="keyword">return</span> ch</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, <span class="built_in">c</span> <span class="keyword">in</span> <span class="built_in">enumerate</span>(ct):</span><br><span class="line">    flag += rua(<span class="built_in">c</span>, i)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h4 id="result-7"><a href="#result-7" class="headerlink" title="result"></a>result</h4><h2 id="medium"><a href="#medium" class="headerlink" title="medium"></a>medium</h2><h3 id="Aniely"><a href="#Aniely" class="headerlink" title="Aniely"></a>Aniely</h3><p>分值：66</p>
<p>考点：爆破</p>
<h4 id="challenge-8"><a href="#challenge-8" class="headerlink" title="challenge"></a>challenge</h4><p>There is stream <a href="https://cr.yp.toc.tf/tasks/aniely_49c70fa68eec382496a5f215b92dcc874a27ef4f.txz" target="_blank" rel="noopener">cipher</a>, try to keep it smooth!</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> passphrase, flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">aniely_stream</span><span class="params">(passphrase)</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">mixer</span><span class="params">(u, v)</span>:</span></span><br><span class="line">		<span class="keyword">return</span> ((u &lt;&lt; v) &amp; <span class="number">0xffffffff</span>) | u &gt;&gt; (<span class="number">32</span> - v)</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">forge</span><span class="params">(w, a, b, c, d)</span>:</span></span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">			w[a] = (w[a] + w[b]) &amp; <span class="number">0xffffffff</span></span><br><span class="line">			w[d] = mixer(w[a] ^ w[d], <span class="number">16</span> // (i + <span class="number">1</span>))</span><br><span class="line">			w[c] = (w[c] + w[d]) &amp; <span class="number">0xffffffff</span></span><br><span class="line">			w[b] = mixer(w[b] ^ w[c], (<span class="number">12</span> + <span class="number">2</span>*i) // (i + <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">	bring = [<span class="number">0</span>] * <span class="number">16</span></span><br><span class="line">	bring[:<span class="number">4</span>] = [<span class="number">0x61707865</span>, <span class="number">0x3320646e</span>, <span class="number">0x79622d32</span>, <span class="number">0x6b206574</span>]</span><br><span class="line">	bring[<span class="number">4</span>:<span class="number">12</span>] = unpack(<span class="string">'&lt;8L'</span>, passphrase)</span><br><span class="line">	bring[<span class="number">12</span>] = bring[<span class="number">13</span>] = <span class="number">0x0</span></span><br><span class="line">	bring[<span class="number">14</span>:] = [<span class="number">0</span>] * <span class="number">2</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		w = list(bring)</span><br><span class="line">		<span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">			forge(w, <span class="number">0x0</span>, <span class="number">0x4</span>, <span class="number">0x8</span>, <span class="number">0xc</span>)</span><br><span class="line">			forge(w, <span class="number">0x1</span>, <span class="number">0x5</span>, <span class="number">0x9</span>, <span class="number">0xd</span>)</span><br><span class="line">			forge(w, <span class="number">0x2</span>, <span class="number">0x6</span>, <span class="number">0xa</span>, <span class="number">0xe</span>)</span><br><span class="line">			forge(w, <span class="number">0x3</span>, <span class="number">0x7</span>, <span class="number">0xb</span>, <span class="number">0xf</span>)</span><br><span class="line">			forge(w, <span class="number">0x0</span>, <span class="number">0x5</span>, <span class="number">0xa</span>, <span class="number">0xf</span>)</span><br><span class="line">			forge(w, <span class="number">0x1</span>, <span class="number">0x6</span>, <span class="number">0xb</span>, <span class="number">0xc</span>)</span><br><span class="line">			forge(w, <span class="number">0x2</span>, <span class="number">0x7</span>, <span class="number">0x8</span>, <span class="number">0xd</span>)</span><br><span class="line">			forge(w, <span class="number">0x3</span>, <span class="number">0x4</span>, <span class="number">0x9</span>, <span class="number">0xe</span>)</span><br><span class="line">		<span class="keyword">for</span> c <span class="keyword">in</span> pack(<span class="string">'&lt;16L'</span>, *((w[_] + bring[_]) &amp; <span class="number">0xffffffff</span> <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">16</span>))):</span><br><span class="line">			<span class="keyword">yield</span> c</span><br><span class="line">		bring[<span class="number">12</span>] = (bring[<span class="number">12</span>] + <span class="number">1</span>) &amp; <span class="number">0xffffffff</span></span><br><span class="line">		<span class="keyword">if</span> bring[<span class="number">12</span>] == <span class="number">0</span>:</span><br><span class="line">			bring[<span class="number">13</span>] = (bring[<span class="number">13</span>] + <span class="number">1</span>) &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">aniely_encrypt</span><span class="params">(msg, passphrase)</span>:</span></span><br><span class="line">	<span class="keyword">if</span> len(passphrase) &lt; <span class="number">32</span>:</span><br><span class="line">		passphrase = (passphrase * (<span class="number">32</span> // len(passphrase) + <span class="number">1</span>))[:<span class="number">32</span>]</span><br><span class="line">	rand = urandom(<span class="number">2</span>) * <span class="number">16</span></span><br><span class="line">	<span class="keyword">return</span> bytes(a ^ b ^ c <span class="keyword">for</span> a, b, c <span class="keyword">in</span> zip(msg, aniely_stream(passphrase), rand))</span><br><span class="line"></span><br><span class="line">key = bytes(a ^ b <span class="keyword">for</span> a, b <span class="keyword">in</span> zip(passphrase, flag))</span><br><span class="line">enc = aniely_encrypt(passphrase, key)</span><br><span class="line">print(<span class="string">f'key = <span class="subst">&#123;key.hex()&#125;</span>'</span>)</span><br><span class="line">print(<span class="string">f'enc = <span class="subst">&#123;enc.hex()&#125;</span>'</span>)</span><br></pre></td></tr></table></figure>

<h4 id="Thought-6"><a href="#Thought-6" class="headerlink" title="Thought"></a>Thought</h4><h4 id="exp-8"><a href="#exp-8" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">key = <span class="number">0x4dcceb8802ae3c45fe80ccb364c8de19f2d39aa8ebbfb0621623e67aba8ed5bc</span></span><br><span class="line">enc = <span class="number">0xe67a67efee3a80b66af0c33260f96b38e4142cd5d9426f6f156839f2e2a8efe8</span></span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">aniely_stream</span><span class="params">(passphrase)</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">mixer</span><span class="params">(u, v)</span>:</span></span><br><span class="line">		<span class="keyword">return</span> ((u &lt;&lt; v) &amp; <span class="number">0xffffffff</span>) | u &gt;&gt; (<span class="number">32</span> - v)</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">forge</span><span class="params">(w, a, b, c, d)</span>:</span></span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">			w[a] = (w[a] + w[b]) &amp; <span class="number">0xffffffff</span></span><br><span class="line">			w[d] = mixer(w[a] ^ w[d], <span class="number">16</span> // (i + <span class="number">1</span>))</span><br><span class="line">			w[c] = (w[c] + w[d]) &amp; <span class="number">0xffffffff</span></span><br><span class="line">			w[b] = mixer(w[b] ^ w[c], (<span class="number">12</span> + <span class="number">2</span>*i) // (i + <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">	bring = [<span class="number">0</span>] * <span class="number">16</span></span><br><span class="line">	bring[:<span class="number">4</span>] = [<span class="number">0x61707865</span>, <span class="number">0x3320646e</span>, <span class="number">0x79622d32</span>, <span class="number">0x6b206574</span>]</span><br><span class="line">	bring[<span class="number">4</span>:<span class="number">12</span>] = unpack(<span class="string">'&lt;8L'</span>, passphrase)</span><br><span class="line">	bring[<span class="number">12</span>] = bring[<span class="number">13</span>] = <span class="number">0x0</span></span><br><span class="line">	bring[<span class="number">14</span>:] = [<span class="number">0</span>] * <span class="number">2</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		w = list(bring)</span><br><span class="line">		<span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">			forge(w, <span class="number">0x0</span>, <span class="number">0x4</span>, <span class="number">0x8</span>, <span class="number">0xc</span>)</span><br><span class="line">			forge(w, <span class="number">0x1</span>, <span class="number">0x5</span>, <span class="number">0x9</span>, <span class="number">0xd</span>)</span><br><span class="line">			forge(w, <span class="number">0x2</span>, <span class="number">0x6</span>, <span class="number">0xa</span>, <span class="number">0xe</span>)</span><br><span class="line">			forge(w, <span class="number">0x3</span>, <span class="number">0x7</span>, <span class="number">0xb</span>, <span class="number">0xf</span>)</span><br><span class="line">			forge(w, <span class="number">0x0</span>, <span class="number">0x5</span>, <span class="number">0xa</span>, <span class="number">0xf</span>)</span><br><span class="line">			forge(w, <span class="number">0x1</span>, <span class="number">0x6</span>, <span class="number">0xb</span>, <span class="number">0xc</span>)</span><br><span class="line">			forge(w, <span class="number">0x2</span>, <span class="number">0x7</span>, <span class="number">0x8</span>, <span class="number">0xd</span>)</span><br><span class="line">			forge(w, <span class="number">0x3</span>, <span class="number">0x4</span>, <span class="number">0x9</span>, <span class="number">0xe</span>)</span><br><span class="line">		<span class="keyword">for</span> c <span class="keyword">in</span> pack(<span class="string">'&lt;16L'</span>, *((w[_] + bring[_]) &amp; <span class="number">0xffffffff</span> <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">16</span>))):</span><br><span class="line">			<span class="keyword">yield</span> c</span><br><span class="line">		bring[<span class="number">12</span>] = (bring[<span class="number">12</span>] + <span class="number">1</span>) &amp; <span class="number">0xffffffff</span></span><br><span class="line">		<span class="keyword">if</span> bring[<span class="number">12</span>] == <span class="number">0</span>:</span><br><span class="line">			bring[<span class="number">13</span>] = (bring[<span class="number">13</span>] + <span class="number">1</span>) &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">passphrase = long_to_bytes(key)</span><br><span class="line">msg = long_to_bytes(enc)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>**<span class="number">2</span>):</span><br><span class="line">	rand = long_to_bytes(i,<span class="number">2</span>)*<span class="number">16</span></span><br><span class="line">	s = bytes(a ^ b ^ c <span class="keyword">for</span> a, b, c <span class="keyword">in</span> zip(msg, aniely_stream(passphrase), rand))</span><br><span class="line">	flag = bytes(a ^ b <span class="keyword">for</span> a, b <span class="keyword">in</span> zip(passphrase, s))</span><br><span class="line">	<span class="keyword">if</span> <span class="string">b"CCTF"</span> <span class="keyword">in</span> flag:</span><br><span class="line">		print(flag)</span><br></pre></td></tr></table></figure>

<h4 id="result-8"><a href="#result-8" class="headerlink" title="result"></a>result</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">b'CCTF&#123;7rY_t0_D3cRyPT_z3_ChaCha20&#125;'</span></span><br></pre></td></tr></table></figure>

<h3 id="Diploma"><a href="#Diploma" class="headerlink" title="Diploma"></a>Diploma</h3><p>分值：71</p>
<p>考点：</p>
<h4 id="challenge-9"><a href="#challenge-9" class="headerlink" title="challenge"></a>challenge</h4><p>We are trying to solve matrix problem with only diploma! Here we go around the matrix!</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc <span class="number">08</span><span class="selector-class">.cr</span><span class="selector-class">.yp</span><span class="selector-class">.toc</span><span class="selector-class">.tf</span> <span class="number">37313</span></span><br></pre></td></tr></table></figure>

<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-<span class="number">0</span>-<span class="number">7</span>-centos ~]<span class="comment"># nc 08.cr.yp.toc.tf 37313</span></span><br><span class="line"><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span></span><br><span class="line"><span class="params">|  Hi all, cryptographers know that the calculation of the order of a  |</span></span><br><span class="line"><span class="params">|  given element <span class="keyword">in</span> a group is <span class="keyword">not</span> easy at all. We are working <span class="keyword">in</span> the  |</span></span><br><span class="line"><span class="params">|  group GL(d, p), the group of invertible matrices of order `d' on a  |</span></span><br><span class="line"><span class="params">|  finite field of order `p'. In each stage send the order matrix M.   |</span></span><br><span class="line"><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span></span><br><span class="line"><span class="params">| Generating the parameters <span class="keyword">for</span> p = 127, please wait...</span></span><br><span class="line"><span class="params">|</span> M = </span><br><span class="line">[ <span class="number">14</span>  <span class="number">34</span>  <span class="number">93</span>]</span><br><span class="line">[<span class="number">104</span> <span class="number">124</span> <span class="number">111</span>]</span><br><span class="line">[ <span class="number">35</span>  <span class="number">34</span>  <span class="number">37</span>] </span><br><span class="line"><span class="params">| Send the order of matrix M:</span></span><br></pre></td></tr></table></figure>

<h4 id="Thought-7"><a href="#Thought-7" class="headerlink" title="Thought"></a>Thought</h4><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">sage:</span> M.multiplicative_order()</span><br></pre></td></tr></table></figure>

<h4 id="exp-9"><a href="#exp-9" class="headerlink" title="exp"></a>exp</h4><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line"><span class="built_in">from</span> gmpy2 import iroot</span><br><span class="line"><span class="built_in">from</span> pwn import *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">sh = remote(<span class="string">"08.cr.yp.toc.tf"</span>,<span class="number">37313</span>)</span><br><span class="line"></span><br><span class="line">def <span class="built_in">format</span>(s):</span><br><span class="line">	<span class="built_in">value</span> = re.findall(<span class="string">".*?(\\d+).*?"</span>,s)</span><br><span class="line">	print(<span class="built_in">len</span>(<span class="built_in">value</span>))</span><br><span class="line">	<span class="built_in">length</span> = iroot(<span class="built_in">len</span>(<span class="built_in">value</span>),int(<span class="number">2</span>))[<span class="number">0</span>]</span><br><span class="line">	m=[]</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="built_in">length</span>):</span><br><span class="line">		mm=[]</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="built_in">length</span>):</span><br><span class="line">			mm.append(int(<span class="built_in">value</span>[i*<span class="built_in">length</span>+j]))</span><br><span class="line">		m.append(mm)</span><br><span class="line">	<span class="literal">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">20</span>):</span><br><span class="line">	sh.recvuntil(<span class="string">"M = "</span>)</span><br><span class="line">	s = sh.recvuntil(<span class="string">"Send the order"</span>)</span><br><span class="line">	m = <span class="built_in">format</span>(s.decode())</span><br><span class="line">	M = Matrix(GF(<span class="number">127</span>),m)</span><br><span class="line">	sh.sendline(str(M.multiplicative_order()))</span><br></pre></td></tr></table></figure>

<h4 id="result-9"><a href="#result-9" class="headerlink" title="result"></a>result</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b<span class="comment">'| Congrats, you got the flag: CCTF&#123;ma7RicES_4R3_u5EfuL_1n_PUbl!c-k3y_CrYpt0gr4Phy!&#125;\n'</span></span><br></pre></td></tr></table></figure>

<h3 id="Oak-land"><a href="#Oak-land" class="headerlink" title="Oak land"></a>Oak land</h3><p>分值：122</p>
<p>考点：离散对数</p>
<h4 id="challenge-10"><a href="#challenge-10" class="headerlink" title="challenge"></a>challenge</h4><p>Where to publish the <a href="https://cr.yp.toc.tf/tasks/oak_land_792463a640df5b17b1ac0c156e8f940c4f5d3076.txz" target="_blank" rel="noopener">great</a> work!</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from flag import flag</span><br><span class="line"></span><br><span class="line">p = 7389313481223384214994762619823300589978423075857540712007981373887018860174846208000957230283669342186460652521580595183523706412588695116906905718440770776239313669678685198683933547601793742596023475603667</span><br><span class="line">e = 31337</span><br><span class="line">f = 7236042467316654159796543399639966340258093274047941788600980451877044636122969830708918356119442228154447395855689559447196348683125675305629837437591088260218138895919514078948650757100432223219969122629790</span><br><span class="line">g = 1878626136321051642174045874618248475160620873585704351202865003185878331837410979441756843820270907300810543618813757245154196050399357659526631164136221434463496532263979506870318259276669412698827040743576</span><br><span class="line"></span><br><span class="line">x = bytes_to_long(flag.encode('utf-8'))</span><br><span class="line">assert x &lt; p</span><br><span class="line">c = (110 * pow(e, x, p) + 313 * pow(f, x, p) + 114 * pow(g, x, p)) % p</span><br><span class="line">print(f'c = &#123;c&#125;')</span><br></pre></td></tr></table></figure>

<h4 id="Thought-8"><a href="#Thought-8" class="headerlink" title="Thought"></a>Thought</h4><p>$c \equiv 110 \cdot e^x + 313 \cdot f^x+114\cdot g^x \pmod p$</p>
<p>$\to f \equiv e^y ,g \equiv e^z  $</p>
<p>$\to c \equiv 110 \cdot e^{x} +  313 \cdot e^{xy} + 114 \cdot  e^{xz} \pmod p$</p>
<p>$\to c \equiv 110 \cdot e^x + 313 \cdot e^{-x} + 114 \cdot e^{-2x} \pmod p$</p>
<h4 id="exp-10"><a href="#exp-10" class="headerlink" title="exp"></a>exp</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">c = 871346503375040565701864845493751233877009611275883500035764036792906970084258238763963152627486758242101207127598485219754255161617890137664012548226251138485059295263306930653899766537171223837761341914356</span><br><span class="line">p = 7389313481223384214994762619823300589978423075857540712007981373887018860174846208000957230283669342186460652521580595183523706412588695116906905718440770776239313669678685198683933547601793742596023475603667</span><br><span class="line">e = 31337</span><br><span class="line">f = 7236042467316654159796543399639966340258093274047941788600980451877044636122969830708918356119442228154447395855689559447196348683125675305629837437591088260218138895919514078948650757100432223219969122629790</span><br><span class="line">g = 1878626136321051642174045874618248475160620873585704351202865003185878331837410979441756843820270907300810543618813757245154196050399357659526631164136221434463496532263979506870318259276669412698827040743576</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = Zmod(p)[]</span><br><span class="line"></span><br><span class="line">f = 110 * x^3 + 313 * x +114 - c*x^2</span><br><span class="line"></span><br><span class="line">x0 = f.roots()[0][0]</span><br><span class="line"></span><br><span class="line">flag = discrete_log(Mod(x0,p),Mod(e,p))</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">print(long_to_bytes(flag))</span><br></pre></td></tr></table></figure>

<h4 id="result-10"><a href="#result-10" class="headerlink" title="result"></a>result</h4><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b'CCTF&#123;V<span class="number">3333</span>3rY_eeeeZy_DLP_cH41L3n9E!&#125;'</span><br></pre></td></tr></table></figure>

<h3 id="Cantilever"><a href="#Cantilever" class="headerlink" title="Cantilever"></a>Cantilever</h3><p>分值：79</p>
<p>考点：$p-1 \ is \ smooth$</p>
<h4 id="challenge-11"><a href="#challenge-11" class="headerlink" title="challenge"></a>challenge</h4><p>What if you can find the <a href="https://cr.yp.toc.tf/tasks/cantilever_6f7ed95cc7b0853f2dfb847be06d074224c49570.txz" target="_blank" rel="noopener">message</a>? If you can, that means you are genius, because we harden our crypto system with a very modern tool!</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_primes</span><span class="params">(nbit, imbalance)</span>:</span></span><br><span class="line">	p = <span class="number">2</span></span><br><span class="line">	FACTORS = [p]</span><br><span class="line">	<span class="keyword">while</span> p.bit_length() &lt; nbit - <span class="number">2</span> * imbalance:</span><br><span class="line">		factor = getPrime(imbalance)</span><br><span class="line">		FACTORS.append(factor)</span><br><span class="line">		p *= factor</span><br><span class="line">	rbit = (nbit - p.bit_length()) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		r, s = [getPrime(rbit) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">'01'</span>]</span><br><span class="line">		_p = p * r * s</span><br><span class="line">		<span class="keyword">if</span> _p.bit_length() &lt; nbit: rbit += <span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> _p.bit_length() &gt; nbit: rbit -= <span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> isPrime(_p + <span class="number">1</span>):</span><br><span class="line">			FACTORS.extend((r, s))</span><br><span class="line">			p = _p + <span class="number">1</span></span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">	FACTORS.sort()</span><br><span class="line">	<span class="keyword">return</span> (p, FACTORS)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genkey</span><span class="params">(nbit, imbalance, e)</span>:</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		p, FACTORS = gen_primes(nbit // <span class="number">2</span>, imbalance)</span><br><span class="line">		<span class="keyword">if</span> len(FACTORS) != len(set(FACTORS)):</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		q, q_factors = gen_primes(nbit // <span class="number">2</span>, imbalance + <span class="number">1</span>)</span><br><span class="line">		<span class="keyword">if</span> len(q_factors) != len(set(q_factors)):</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		factors = FACTORS + q_factors</span><br><span class="line">		<span class="keyword">if</span> e <span class="keyword">not</span> <span class="keyword">in</span> factors:</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">	n = p * q</span><br><span class="line">	<span class="keyword">return</span> n, (p, q)</span><br><span class="line"></span><br><span class="line">nbit = <span class="number">2048</span></span><br><span class="line">imbalance = <span class="number">19</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">m_1 = bytes_to_long(flag[:len(flag) // <span class="number">2</span>])</span><br><span class="line">m_2 = bytes_to_long(flag[len(flag) // <span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line">n, PRIMES = genkey(nbit, imbalance, e)</span><br><span class="line"></span><br><span class="line">c_1 = pow(m_1, e, n)</span><br><span class="line">c_2 = pow(e, m_2, n)</span><br><span class="line"></span><br><span class="line">print(<span class="string">f'n = <span class="subst">&#123;n&#125;</span>'</span>)</span><br><span class="line">print(<span class="string">f'c_1 = <span class="subst">&#123;c_1&#125;</span>'</span>)</span><br><span class="line">print(<span class="string">f'c_2 = <span class="subst">&#123;c_2&#125;</span>'</span>)</span><br></pre></td></tr></table></figure>

<h4 id="Thought-9"><a href="#Thought-9" class="headerlink" title="Thought"></a>Thought</h4><h4 id="exp-11"><a href="#exp-11" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_primes</span><span class="params">(nbit, imbalance)</span>:</span></span><br><span class="line">	p = <span class="number">2</span></span><br><span class="line">	FACTORS = [p]</span><br><span class="line">	<span class="keyword">while</span> p.bit_length() &lt; nbit - <span class="number">2</span> * imbalance:</span><br><span class="line">		factor = getPrime(imbalance)</span><br><span class="line">		FACTORS.append(factor)</span><br><span class="line">		p *= factor</span><br><span class="line">	rbit = (nbit - p.bit_length()) // <span class="number">2</span></span><br><span class="line">	print(rbit)</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		r, s = [getPrime(rbit) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">'01'</span>]</span><br><span class="line">		_p = p * r * s</span><br><span class="line">		<span class="keyword">if</span> _p.bit_length() &lt; nbit: rbit += <span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> _p.bit_length() &gt; nbit: rbit -= <span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> isPrime(_p + <span class="number">1</span>):</span><br><span class="line">			FACTORS.extend((r, s))</span><br><span class="line">			p = _p + <span class="number">1</span></span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">	FACTORS.sort()</span><br><span class="line">	print(FACTORS)</span><br><span class="line">	<span class="keyword">return</span> (p, FACTORS)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genkey</span><span class="params">(nbit, imbalance, e)</span>:</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		p, FACTORS = gen_primes(nbit // <span class="number">2</span>, imbalance)</span><br><span class="line">		<span class="keyword">if</span> len(FACTORS) != len(set(FACTORS)):</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		q, q_factors = gen_primes(nbit // <span class="number">2</span>, imbalance + <span class="number">1</span>)</span><br><span class="line">		<span class="keyword">if</span> len(q_factors) != len(set(q_factors)):</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		factors = FACTORS + q_factors</span><br><span class="line">		<span class="keyword">if</span> e <span class="keyword">not</span> <span class="keyword">in</span> factors:</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">	n = p * q</span><br><span class="line">	<span class="keyword">return</span> n, (p, q)</span><br><span class="line"></span><br><span class="line">nbit = <span class="number">2048</span></span><br><span class="line">imbalance = <span class="number">19</span></span><br><span class="line">e = <span class="number">0x10001</span>	</span><br><span class="line"><span class="comment">#n, PRIMES = genkey(nbit, imbalance, e)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Pollard_p_1</span><span class="params">(N)</span>:</span></span><br><span class="line">	print(<span class="string">"[+]Trying Pollard's p-1...\n"</span>)</span><br><span class="line">	a = <span class="number">2</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		f = a</span><br><span class="line">		<span class="comment"># precompute</span></span><br><span class="line">		<span class="keyword">for</span> n <span class="keyword">in</span> tqdm(range(<span class="number">1</span>, <span class="number">887651</span>)):</span><br><span class="line">			f = powmod(f, n, N)</span><br><span class="line">		<span class="keyword">for</span> n <span class="keyword">in</span> tqdm(range(<span class="number">887651</span>, <span class="number">10466421</span>)):</span><br><span class="line">			f = powmod(f, n, N)</span><br><span class="line">			<span class="keyword">if</span> n % <span class="number">15</span> == <span class="number">0</span>:</span><br><span class="line">				p = gcd(f<span class="number">-1</span>, N)</span><br><span class="line">				<span class="keyword">if</span> <span class="number">1</span> &lt; p &lt; N:</span><br><span class="line">					q = N // p</span><br><span class="line">					print(<span class="string">"p: "</span>, p)</span><br><span class="line">					print(<span class="string">"q: "</span>, q)</span><br><span class="line">					<span class="keyword">return</span> p,q</span><br><span class="line">N=<span class="number">7069789930583271525053215046247773438899869283661158227309691853515987055334306019600324056376312479212090202373516405860759222837585952590589336295698718699890424169542280710721069784487366121478569760563045886361884895363592898476736269784284754788133722060718026577238640218755539268465317292713320841554802703379684173485217045274942603346947299152498798736808975912326592689302969859834957202716983626393365387411319175917999258829839695189774082810459527737342402920881184864625678296442001837072332161966439361793009893108796934406114288057583563496587655548536011677451960307597573257032154009427010069578913</span></span><br><span class="line"><span class="comment">#Pollard_p_1(N)</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p=<span class="number">83408372012221120677052349409462320990177094246143674474872152829440524098582262384066400107950985845255268335597502228206679771838750219696329523257176739436871327238322817403970284015587320158034304282786944710043150568360761457471641695390427267786485448748458445872307883254297662715749746270343116946519</span></span><br><span class="line">q=<span class="number">84761154786085445040051273337185621770653977624442810400422736258693219544281946893222923335092616440575888204882883202879374137962201839964482318483860286412488851522612902055732831909496637360268825720155284438779235801463340052531340653630637729255285872455686692027630814695155220888112228977346697309127</span></span><br><span class="line">c_1 = <span class="number">488692928085934899944055554857568564903346089951134051486941368561567330884363274156339625953702601270565654444836193796061118053575538224794730472032345171432952984560662218697488844007827176184413713651118743456250147472678673801728916283759932987216388378211555067885210167894310696549664382751443669387953644382833924884208966436685137553434532738845959014828804809425096115758364136546390809453200055265653531950423111482644330073443545410319576097902472017235065047191133112557289289189187696092145850680765843608118584107829268136014912479701945735063525799796920293418182776436767911172221104640501952880057</span></span><br><span class="line">c_2 = <span class="number">109770827223661560471527567179288748906402603483328748683689436879660543465776899146036833470531024202351087008847594392666852763100570391337823820240726499421306887565697452868723849092658743267256316770223643723095601213088336064635680075206929620159782416078143076506249031972043819429093074684182845530529249907297736582589125917235222921623698038868900282049587768700860009877737045693722732170123306528145661683416808514556360429554775212088169626620488741903267154641722293484797745665402402381445609873333905772582972140944493849645600529147490903067975300304532955461710562911203871840101407995813072692212</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">d = inverse(e,(p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">m1 = long_to_bytes(pow(c_1,d,p*q))</span><br><span class="line"></span><br><span class="line">m2p = discrete_log(Mod(c_2,p),Mod(e,p))</span><br><span class="line">m2q = discrete_log(Mod(c_2,q),Mod(e,q))</span><br><span class="line">print(m1+long_to_bytes(crt([m2p,m2q],[p,q])))</span><br></pre></td></tr></table></figure>

<h4 id="result-11"><a href="#result-11" class="headerlink" title="result"></a>result</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">b'CCTF&#123;5L3Ek_4s__s1lK__Ri9H7?!&#125;'</span></span><br></pre></td></tr></table></figure>

<h3 id="Side-step"><a href="#Side-step" class="headerlink" title="Side step"></a>Side step</h3><p>分值：146</p>
<p>考点：“侧信道”</p>
<h4 id="challenge-12"><a href="#challenge-12" class="headerlink" title="challenge"></a>challenge</h4><p>I like to have my own <a href="https://cr.yp.toc.tf/tasks/sidestep_d1112a5118617fd51e167df4e3a8e52d3ce4fa09.txz" target="_blank" rel="noopener">pow</a>!</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nc <span class="number">01</span><span class="selector-class">.cr</span><span class="selector-class">.yp</span><span class="selector-class">.toc</span><span class="selector-class">.tf</span> <span class="number">17331</span></span><br><span class="line">nc <span class="number">02</span><span class="selector-class">.cr</span><span class="selector-class">.yp</span><span class="selector-class">.toc</span><span class="selector-class">.tf</span> <span class="number">17331</span></span><br><span class="line">nc <span class="number">03</span><span class="selector-class">.cr</span><span class="selector-class">.yp</span><span class="selector-class">.toc</span><span class="selector-class">.tf</span> <span class="number">17331</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random, sys</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pow_d</span><span class="params">(g, e, n)</span>:</span></span><br><span class="line">	t, r = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> bin(e)[<span class="number">2</span>:]:</span><br><span class="line">		<span class="keyword">if</span> r == <span class="number">4</span>: t += <span class="number">1</span></span><br><span class="line">		r = pow(r, <span class="number">2</span>, n)</span><br><span class="line">		<span class="keyword">if</span> _ == <span class="string">'1'</span>: r = r * g % n</span><br><span class="line">	<span class="keyword">return</span> t, r</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ts</span><span class="params">(m, p)</span>:</span></span><br><span class="line">	m = m % p</span><br><span class="line">	<span class="keyword">return</span> pow(m, (p - <span class="number">1</span>) // <span class="number">2</span>, p) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">die</span><span class="params">(*args)</span>:</span></span><br><span class="line">	pr(*args)</span><br><span class="line">	quit()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pr</span><span class="params">(*args)</span>:</span></span><br><span class="line">	s = <span class="string">" "</span>.join(map(str, args))</span><br><span class="line">	sys.stdout.write(s + <span class="string">"\n"</span>)</span><br><span class="line">	sys.stdout.flush()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sc</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="keyword">return</span> sys.stdin.readline().strip()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">	border = <span class="string">"|"</span></span><br><span class="line">	pr(border*<span class="number">72</span>)</span><br><span class="line">	pr(border, <span class="string">"Hi all cryptographers! Welcome to the Sidestep task, we do powing!!!"</span>, border)</span><br><span class="line">	pr(border, <span class="string">"You should solve a DLP challenge in some special way to get the flag"</span>, border)</span><br><span class="line"></span><br><span class="line">	p = <span class="number">2</span> ** <span class="number">1024</span> - <span class="number">2</span> ** <span class="number">234</span> - <span class="number">2</span> ** <span class="number">267</span> - <span class="number">2</span> ** <span class="number">291</span> - <span class="number">2</span> ** <span class="number">403</span> - <span class="number">1</span></span><br><span class="line">	s = random.randint(<span class="number">2</span>, (p - <span class="number">1</span>) // <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		pr(<span class="string">"| Options: \n|\t[T]ry the magic machine \n|\t[Q]uit"</span>)</span><br><span class="line">		ans = sc().lower()</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> ans == <span class="string">'t'</span>:</span><br><span class="line">			pr(border, <span class="string">"please send your desired integer: "</span>)</span><br><span class="line">			g = sc()</span><br><span class="line">			<span class="keyword">try</span>:</span><br><span class="line">				g = int(g)</span><br><span class="line">			<span class="keyword">except</span>:</span><br><span class="line">				die(border, <span class="string">"The given input is not integer!"</span>)</span><br><span class="line">			<span class="keyword">if</span> ts(g, p):</span><br><span class="line">				t, r = pow_d(g, s, p)</span><br><span class="line">				<span class="keyword">if</span> r == <span class="number">4</span>:</span><br><span class="line">					die(border, <span class="string">f'Great! you got the flag: <span class="subst">&#123;flag&#125;</span>'</span>)</span><br><span class="line">				<span class="keyword">else</span>:</span><br><span class="line">					pr(border, <span class="string">f"t, r = <span class="subst">&#123;t, r&#125;</span>"</span>)</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				pr(border, <span class="string">"The given base is NOT valid!!!"</span>)</span><br><span class="line">		<span class="keyword">elif</span> ans == <span class="string">'q'</span>:</span><br><span class="line">			die(border, <span class="string">"Quitting ..."</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			die(border, <span class="string">"Bye bye ..."</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>

<h4 id="Thought-10"><a href="#Thought-10" class="headerlink" title="Thought"></a>Thought</h4><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="attr">r</span> == <span class="number">4</span>: t += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h4 id="exp-12"><a href="#exp-12" class="headerlink" title="exp"></a>exp</h4><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line">from gmpy2 import iroot</span><br><span class="line">from tqdm import *</span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line"><span class="keyword">sh</span> = remote(<span class="string">"01.cr.yp.toc.tf"</span>,17331)</span><br><span class="line"></span><br><span class="line">p = 2 ** 1024 - 2 ** 234 - 2 ** 267 - 2 ** 291 - 2 ** 403 - 1</span><br><span class="line">x = <span class="built_in">Mod</span>(2,p)</span><br><span class="line">s=<span class="string">"1"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="keyword">range</span>(0,1024)):</span><br><span class="line">	<span class="keyword">if</span> int(s,2) &gt;= (p-1)<span class="comment">//2:</span></span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">sh</span>.recvuntil(<span class="string">"[Q]uit\n"</span>)</span><br><span class="line">	<span class="keyword">sh</span>.sendline(<span class="string">"T"</span>)</span><br><span class="line">	<span class="keyword">sh</span>.recvuntil(<span class="string">"integer: \n"</span>)</span><br><span class="line">	<span class="keyword">sh</span>.sendline(str(x.nth_root(int(s,2))))</span><br><span class="line">	FLAG = <span class="keyword">sh</span>.recvuntil(<span class="string">"\n"</span>)[:-1]</span><br><span class="line">	<span class="keyword">if</span> b<span class="string">"Great!"</span> <span class="keyword">in</span> FLAG:</span><br><span class="line">		<span class="keyword">print</span>(FLAG)</span><br><span class="line">		<span class="keyword">exit</span>()</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		t,r = eval(FLAG[9:])</span><br><span class="line">		#<span class="keyword">print</span>(t,r)</span><br><span class="line">	<span class="keyword">if</span> r==2:</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">if</span> t == 1:</span><br><span class="line">		s+=<span class="string">"0"</span></span><br><span class="line">	elif t == 0:</span><br><span class="line">		s+=<span class="string">"1"</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="keyword">print</span>(FLAG)</span><br><span class="line"></span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"[Q]uit\n"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">"T"</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"integer: \n"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(str((2*x).nth_root(int(s,2))))</span><br><span class="line">FLAG = <span class="keyword">sh</span>.recvuntil(<span class="string">"\n"</span>)[:-1]</span><br><span class="line"><span class="keyword">print</span>(FLAG)</span><br></pre></td></tr></table></figure>

<h4 id="result-12"><a href="#result-12" class="headerlink" title="result"></a>result</h4><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b'| Great! you got the flag: CCTF&#123;h0W_iZ_h4rD_D15crEt3_lO9ar!Thm_c0nJec7ur3?!&#125;<span class="string">'</span></span><br></pre></td></tr></table></figure>

<h3 id="Faonsa"><a href="#Faonsa" class="headerlink" title="Faonsa *"></a>Faonsa *</h3><p>分值：180</p>
<p>考点：</p>
<h4 id="challenge-13"><a href="#challenge-13" class="headerlink" title="challenge"></a>challenge</h4><p>Deploying the fault attack in real life is hard, we deployed it <a href="https://cr.yp.toc.tf/tasks/faonsa_916139a788e6acc0befaaf653f3d085ba19559d8.txz" target="_blank" rel="noopener">artificially</a>!</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">diff</span><span class="params">(a, b)</span>:</span></span><br><span class="line">	<span class="keyword">assert</span> a.bit_length() == b.bit_length()</span><br><span class="line">	w, l = <span class="number">0</span>, a.bit_length()</span><br><span class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> range(l):</span><br><span class="line">		<span class="keyword">if</span> bin(a)[<span class="number">2</span>:][_] != bin(b)[<span class="number">2</span>:][_]: w += <span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> w</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sign_esa</span><span class="params">(pubkey, x, m)</span>:</span></span><br><span class="line">	g, p, y = pubkey</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		k = getRandomRange(<span class="number">2</span>, p<span class="number">-1</span>)</span><br><span class="line">		<span class="keyword">if</span> gcd(k, p<span class="number">-1</span>) == <span class="number">1</span>:</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">	u = pow(g, k, p)</span><br><span class="line">	v = (m - x * u) * inverse(k, p - <span class="number">1</span>) % (p - <span class="number">1</span>)</span><br><span class="line">	<span class="keyword">return</span> (u, v)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">verify_esa</span><span class="params">(pubkey, sgn, m)</span>:</span></span><br><span class="line">	g, p, y = pubkey</span><br><span class="line">	u, v = sgn</span><br><span class="line">	<span class="keyword">return</span> pow(y, u, p) * pow(u, v, p) % p == pow(g, m, p)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">die</span><span class="params">(*args)</span>:</span></span><br><span class="line">	pr(*args)</span><br><span class="line">	quit()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pr</span><span class="params">(*args)</span>:</span></span><br><span class="line">	s = <span class="string">" "</span>.join(map(str, args))</span><br><span class="line">	sys.stdout.write(s + <span class="string">"\n"</span>)</span><br><span class="line">	sys.stdout.flush()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sc</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="keyword">return</span> sys.stdin.readline().strip()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">	border = <span class="string">"|"</span></span><br><span class="line">	pr(border*<span class="number">72</span>)</span><br><span class="line">	pr(border, <span class="string">"Hello guys! This is a another challenge on fault attack too, again  "</span>, border)</span><br><span class="line">	pr(border, <span class="string">"our storage could apply at most `l' bit fault on ElGamal modulus, p,"</span>, border)</span><br><span class="line">	pr(border, <span class="string">"try to sign the given message and get the flag! Have fun and enjoy!!"</span>, border)</span><br><span class="line">	pr(border*<span class="number">72</span>)</span><br><span class="line">	pr(border, <span class="string">"Generating the parameters, it's time consuming ..."</span>)</span><br><span class="line">	nbit = <span class="number">256</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		_p = getPrime(<span class="number">255</span>)</span><br><span class="line">		p = <span class="number">2</span> * _p + <span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> isPrime(p):</span><br><span class="line">			g = <span class="number">2</span></span><br><span class="line">			<span class="keyword">if</span> pow(g, _p, p) != <span class="number">1</span>: <span class="keyword">break</span></span><br><span class="line">			<span class="keyword">else</span>: g += <span class="number">1</span></span><br><span class="line">	x = getRandomRange(<span class="number">2</span>, p // <span class="number">2</span>)</span><br><span class="line">	y = pow(g, x, p)</span><br><span class="line"></span><br><span class="line">	B, l = [int(b) <span class="keyword">for</span> b <span class="keyword">in</span> bin(p)[<span class="number">2</span>:]], <span class="number">30</span></span><br><span class="line">	</span><br><span class="line">	MSG = <span class="string">"4lL crypt0sy5t3ms suck5 fr0m faul7 atTaCk5 :P"</span></span><br><span class="line">	m = bytes_to_long(MSG.encode(<span class="string">'utf-8'</span>))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		pr(<span class="string">"| Options: \n|\t[A]pply fault \n|\t[G]et the parameters \n|\t[S]ign the message \n|\t[V]erify the signature \n|\t[Q]uit"</span>)</span><br><span class="line">		ans = sc().lower()</span><br><span class="line">		<span class="keyword">if</span> ans == <span class="string">'a'</span>:</span><br><span class="line">			_B = B</span><br><span class="line">			pr(border, <span class="string">f"please send at most <span class="subst">&#123;l&#125;</span>-tuple array from indices of bits of ElGamal modulus, like: 5, 12, ..."</span>)</span><br><span class="line">			ar = sc()</span><br><span class="line">			<span class="keyword">try</span>:</span><br><span class="line">				ar = [int(_) <span class="keyword">for</span> _ <span class="keyword">in</span> ar.split(<span class="string">','</span>)]</span><br><span class="line">				<span class="keyword">if</span> len(ar) &lt;= l:</span><br><span class="line">					<span class="keyword">for</span> i <span class="keyword">in</span> range(len(ar)): </span><br><span class="line">						_B[ar[i]] = (_B[ar[i]] + <span class="number">1</span>) % <span class="number">2</span></span><br><span class="line">					P = int(<span class="string">''</span>.join([str(b) <span class="keyword">for</span> b <span class="keyword">in</span> _B]), <span class="number">2</span>)</span><br><span class="line">					Y = pow(g, x, P)</span><br><span class="line">				<span class="keyword">else</span>: <span class="keyword">raise</span> Exception(<span class="string">'Invalid length!'</span>)</span><br><span class="line">			<span class="keyword">except</span>: pr(border, <span class="string">"Something went wrong!!"</span>)</span><br><span class="line">		<span class="keyword">elif</span> ans == <span class="string">'g'</span>:</span><br><span class="line">			pr(border, <span class="string">f'p = <span class="subst">&#123;p&#125;</span>'</span>)</span><br><span class="line">			pr(border, <span class="string">f'g = <span class="subst">&#123;g&#125;</span>'</span>)</span><br><span class="line">			pr(border, <span class="string">f'y = <span class="subst">&#123;y&#125;</span>'</span>)</span><br><span class="line">		<span class="keyword">elif</span> ans == <span class="string">"v"</span>:</span><br><span class="line">			pr(border, <span class="string">"please send signature to verify: "</span>)</span><br><span class="line">			_flag, signature = <span class="literal">False</span>, sc()</span><br><span class="line">			<span class="keyword">try</span>:</span><br><span class="line">				signature = [int(_) <span class="keyword">for</span> _ <span class="keyword">in</span> signature.split(<span class="string">','</span>)]</span><br><span class="line">				<span class="keyword">if</span> verify_esa((g, P, Y), signature, m): _flag = <span class="literal">True</span></span><br><span class="line">				<span class="keyword">else</span>: pr(border, <span class="string">"Your signature is not valid!!"</span>)</span><br><span class="line">			<span class="keyword">except</span>:</span><br><span class="line">				pr(border, <span class="string">"Something went wrong!!"</span>)</span><br><span class="line">			<span class="keyword">if</span> _flag: die(border, <span class="string">"Congrats! your got the flag: "</span> + flag)</span><br><span class="line">		<span class="keyword">elif</span> ans == <span class="string">'s'</span>:</span><br><span class="line">			pr(border, <span class="string">"Please send your message to sign: "</span>)</span><br><span class="line">			msg = sc().encode(<span class="string">'utf-8'</span>)</span><br><span class="line">			<span class="keyword">if</span> msg != MSG.encode(<span class="string">'utf-8'</span>):</span><br><span class="line">				_m = bytes_to_long(msg)</span><br><span class="line">				<span class="keyword">try</span>:</span><br><span class="line">					sgn = sign_esa((g, P, Y), x, _m)</span><br><span class="line">					pr(border, <span class="string">f'sign = <span class="subst">&#123;sgn&#125;</span>'</span>)</span><br><span class="line">				<span class="keyword">except</span>:</span><br><span class="line">					pr(border, <span class="string">"Something went wrong!!"</span>)</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				pr(border, <span class="string">"Kidding me!? Really?"</span>)</span><br><span class="line">		<span class="keyword">elif</span> ans == <span class="string">'q'</span>: die(<span class="string">"Quitting ..."</span>)</span><br><span class="line">		<span class="keyword">else</span>: die(<span class="string">"Bye bye ..."</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>: main()</span><br></pre></td></tr></table></figure>

<h4 id="Thought-11"><a href="#Thought-11" class="headerlink" title="Thought"></a>Thought</h4><h4 id="exp-13"><a href="#exp-13" class="headerlink" title="exp"></a>exp</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">from sympy import isprime</span><br><span class="line">from Crypto.Util.<span class="keyword">number</span> import *</span><br><span class="line">import re</span><br><span class="line">from tqdm import *</span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line"><span class="keyword">sh</span> = remote(<span class="string">"06.cr.yp.toc.tf"</span>,<span class="number">31117</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"[Q]uit"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">"G"</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"| p = "</span>)</span><br><span class="line"><span class="keyword">p</span> = <span class="keyword">int</span>(<span class="keyword">sh</span>.recvuntil(<span class="string">"\n"</span>)[:-<span class="number">1</span>])</span><br><span class="line"><span class="keyword">print</span>(<span class="string">"[+] p = "</span>,<span class="keyword">p</span>)</span><br><span class="line">s = bin(<span class="keyword">p</span>)[<span class="number">2</span>:].rjust(<span class="number">256</span>,<span class="string">'0'</span>)</span><br><span class="line"><span class="keyword">sl</span> = <span class="keyword">list</span>(s)</span><br><span class="line"><span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">	sll = <span class="keyword">sl</span>.<span class="keyword">copy</span>()</span><br><span class="line">	sll[i] = str((<span class="keyword">int</span>(sll[i]) + <span class="number">1</span>) % <span class="number">2</span>)</span><br><span class="line">	ss = <span class="string">''</span>.<span class="keyword">join</span>(i <span class="keyword">for</span> i in sll)</span><br><span class="line">	ss = <span class="keyword">int</span>(ss,<span class="number">2</span>)</span><br><span class="line">	<span class="keyword">if</span> isprime(ss):</span><br><span class="line">		<span class="keyword">print</span>(<span class="string">"[+] i = "</span>,i)</span><br><span class="line">		MSG = <span class="string">"4lL crypt0sy5t3ms suck5 fr0m faul7 atTaCk5 :P"</span></span><br><span class="line">		<span class="keyword">m</span> = bytes_to_long(MSG.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">		<span class="keyword">sh</span>.recvuntil(<span class="string">"[Q]uit"</span>)</span><br><span class="line">		<span class="keyword">sh</span>.sendline(<span class="string">"A"</span>)</span><br><span class="line">		<span class="keyword">sh</span>.recvuntil(<span class="string">"...\n"</span>)</span><br><span class="line">		<span class="keyword">sh</span>.sendline(str(i))</span><br><span class="line">		<span class="keyword">sh</span>.recvuntil(<span class="string">"[Q]uit"</span>)</span><br><span class="line">		<span class="keyword">sh</span>.sendline(<span class="string">"S"</span>)</span><br><span class="line">		<span class="keyword">sh</span>.recvuntil(<span class="string">"sign: \n"</span>)</span><br><span class="line">		<span class="keyword">sh</span>.sendline(<span class="string">"\x004lL crypt0sy5t3ms suck5 fr0m faul7 atTaCk5 :P"</span>)</span><br><span class="line">		<span class="keyword">sh</span>.recvuntil(<span class="string">"sign = ("</span>)</span><br><span class="line">		data = <span class="keyword">sh</span>.recvuntil(<span class="string">")"</span>)[:-<span class="number">1</span>]</span><br><span class="line">		<span class="keyword">sh</span>.recvuntil(<span class="string">"[Q]uit"</span>)</span><br><span class="line">		<span class="keyword">sh</span>.sendline(<span class="string">"V"</span>)</span><br><span class="line">		<span class="keyword">sh</span>.recvuntil(<span class="string">"verify: "</span>)</span><br><span class="line">		<span class="keyword">sh</span>.sendline(data)</span><br><span class="line">		<span class="keyword">sh</span>.interactive()</span><br></pre></td></tr></table></figure>

<h4 id="result-13"><a href="#result-13" class="headerlink" title="result"></a>result</h4><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Congrats! your got the flag: CCTF&#123;n3W_4t7aCk_8y_fAuL7_!nJ3cT10N_oN_p!!!&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Resign"><a href="#Resign" class="headerlink" title="Resign"></a>Resign</h3><p>分值：122</p>
<p>考点：RSA，离散对数</p>
<h4 id="challenge-14"><a href="#challenge-14" class="headerlink" title="challenge"></a>challenge</h4><p>Everything is up to you, I just want it to be <a href="https://cr.yp.toc.tf/tasks/resign_dc1674e010ed20f13fd70ad1d2673abee44e04f9.txz" target="_blank" rel="noopener">verified</a>!</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc <span class="number">03</span><span class="selector-class">.cr</span><span class="selector-class">.yp</span><span class="selector-class">.toc</span><span class="selector-class">.tf</span> <span class="number">11137</span></span><br></pre></td></tr></table></figure>

<h4 id="Thought-12"><a href="#Thought-12" class="headerlink" title="Thought"></a>Thought</h4><h4 id="exp-14"><a href="#exp-14" class="headerlink" title="exp"></a>exp</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env <span class="keyword">python3</span></span><br><span class="line"></span><br><span class="line">from Crypto.Util.<span class="keyword">number</span> import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def gen_primes(nbit, imbalance):</span><br><span class="line">	<span class="keyword">p</span> = <span class="number">2</span></span><br><span class="line">	FACTORS = [<span class="keyword">p</span>]</span><br><span class="line">	<span class="keyword">while</span> <span class="keyword">p</span>.bit_length() &lt; nbit - <span class="number">2</span> * imbalance:</span><br><span class="line">		factor = getPrime(imbalance)</span><br><span class="line">		FACTORS.<span class="keyword">append</span>(factor)</span><br><span class="line">		<span class="keyword">p</span> *= factor</span><br><span class="line">	rbit = (nbit - <span class="keyword">p</span>.bit_length()) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> True:</span><br><span class="line">		r, s = [getPrime(rbit) <span class="keyword">for</span> _ in <span class="string">'01'</span>]</span><br><span class="line">		_p = <span class="keyword">p</span> * r * s</span><br><span class="line">		<span class="keyword">if</span> _p.bit_length() &lt; nbi<span class="variable">t:</span> rbit += <span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> _p.bit_length() &gt; nbi<span class="variable">t:</span> rbit -= <span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> isPrime(_p + <span class="number">1</span>):</span><br><span class="line">			FACTORS.<span class="built_in">extend</span>((r, s))</span><br><span class="line">			<span class="keyword">p</span> = _p + <span class="number">1</span></span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">	FACTORS.<span class="keyword">sort</span>()</span><br><span class="line">	<span class="keyword">return</span> (<span class="keyword">p</span>, FACTORS)</span><br><span class="line"></span><br><span class="line">def genkey(nbit, imbalance, <span class="keyword">e</span>):</span><br><span class="line">	<span class="keyword">while</span> True:</span><br><span class="line">		<span class="keyword">p</span>, FACTORS = gen_primes(nbit // <span class="number">2</span>, imbalance)</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">len</span>(FACTORS) != <span class="built_in">len</span>(<span class="keyword">set</span>(FACTORS)):</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		q, q_factors = gen_primes(nbit // <span class="number">2</span>, imbalance + <span class="number">1</span>)</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">len</span>(q_factors) != <span class="built_in">len</span>(<span class="keyword">set</span>(q_factors)):</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		factors = FACTORS + q_factors</span><br><span class="line">		<span class="keyword">if</span> <span class="keyword">e</span> not in factor<span class="variable">s:</span></span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">print</span>(<span class="keyword">p</span>.bit_length(),q.bit_length())</span><br><span class="line">	n = <span class="keyword">p</span> * q</span><br><span class="line">	<span class="keyword">return</span> n, (<span class="keyword">p</span>, q)</span><br><span class="line"></span><br><span class="line">nbit = <span class="number">2048</span></span><br><span class="line">imbalance = <span class="number">16</span></span><br><span class="line"><span class="keyword">e</span> = <span class="number">0</span>x10001</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n, PRIMES = genkey(nbit, imbalance, <span class="keyword">e</span>)</span><br><span class="line"><span class="keyword">print</span>(PRIMES)</span><br><span class="line"></span><br><span class="line">#!/usr/bin/env sage</span><br><span class="line">from pwn import *</span><br><span class="line">from Crypto.Util.<span class="keyword">number</span> import *</span><br><span class="line">from hashlib import sha1</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">sh</span> = remote(<span class="string">"03.cr.yp.toc.tf"</span>,<span class="number">11137</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"[Q]uit\n"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">"P"</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"SIGN = "</span>)</span><br><span class="line">MSG = <span class="keyword">b</span><span class="string">'::. Can you forge any signature? .::'</span></span><br><span class="line">h = bytes_to_long(sha1(MSG).digest())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SIGN = <span class="keyword">int</span>(<span class="keyword">sh</span>.recvuntil(<span class="string">"\n"</span>)[:-<span class="number">1</span>])</span><br><span class="line"><span class="keyword">print</span>(<span class="string">'[+] SIGN'</span>,SIGN)</span><br><span class="line"></span><br><span class="line"><span class="keyword">p</span> = <span class="number">111657144993852623256233363989000281515390441372107528881614340689818824455290685121511873461605564810943387707541782379213899558901650423480949095316252223627543325756537840564774645148163170125669641536489937366637706602313785316184656176701603589042384374855568020323292801352393162697967354397541828173999</span></span><br><span class="line">q = <span class="number">137452291102384188629897087949133529139596156344413834145488477828519011767513127595258850210995836074279851378837357321395849566085251970484428954340841155028617799079020425268855055662977244431658824300349726299807123259984818563478362175002364805620517750136398917859466563648383901744997103947168570641187</span></span><br><span class="line"></span><br><span class="line">hp = Mod(h,<span class="keyword">p</span>)</span><br><span class="line">hq = Mod(h,q)</span><br><span class="line">SIGNp = Mod(SIGN,<span class="keyword">p</span>)</span><br><span class="line">SIGNq = Mod(SIGN,q)</span><br><span class="line"><span class="keyword">dp</span> = discrete_log(SIGNp,hp)</span><br><span class="line">dq = discrete_log(SIGNq,hq)</span><br><span class="line"></span><br><span class="line">d = crt([<span class="keyword">dp</span>,dq],[<span class="keyword">p</span>-<span class="number">1</span>,q-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">int</span>(<span class="built_in">pow</span>(h,d,<span class="keyword">p</span>*q)) == SIGN:</span><br><span class="line">	<span class="keyword">if</span> GCD(d,(<span class="keyword">p</span>-<span class="number">1</span>)*(q-<span class="number">1</span>)) == <span class="number">1</span>:</span><br><span class="line">		<span class="keyword">print</span>(<span class="string">"fxxk"</span>)</span><br><span class="line">		<span class="keyword">e</span> = inverse(d,(<span class="keyword">p</span>-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">		<span class="keyword">sh</span>.recvuntil(<span class="string">"[Q]uit"</span>)</span><br><span class="line">		<span class="keyword">sh</span>.sendline(<span class="string">"G"</span>)</span><br><span class="line">		<span class="keyword">sh</span>.recvuntil(<span class="string">"e, p, q: \n"</span>)</span><br><span class="line">		<span class="keyword">sh</span>.sendline(str(<span class="keyword">e</span>)+<span class="string">','</span>+str(<span class="keyword">p</span>)+<span class="string">','</span>+str(q))</span><br><span class="line">		<span class="keyword">sh</span>.recvuntil(<span class="string">"[Q]uit"</span>)</span><br><span class="line">		<span class="keyword">sh</span>.sendline(<span class="string">"S"</span>)</span><br><span class="line">		<span class="keyword">sh</span>.recvuntil(<span class="string">"signature?'\n"</span>)</span><br><span class="line">		MSG = <span class="keyword">b</span><span class="string">'Can you forge any signature?'</span></span><br><span class="line">		h = bytes_to_long(sha1(MSG).digest())</span><br><span class="line">		SIGN = <span class="built_in">pow</span>(h,d,<span class="keyword">p</span>*q)</span><br><span class="line">		<span class="keyword">sh</span>.sendline(str(SIGN))</span><br><span class="line">		<span class="keyword">sh</span>.interactive()</span><br></pre></td></tr></table></figure>

<h4 id="result-14"><a href="#result-14" class="headerlink" title="result"></a>result</h4><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">DEBUG] Received <span class="number">0</span>x124 bytes:</span><br><span class="line">    b'||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n'</span><br><span class="line">    b'|  Hi, Try to guess our RSA private key to sign my message, talented   |\n'</span><br><span class="line">    b'|  hackers like you ;) are able to do it, they are *Super Guesser* :)  |\n'</span><br><span class="line">    b'||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n'</span><br><span class="line">[DEBUG] Received <span class="number">0</span>x79 bytes:</span><br><span class="line">    b'| Options: \n'</span><br><span class="line">    b'|\t[G]uess the secret key \n'</span><br><span class="line">    b'|\t[R]eveal the parameters \n'</span><br><span class="line">    b'|\t[S]ign the message \n'</span><br><span class="line">    b'|\t[P]rint the signature \n'</span><br><span class="line">    b'|\t[Q]uit\n'</span><br><span class="line">b'||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n|  Hi, Try to guess our RSA private key to sign my message, talented   |\n|  hackers like you ;) are able to do it, they are *Super Guesser* :)  |\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n| Options: \n|\t[G]uess the secret key \n|\t[R]eveal the parameters \n|\t[S]ign the message \n|\t[P]rint the signature \n|\t[Q]uit\n'</span><br><span class="line">[DEBUG] Sent <span class="number">0</span>x2 bytes:</span><br><span class="line">    b'P\n'</span><br><span class="line">[DEBUG] Received <span class="number">0</span>x2eb bytes:</span><br><span class="line">    b'| SIGN = <span class="number">18849794861792</span><span class="number">67172629071748</span><span class="number">77296068452591</span><span class="number">87613684595624</span><span class="number">94944521319157</span><span class="number">36127655586468</span><span class="number">11259096921761</span><span class="number">71908421490752</span><span class="number">03498070535803</span><span class="number">13002447852049</span><span class="number">30649379956166</span><span class="number">15032563017352</span><span class="number">36857122440722</span><span class="number">41350875975367</span><span class="number">04443466875148</span><span class="number">71770835063424</span><span class="number">45469016490120</span><span class="number">62296339342722</span><span class="number">08121761018746</span><span class="number">23720018150321</span><span class="number">03552831187030</span><span class="number">19055554562170</span><span class="number">22341243237754</span><span class="number">72475813828371</span><span class="number">30122826834664</span><span class="number">54035765617272</span><span class="number">99581941867010</span><span class="number">50720957511084</span><span class="number">82305696064164</span><span class="number">20370396411383</span><span class="number">55336433119609</span><span class="number">67384709366019</span><span class="number">16009093791135</span><span class="number">99458472780070</span><span class="number">91075054690456</span><span class="number">97991330196954</span><span class="number">30472732656301</span><span class="number">57888695674988</span><span class="number">23351192883947</span><span class="number">55897942744855</span><span class="number">90101615174673</span><span class="number">36307511440621</span><span class="number">96024646251056</span><span class="number">63962079644520</span>\n'</span><br><span class="line">    b'| Options: \n'</span><br><span class="line">    b'|\t[G]uess the secret key \n'</span><br><span class="line">    b'|\t[R]eveal the parameters \n'</span><br><span class="line">    b'|\t[S]ign the message \n'</span><br><span class="line">    b'|\t[P]rint the signature \n'</span><br><span class="line">    b'|\t[Q]uit\n'</span><br><span class="line">b'| SIGN = '</span><br><span class="line">[+] SIGN <span class="number">1884979486179267172629071748772960684525918761368459562494944521319157361276555864681125909692176171908421490752034980705358031300244785204930649379956166150325630173523685712244072241350875975367044434668751487177083506342445469016490120622963393427220812176101874623720018150321035528311870301905555456217022341243237754724758138283713012282683466454035765617272995819418670105072095751108482305696064164203703964113835533643311960967384709366019160090937911359945847278007091075054690456979913301969543047273265630157888695674988233511928839475589794274485590101615174673363075114406219602464625105663962079644520</span></span><br><span class="line">fxxk</span><br><span class="line">b'| Options: \n|\t[G]uess the secret key \n|\t[R]eveal the parameters \n|\t[S]ign the message \n|\t[P]rint the signature \n|\t[Q]uit'</span><br><span class="line">[DEBUG] Sent <span class="number">0</span>x2 bytes:</span><br><span class="line">    b'G\n'</span><br><span class="line">[DEBUG] Received <span class="number">0</span>x58 bytes:</span><br><span class="line">    b'| please send the RSA public exponent and PARAMS p, q separated by comma like e, p, q: \n'</span><br><span class="line">b'\n| please send the RSA public exponent and PARAMS p, q separated by comma like e, p, q: \n'</span><br><span class="line">[DEBUG] Sent <span class="number">0</span>x4d5 bytes:</span><br><span class="line">    b'<span class="number">10825091504561</span><span class="number">56106884081968</span><span class="number">15915691376033</span><span class="number">57927598060988</span><span class="number">10796864909671</span><span class="number">42940842184180</span><span class="number">35331507401167</span><span class="number">00026128780447</span><span class="number">86869648445988</span><span class="number">22054493384896</span><span class="number">21368675729546</span><span class="number">55413858664543</span><span class="number">99997588645643</span><span class="number">56677551698788</span><span class="number">75865534214412</span><span class="number">06966163574647</span><span class="number">66656368816629</span><span class="number">05368638288800</span><span class="number">58646360704979</span><span class="number">27528775619554</span><span class="number">28462109063192</span><span class="number">92983611239022</span><span class="number">50120620368264</span><span class="number">00845890532158</span><span class="number">37782734875214</span><span class="number">90405775436737</span><span class="number">57637885803923</span><span class="number">12003242698023</span><span class="number">97928442682665</span><span class="number">99188579295142</span><span class="number">61663284021093</span><span class="number">17610419406523</span><span class="number">06812645003552</span><span class="number">40156317118062</span><span class="number">20255873191159</span><span class="number">79826090516758</span><span class="number">20063419227798</span><span class="number">76987929771318</span><span class="number">33992363267393</span><span class="number">31375928280565</span><span class="number">19016523309961</span><span class="number">02671656984443</span><span class="number">69493760584355</span><span class="number">08905723342417</span>,<span class="number">11165714499385</span><span class="number">26232562333639</span><span class="number">89000281515390</span><span class="number">44137210752888</span><span class="number">16143406898188</span><span class="number">24455290685121</span><span class="number">51187346160556</span><span class="number">48109433877075</span><span class="number">41782379213899</span><span class="number">55890165042348</span><span class="number">09490953162522</span><span class="number">23627543325756</span><span class="number">53784056477464</span><span class="number">51481631701256</span><span class="number">69641536489937</span><span class="number">36663770660231</span><span class="number">37853161846561</span><span class="number">76701603589042</span><span class="number">38437485556802</span><span class="number">03232928013523</span><span class="number">93162697967354</span><span class="number">39754182817399</span>9,<span class="number">13745229110238</span><span class="number">41886298970879</span><span class="number">49133529139596</span><span class="number">15634441383414</span><span class="number">54884778285190</span><span class="number">11767513127595</span><span class="number">25885021099583</span><span class="number">60742798513788</span><span class="number">37357321395849</span><span class="number">56608525197048</span><span class="number">44289543408411</span><span class="number">55028617799079</span><span class="number">02042526885505</span><span class="number">56629772444316</span><span class="number">58824300349726</span><span class="number">29980712325998</span><span class="number">48185634783621</span><span class="number">75002364805620</span><span class="number">51775013639891</span><span class="number">78594665636483</span><span class="number">83901744997103</span><span class="number">94716857064118</span>7\n'</span><br><span class="line">[DEBUG] Received <span class="number">0</span>xb0 bytes:</span><br><span class="line">    b'| Great guess, now you are able to sign any message!!!\n'</span><br><span class="line">    b'| Options: \n'</span><br><span class="line">    b'|\t[G]uess the secret key \n'</span><br><span class="line">    b'|\t[R]eveal the parameters \n'</span><br><span class="line">    b'|\t[S]ign the message \n'</span><br><span class="line">    b'|\t[P]rint the signature \n'</span><br><span class="line">    b'|\t[Q]uit\n'</span><br><span class="line">b'| Great guess, now you are able to sign any message!!!\n| Options: \n|\t[G]uess the secret key \n|\t[R]eveal the parameters \n|\t[S]ign the message \n|\t[P]rint the signature \n|\t[Q]uit'</span><br><span class="line">[DEBUG] Sent <span class="number">0</span>x2 bytes:</span><br><span class="line">    b'S\n'</span><br><span class="line">[DEBUG] Received <span class="number">0</span>x56 bytes:</span><br><span class="line">    b'| Please send the signature of this message: \n'</span><br><span class="line">    b<span class="string">"| MSG = b'Can you forge any signature?'\n"</span></span><br><span class="line">b<span class="string">"\n| Please send the signature of this message: \n| MSG = b'Can you forge any signature?'\n"</span></span><br><span class="line">[DEBUG] Sent <span class="number">0</span>x269 bytes:</span><br><span class="line">    b'<span class="number">64059639428552</span><span class="number">03301347394631</span><span class="number">01460942399297</span><span class="number">62819720658813</span><span class="number">42338496966442</span><span class="number">57805302198021</span><span class="number">94474046668709</span><span class="number">23023663382787</span><span class="number">13022489239239</span><span class="number">38684613389461</span><span class="number">21986093285771</span><span class="number">24646063213314</span><span class="number">02037511532518</span><span class="number">32618215496457</span><span class="number">94602993723256</span><span class="number">95406570825250</span><span class="number">75384223510445</span><span class="number">52904116120857</span><span class="number">86645008135849</span><span class="number">18972603341691</span><span class="number">29314262771737</span><span class="number">61727060844012</span><span class="number">58955031379528</span><span class="number">84903432196931</span><span class="number">42684802201689</span><span class="number">16307424094843</span><span class="number">06960922609317</span><span class="number">42281815054211</span><span class="number">77268243717352</span><span class="number">04251547888147</span><span class="number">20864304742384</span><span class="number">44194579059472</span><span class="number">58696845422539</span><span class="number">70948474780322</span><span class="number">33134598568589</span><span class="number">61240857283061</span><span class="number">05700874715159</span><span class="number">07683694823038</span><span class="number">38552072802395</span><span class="number">75964954732151</span><span class="number">73554090359646</span><span class="number">13855294207256</span><span class="number">81762413901344</span><span class="number">76189114424111</span>\n'</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">[DEBUG] Received <span class="number">0</span>x4a bytes:</span><br><span class="line">    b'| Congrats! your got the flag: CCTF&#123;Unkn0wN_K3y_5h4rE_4t7aCk_0n_Th3_RSA!&#125;\n'</span><br><span class="line"><span class="string">| Congrats! your got the flag: CCTF&#123;Unkn0wN_K3y_5h4rE_4t7aCk_0n_Th3_RSA!&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="DBB"><a href="#DBB" class="headerlink" title="DBB"></a>DBB</h3><p>分值：103</p>
<p>考点：椭圆曲线poh-hellman</p>
<h4 id="challenge-15"><a href="#challenge-15" class="headerlink" title="challenge"></a>challenge</h4><p>Old school but fun <a href="https://cr.yp.toc.tf/tasks/DBB_ca600dcd7c2ac6c4c752846be416f2c819444a06.txz" target="_blank" rel="noopener">hopscotch</a>!</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> n, B, BASE_POINT, FLAG</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(FLAG)</span><br><span class="line"><span class="keyword">assert</span> m &lt; n</span><br><span class="line"></span><br><span class="line">F = IntegerModRing(n)</span><br><span class="line">E = EllipticCurve(F, [<span class="number">31337</span>, B])</span><br><span class="line"></span><br><span class="line">BASE_POINT = E(BASE_POINT)</span><br><span class="line"></span><br><span class="line">P = m * BASE_POINT</span><br><span class="line">print(<span class="string">f'n = <span class="subst">&#123;n&#125;</span>'</span>)</span><br><span class="line">print(<span class="string">f'BASE_POINT.x = <span class="subst">&#123;BASE_POINT.xy()[<span class="number">0</span>]&#125;</span>'</span>)</span><br><span class="line">print(<span class="string">f'P = <span class="subst">&#123;P.xy()[<span class="number">0</span>], P.xy()[<span class="number">1</span>]&#125;</span>'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 34251514713797768233812437040287772542697202020425182292607025836827373815449</span></span><br><span class="line"><span class="comment"># BASE_POINT.x = 7331</span></span><br><span class="line"><span class="comment"># P = (10680461779722115247262931380341483368049926186118123639977587326958923276962, 4003189979292111789806553325182843073711756529590890801151565205419771496727)</span></span><br></pre></td></tr></table></figure>

<h4 id="Thought-13"><a href="#Thought-13" class="headerlink" title="Thought"></a>Thought</h4><p>$n= 11522256336953175349 \cdot 14624100800238964261 \cdot 203269901862625480538481088870282608241$</p>
<p>“子曲线：”</p>
<p>$m \cdot G \equiv Y \pmod n \to m \cdot G \equiv Y \pmod p \ if \ (p \mid n)$</p>
<p>PS：CRT的时候有坑</p>
<h4 id="exp-15"><a href="#exp-15" class="headerlink" title="exp"></a>exp</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">n = 34251514713797768233812437040287772542697202020425182292607025836827373815449</span><br><span class="line">xx= 10680461779722115247262931380341483368049926186118123639977587326958923276962</span><br><span class="line">yy= 4003189979292111789806553325182843073711756529590890801151565205419771496727</span><br><span class="line">n = 34251514713797768233812437040287772542697202020425182292607025836827373815449</span><br><span class="line">A = 31337</span><br><span class="line">B = (yy^2 - xx^3 - A*xx) % n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = 11522256336953175349</span><br><span class="line">q = 14624100800238964261</span><br><span class="line">r = 203269901862625480538481088870282608241</span><br><span class="line">p1=p</span><br><span class="line">p2=q</span><br><span class="line">p3=r</span><br><span class="line">F = IntegerModRing(n)</span><br><span class="line">E = EllipticCurve(F, [A, B])</span><br><span class="line">T = E(xx,yy)</span><br><span class="line">assert p*q*r == n</span><br><span class="line"></span><br><span class="line">Fp = IntegerModRing(p)</span><br><span class="line">Ep = EllipticCurve(Fp, [A, B])</span><br><span class="line">Tp = Ep(xx,yy)</span><br><span class="line">R.&lt;y&gt; = Zmod(p)[]</span><br><span class="line">x = 7331</span><br><span class="line">f = y^2 -  x^3 - A*x - B</span><br><span class="line">yp0 = f.roots()[0][0]</span><br><span class="line">yp1 = f.roots()[1][0]</span><br><span class="line">Gp0 = Ep(x,yp0)</span><br><span class="line">Gp1 = Ep(x,yp1)</span><br><span class="line">mp1 = discrete_log(Tp,Gp0,operation='+')</span><br><span class="line">mp2 = discrete_log(Tp,Gp1,operation='+')</span><br><span class="line"></span><br><span class="line">Fq = IntegerModRing(q)</span><br><span class="line">Eq = EllipticCurve(Fq, [A, B])</span><br><span class="line">Tq = Eq(xx,yy)</span><br><span class="line">R.&lt;y&gt; = Zmod(q)[]</span><br><span class="line">x = 7331</span><br><span class="line">f = y^2 -  x^3 - A*x - B</span><br><span class="line">yq0 = f.roots()[0][0]</span><br><span class="line">yq1 = f.roots()[1][0]</span><br><span class="line">Gq0 = Eq(x,yq0)</span><br><span class="line">Gq1 = Eq(x,yq1)</span><br><span class="line">mq1 = discrete_log(Tq,Gq0,operation='+')</span><br><span class="line">mq2 = discrete_log(Tq,Gq1,operation='+')</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Fr = IntegerModRing(r)</span><br><span class="line">Er = EllipticCurve(Fr, [A, B])</span><br><span class="line">Tr = Er(xx,yy)</span><br><span class="line">R.&lt;y&gt; = Zmod(r)[]</span><br><span class="line">x = 7331</span><br><span class="line">f = y^2 -  x^3 - A*x - B</span><br><span class="line">yr0 = f.roots()[0][0]</span><br><span class="line">yr1 = f.roots()[1][0]</span><br><span class="line">Gr0 = Er(x,yr0)</span><br><span class="line">Gr1 = Er(x,yr1)</span><br><span class="line">mr1 = discrete_log(Tr,Gr0,operation='+')</span><br><span class="line">mr2 = discrete_log(Tr,Gr1,operation='+')</span><br><span class="line"></span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">EP = Ep.order()</span><br><span class="line">EQ = Eq.order()</span><br><span class="line">ER = Er.order()</span><br><span class="line">for mp in [mp1,mp2]:</span><br><span class="line">    for mq in [mq1,mq2]:</span><br><span class="line">        for mr in [mr1,mr2]:</span><br><span class="line">            m = crt([mp,mq,mr],[EP//GCD(mp,EP),EQ//GCD(mq,EQ),ER//GCD(mr,ER)])</span><br><span class="line">            if b<span class="string">"CCTF"</span> in long_to_bytes(m):</span><br><span class="line">                print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<h4 id="result-15"><a href="#result-15" class="headerlink" title="result"></a>result</h4><h3 id="Fiercest"><a href="#Fiercest" class="headerlink" title="Fiercest"></a>Fiercest</h3><p>分值：142</p>
<p>考点：</p>
<h4 id="challenge-16"><a href="#challenge-16" class="headerlink" title="challenge"></a>challenge</h4><p>Once again, we decided to deploy an <a href="https://cr.yp.toc.tf/tasks/fiercest_ca9c26c61b8d56b6157c76b535e1ff1b1bf31f50.txz" target="_blank" rel="noopener">artificial fault attack</a>!</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc <span class="number">04</span><span class="selector-class">.cr</span><span class="selector-class">.yp</span><span class="selector-class">.toc</span><span class="selector-class">.tf</span> <span class="number">37713</span></span><br></pre></td></tr></table></figure>

<h4 id="Thought-14"><a href="#Thought-14" class="headerlink" title="Thought"></a>Thought</h4><p>diff(n,nextprime(n)) &lt;= 2</p>
<p>$d \equiv e^{-1} \pmod {nextprime(n)-1}$</p>
<h4 id="exp-16"><a href="#exp-16" class="headerlink" title="exp"></a>exp</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">from sympy import *</span><br><span class="line">from Crypto.Util.<span class="keyword">number</span> import *</span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">def diff(<span class="keyword">a</span>, <span class="keyword">b</span>):</span><br><span class="line">	assert <span class="keyword">a</span>.bit_length() == <span class="keyword">b</span>.bit_length()</span><br><span class="line">	<span class="keyword">w</span>, <span class="keyword">l</span> = <span class="number">0</span>, <span class="keyword">a</span>.bit_length()</span><br><span class="line">	L = []</span><br><span class="line">	<span class="keyword">for</span> _ in <span class="built_in">range</span>(<span class="keyword">l</span>):</span><br><span class="line">		<span class="keyword">if</span> bin(<span class="keyword">a</span>)[<span class="number">2</span>:][_] != bin(<span class="keyword">b</span>)[<span class="number">2</span>:][_]: </span><br><span class="line">			<span class="keyword">w</span> += <span class="number">1</span></span><br><span class="line">			L.<span class="keyword">append</span>(_)</span><br><span class="line">	<span class="keyword">if</span> <span class="keyword">w</span>&lt;=<span class="number">2</span>:</span><br><span class="line">		<span class="keyword">print</span>(L)</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">w</span>,L</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">index</span> in <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">	<span class="keyword">print</span>(<span class="built_in">index</span>)</span><br><span class="line">	<span class="keyword">sh</span> = remote(<span class="string">"04.cr.yp.toc.tf"</span>,<span class="string">"37713"</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">sh</span>.recvuntil(<span class="string">"[Q]uit\n"</span>)</span><br><span class="line">	<span class="keyword">sh</span>.sendline(<span class="string">"G"</span>)</span><br><span class="line">	<span class="keyword">sh</span>.recvuntil(<span class="string">"n = "</span>)</span><br><span class="line">	n = <span class="keyword">int</span>(<span class="keyword">sh</span>.recvuntil(<span class="string">"\n"</span>)[:-<span class="number">1</span>])</span><br><span class="line">	<span class="keyword">w</span>,L = diff(n,nextprime(n))</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">w</span>)&lt;=<span class="number">2</span>:</span><br><span class="line">		<span class="keyword">sh</span>.recvuntil(<span class="string">"[Q]uit\n"</span>)</span><br><span class="line">		<span class="keyword">sh</span>.sendline(<span class="string">"A"</span>)</span><br><span class="line">		<span class="keyword">sh</span>.recvuntil(<span class="string">"\n"</span>)</span><br><span class="line">		<span class="keyword">sh</span>.sendline(str(L)[<span class="number">1</span>:-<span class="number">1</span>])</span><br><span class="line">		<span class="keyword">sh</span>.recvuntil(<span class="string">"[Q]uit\n"</span>)</span><br><span class="line">		<span class="keyword">sh</span>.sendline(<span class="string">"V"</span>)</span><br><span class="line">		<span class="keyword">sh</span>.recvuntil(<span class="string">"\n"</span>)</span><br><span class="line">		MSG = <span class="string">"4lL crypt0sy5t3ms suck5 fr0m faul7 atTaCk5 :P"</span></span><br><span class="line">		<span class="keyword">m</span> = bytes_to_long(MSG.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">		<span class="keyword">e</span> = <span class="number">65537</span></span><br><span class="line">		d = inverse(<span class="keyword">e</span>,nextprime(n)-<span class="number">1</span>)</span><br><span class="line">		<span class="keyword">sh</span>.sendline(str(<span class="built_in">pow</span>(<span class="keyword">m</span>,d,nextprime(n))))</span><br><span class="line">		<span class="keyword">sh</span>.interactive()</span><br></pre></td></tr></table></figure>

<h4 id="result-16"><a href="#result-16" class="headerlink" title="result"></a>result</h4><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">[+] Opening connection to <span class="number">04</span>.cr.yp.toc.tf on port <span class="number">37713</span>: Done</span><br><span class="line">[DEBUG] Received <span class="number">0</span>x49 bytes:</span><br><span class="line">    b'||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n'</span><br><span class="line">[DEBUG] Received <span class="number">0</span>x49 bytes:</span><br><span class="line">    b'| Hello guys! This is a challenge on fault attack for signatures, our  |\n'</span><br><span class="line">[DEBUG] Received <span class="number">0</span>xdb bytes:</span><br><span class="line">    b<span class="string">"| storage can apply at most `l' bit flip-flop on signature modulus, so |\n"</span></span><br><span class="line">    b<span class="string">"| try to locate the critical bits, we'll changed them to forge a sign! |\n"</span></span><br><span class="line">    b'||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n'</span><br><span class="line">[DEBUG] Received <span class="number">0</span>x58 bytes:</span><br><span class="line">    b'| Options: \n'</span><br><span class="line">    b'|\t[A]pply fault \n'</span><br><span class="line">    b'|\t[G]et the parameters \n'</span><br><span class="line">    b'|\t[V]erify the signature \n'</span><br><span class="line">    b'|\t[Q]uit\n'</span><br><span class="line">[DEBUG] Sent <span class="number">0</span>x2 bytes:</span><br><span class="line">    b'G\n'</span><br><span class="line">[DEBUG] Received <span class="number">0</span>xc bytes:</span><br><span class="line">    b'| e = <span class="number">6553</span>7\n'</span><br><span class="line">[DEBUG] Received <span class="number">0</span>x194 bytes:</span><br><span class="line">    b'| n = <span class="number">10498160271173</span><span class="number">79217410674368</span><span class="number">82873969170892</span><span class="number">55616977931637</span><span class="number">96411884953491</span><span class="number">80036957082719</span><span class="number">08479211257072</span><span class="number">09640594385148</span><span class="number">15141682418060</span><span class="number">86926524563280</span><span class="number">94443219651774</span><span class="number">66795633367170</span><span class="number">83713766760471</span><span class="number">48357751105862</span><span class="number">06182696907979</span><span class="number">40276314277389</span><span class="number">40521840073913</span><span class="number">08436971329481</span><span class="number">66258911218622</span><span class="number">25125792660560</span><span class="number">20589656927414</span><span class="number">36633433052789</span>1\n'</span><br><span class="line">    b'| Options: \n'</span><br><span class="line">    b'|\t[A]pply fault \n'</span><br><span class="line">    b'|\t[G]et the parameters \n'</span><br><span class="line">    b'|\t[V]erify the signature \n'</span><br><span class="line">    b'|\t[Q]uit\n'</span><br><span class="line">[<span class="number">1014</span>, <span class="number">1022</span>]</span><br><span class="line">[DEBUG] Sent <span class="number">0</span>x2 bytes:</span><br><span class="line">    b'A\n'</span><br><span class="line">[DEBUG] Received <span class="number">0</span>x53 bytes:</span><br><span class="line">    b'| please send at most 2-tuple array from indices of bits of modulus, like: 14, 313\n'</span><br><span class="line">[DEBUG] Sent <span class="number">0</span>xb bytes:</span><br><span class="line">    b'<span class="number">1014</span>, <span class="number">1022</span>\n'</span><br><span class="line">[DEBUG] Received <span class="number">0</span>x58 bytes:</span><br><span class="line">    b'| Options: \n'</span><br><span class="line">    b'|\t[A]pply fault \n'</span><br><span class="line">    b'|\t[G]et the parameters \n'</span><br><span class="line">    b'|\t[V]erify the signature \n'</span><br><span class="line">    b'|\t[Q]uit\n'</span><br><span class="line">[DEBUG] Sent <span class="number">0</span>x2 bytes:</span><br><span class="line">    b'V\n'</span><br><span class="line">[DEBUG] Received <span class="number">0</span>x24 bytes:</span><br><span class="line">    b'| please send signature to verify: \n'</span><br><span class="line">[DEBUG] Sent <span class="number">0</span>x135 bytes:</span><br><span class="line">    b'<span class="number">20730183509466</span><span class="number">32876796526343</span><span class="number">45297126285465</span><span class="number">42794159093618</span><span class="number">98615090032257</span><span class="number">56452280007560</span><span class="number">62913760197921</span><span class="number">04170930060929</span><span class="number">95203257801007</span><span class="number">86061431435079</span><span class="number">17078070433984</span><span class="number">11995808388873</span><span class="number">76530568075047</span><span class="number">89669605804069</span><span class="number">56427693563276</span><span class="number">91028864410997</span><span class="number">24143407970071</span><span class="number">35030470761467</span><span class="number">62466890495643</span><span class="number">81667943060162</span><span class="number">10975550662381</span><span class="number">45997558031723</span>\n'</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">[DEBUG] Received <span class="number">0</span>x4b bytes:</span><br><span class="line">    b'| Congrats! your got the flag: CCTF&#123;R3aLlY_tH1S_1z_Seiferts_R54_AT7aCk!!?&#125;\n'</span><br><span class="line"><span class="string">| Congrats! your got the flag: CCTF&#123;R3aLlY_tH1S_1z_Seiferts_R54_AT7aCk!!?&#125;</span></span><br><span class="line">[*] Got EOF while reading in interactive</span><br></pre></td></tr></table></figure>

<h3 id="Mino"><a href="#Mino" class="headerlink" title="Mino *"></a>Mino *</h3><p>分值：169</p>
<p>考点：-2进制？</p>
<h4 id="challenge-17"><a href="#challenge-17" class="headerlink" title="challenge"></a>challenge</h4><p>You cannot have a good cryptosystem without mathematics! This <a href="https://cr.yp.toc.tf/tasks/mino_3630edd92969b3006844c7ba6b5c56839ab99f24.txz" target="_blank" rel="noopener">task</a> is an easy coding system!</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc <span class="number">02</span><span class="selector-class">.cr</span><span class="selector-class">.yp</span><span class="selector-class">.toc</span><span class="selector-class">.tf</span> <span class="number">13771</span></span><br></pre></td></tr></table></figure>

<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">from flag import flag</span><br><span class="line"></span><br><span class="line">def die(*<span class="built_in">args</span>):</span><br><span class="line">	pr(*<span class="built_in">args</span>)</span><br><span class="line">	<span class="built_in">quit</span>()</span><br><span class="line"></span><br><span class="line">def pr(*<span class="built_in">args</span>):</span><br><span class="line">	s = <span class="string">" "</span>.<span class="built_in">join</span>(<span class="built_in">map</span>(str, <span class="built_in">args</span>))</span><br><span class="line">	sys.stdout.write(s + <span class="string">"\n"</span>)</span><br><span class="line">	sys.stdout.<span class="built_in">flush</span>()</span><br><span class="line"></span><br><span class="line">def sc():</span><br><span class="line">	<span class="built_in">return</span> sys.stdin.<span class="built_in">readline</span>().strip()</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">	<span class="built_in">border</span> = <span class="string">"|"</span></span><br><span class="line">	pr(<span class="built_in">border</span>*<span class="number">72</span>)</span><br><span class="line">	pr(<span class="built_in">border</span>, <span class="string">"Hi crypto programmers! I'm looking for some very special permutation"</span>, <span class="built_in">border</span>)</span><br><span class="line">	pr(<span class="built_in">border</span>, <span class="string">"p name MINO such that sum(p(i) * (-2)^i) = 0 from 0 to n - 1, for   "</span>, <span class="built_in">border</span>)</span><br><span class="line">	pr(<span class="built_in">border</span>, <span class="string">"example for n = 6, the permutation p = (4, 2, 6, 5, 3, 1) is MINO:  "</span>, <span class="built_in">border</span>)</span><br><span class="line">	pr(<span class="built_in">border</span>, <span class="string">"4*(-2)^0 + 2*(-2)^1 + 6*(-2)^2 + 5*(-2)^3 + 3*(-2)^4 + 1*(-2)^5 = 0 "</span>, <span class="built_in">border</span>)</span><br><span class="line">	pr(<span class="built_in">border</span>, <span class="string">"In each step find such permutation and send to server, if there is  "</span>, <span class="built_in">border</span>)</span><br><span class="line">	pr(<span class="built_in">border</span>, <span class="string">"NOT such permutation for given n, just send `TINP', good luck :)    "</span>, <span class="built_in">border</span>)</span><br><span class="line">	pr(<span class="built_in">border</span>*<span class="number">72</span>)</span><br><span class="line">	<span class="keyword">step</span>, final = <span class="number">3</span>, <span class="number">40</span></span><br><span class="line">	<span class="keyword">while</span> True:</span><br><span class="line">		pr(<span class="built_in">border</span>, f<span class="string">"Send a MINO permutation of length = &#123;step&#125; separated by comma: "</span>)</span><br><span class="line">		p = sc().<span class="built_in">split</span>(',')</span><br><span class="line">		<span class="keyword">if</span> <span class="keyword">step</span> <span class="symbol">%</span> <span class="number">3</span> == <span class="number">1</span>:</span><br><span class="line">			<span class="keyword">if</span> p == ['TINP']:</span><br><span class="line">				<span class="keyword">if</span> <span class="keyword">step</span> == final: die(<span class="built_in">border</span>, f<span class="string">"Congrats, you got the flag: &#123;flag&#125;"</span>)</span><br><span class="line">				<span class="keyword">else</span>:</span><br><span class="line">					pr(<span class="built_in">border</span>, <span class="string">"Great, try the next level :)"</span>)</span><br><span class="line">					<span class="keyword">step</span> += <span class="number">1</span></span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				die(<span class="built_in">border</span>, <span class="string">"the answer is not correct, bye!!!"</span>)</span><br><span class="line">		elif len(p) == <span class="keyword">step</span>:</span><br><span class="line">			try:</span><br><span class="line">				p = [int(<span class="symbol">_</span>) <span class="keyword">for</span> <span class="symbol">_</span> <span class="keyword">in</span> p]</span><br><span class="line">			except:</span><br><span class="line">				pr(<span class="built_in">border</span>, <span class="string">"the permutation is not valid"</span>)</span><br><span class="line">			<span class="keyword">if</span> set(p) == set([<span class="symbol">_</span> <span class="keyword">for</span> <span class="symbol">_</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="keyword">step</span> + <span class="number">1</span>)]):</span><br><span class="line">				S = <span class="number">0</span></span><br><span class="line">				<span class="keyword">for</span> <span class="symbol">_</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="keyword">step</span>):</span><br><span class="line">					S += p[<span class="symbol">_</span>] * (-<span class="number">2</span>) ** <span class="symbol">_</span></span><br><span class="line">				<span class="keyword">if</span> S == <span class="number">0</span>:</span><br><span class="line">					<span class="keyword">if</span> <span class="keyword">step</span> == final: </span><br><span class="line">						die(<span class="built_in">border</span>, f<span class="string">"Congrats, you got the flag: &#123;flag&#125;"</span>)</span><br><span class="line">					<span class="keyword">else</span>:</span><br><span class="line">						pr(<span class="built_in">border</span>, <span class="string">"Great, try the next level :)"</span>)</span><br><span class="line">						<span class="keyword">step</span> += <span class="number">1</span></span><br><span class="line">				<span class="keyword">else</span>:</span><br><span class="line">					die(<span class="built_in">border</span>, <span class="string">"the answer is not correct, bye!!!"</span>)</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				pr(<span class="built_in">border</span>, <span class="string">"the permutation is not valid!!!"</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			die(<span class="built_in">border</span>, f<span class="string">"the length of permutation is not equal to &#123;step&#125;"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>

<h4 id="Thought-15"><a href="#Thought-15" class="headerlink" title="Thought"></a>Thought</h4><p>不太会哦，用z3大力好像可以，数学的分析好像也有，等我看看</p>
<h4 id="exp-17"><a href="#exp-17" class="headerlink" title="exp"></a>exp</h4><p><a href="https://zhuanlan.zhihu.com/p/543272688" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/543272688</a></p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">import z3</span><br><span class="line"><span class="built_in">from</span> pwn import remote</span><br><span class="line"></span><br><span class="line">io = remote(<span class="string">'02.cr.yp.toc.tf'</span>, <span class="number">13771</span>)</span><br><span class="line"></span><br><span class="line">def rua(n):</span><br><span class="line">	<span class="comment"># 42bit的n个变量</span></span><br><span class="line">    Q = [z3.BitVec(<span class="string">"Q_&#123;&#125;"</span>.<span class="built_in">format</span>(i), <span class="number">42</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]</span><br><span class="line">    <span class="comment"># n个变量都大于等于1，小于等于n</span></span><br><span class="line">    val_c = [z3.And(<span class="number">1</span> &lt;= Q[i], Q[i] &lt;= n) <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]</span><br><span class="line">    <span class="comment"># n个变量都不同</span></span><br><span class="line">    col_c = [z3.Distinct(Q)]</span><br><span class="line">    <span class="comment"># n个变量满足的关系</span></span><br><span class="line">    con_c = [<span class="built_in">sum</span>(Q[i] * ((<span class="number">-2</span>)**i) <span class="keyword">for</span> i <span class="keyword">in</span> range(n)) == <span class="number">0</span>]</span><br><span class="line">    solver = z3.Solver()</span><br><span class="line">    solver.<span class="built_in">add</span>(val_c + col_c + con_c)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">result</span> = <span class="string">''</span></span><br><span class="line">    <span class="keyword">if</span> n % <span class="number">3</span> == <span class="number">1</span>:</span><br><span class="line">        <span class="literal">return</span> b<span class="string">'TINP'</span></span><br><span class="line">    elif solver.check() == z3.sat:</span><br><span class="line">        m = solver.model()</span><br><span class="line">        print(<span class="string">"&#123;&#125;:"</span>.<span class="built_in">format</span>(n), <span class="keyword">end</span>=<span class="string">' '</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> Q:</span><br><span class="line">            <span class="built_in">result</span> += str(m[i])</span><br><span class="line">            <span class="built_in">result</span> += <span class="string">','</span></span><br><span class="line">        <span class="literal">return</span> <span class="built_in">result</span>.encode()[:<span class="number">-1</span>]    <span class="comment"># 去掉最后一个逗号</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="literal">return</span> b<span class="string">'???'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">3</span>, <span class="number">40</span>+<span class="number">1</span>):</span><br><span class="line">    print(io.recvuntil(b<span class="string">'separated by comma:'</span>))</span><br><span class="line">    <span class="built_in">result</span> = rua(n)</span><br><span class="line">    print()</span><br><span class="line">    print(<span class="built_in">result</span>)</span><br><span class="line">    print()</span><br><span class="line">    io.sendline(<span class="built_in">result</span>)</span><br><span class="line">    </span><br><span class="line">io.interactive()</span><br><span class="line"><span class="comment"># | Congrats, you got the flag: CCTF&#123;MINO_iZ_4N_3a5Y_Crypto_C0d!n9_T4sK!&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="result-17"><a href="#result-17" class="headerlink" title="result"></a>result</h4><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">| Congrats, you got the flag: CCTF&#123;MINO_iZ_4N_3a5Y_Crypto_C0d!n9_T4sK!&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Starter-ECC"><a href="#Starter-ECC" class="headerlink" title="Starter ECC"></a>Starter ECC</h3><p>分值：103</p>
<p>考点：模 n 开根</p>
<h4 id="challenge-18"><a href="#challenge-18" class="headerlink" title="challenge"></a>challenge</h4><p>Dive deep to the elliptic <a href="https://cr.yp.toc.tf/tasks/starter_ecc_e4bc2d2c03e09e1534078c61d9170c307e3333ee.txz" target="_blank" rel="noopener">cryptosystem</a>!</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> n, a, b, x, flag</span><br><span class="line"></span><br><span class="line">y = bytes_to_long(flag.encode(<span class="string">'utf-8'</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> y &lt; n</span><br><span class="line">E = EllipticCurve(Zmod(n), [a, b])</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">	G = E(x, y)</span><br><span class="line">	print(<span class="string">f'x = <span class="subst">&#123;x&#125;</span>'</span>)</span><br><span class="line">	print(<span class="string">f'a = <span class="subst">&#123;a&#125;</span>'</span>)</span><br><span class="line">	print(<span class="string">f'b = <span class="subst">&#123;b&#125;</span>'</span>)</span><br><span class="line">	print(<span class="string">f'n = <span class="subst">&#123;n&#125;</span>'</span>)</span><br><span class="line">	print(<span class="string">'Find the flag :P'</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">	print(<span class="string">'Ooops, ERROR :-('</span>)</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">x = <span class="number">10715086071862673209484250490600018105614048117055336074437503883703510511249361224931983788156958581275946729175531468251871452856923140435984577574698574803934567774824230985421074605062371141877954182153046477020617917601884853827611232355455223966039590143622792803800879186033924150173912925208583</span></span><br><span class="line">a = <span class="number">31337</span></span><br><span class="line">b = <span class="number">66826418568487077181425396984743905464189470072466833884636947306507380342362386488703702812673327367379386970252278963682939080502468506452884260534949120967338532068983307061363686987539408216644249718950365322078643067666802845720939111758309026343239779555536517718292754561631504560989926785152983649035</span></span><br><span class="line">n = <span class="number">117224988229627436482659673624324558461989737163733991529810987781450160688540001366778824245275287757373389887319739241684244545745583212512813949172078079042775825145312900017512660931667853567060810331541927568102860039898116182248597291899498790518105909390331098630690977858767670061026931938152924839936</span></span><br><span class="line">Find the flag :P</span><br></pre></td></tr></table></figure>

<h4 id="Thought-16"><a href="#Thought-16" class="headerlink" title="Thought"></a>Thought</h4><p>$y^2 \equiv x^3 + ax+b \pmod p$</p>
<p>这个 $n$ 不是素数，尝试分解</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sage: <span class="attribute">n</span>=117224988229627436482659673624324558461989737163733991529810987781450160</span><br><span class="line"><span class="built_in">..</span><span class="built_in">..</span>: 68854000136677882424527528775737338988731973924168424454574558321251281394</span><br><span class="line"><span class="built_in">..</span><span class="built_in">..</span>: 91720780790427758251453129000175126609316678535670608103315419275681028600</span><br><span class="line"><span class="built_in">..</span><span class="built_in">..</span>: 39898116182248597291899498790518105909390331098630690977858767670061026931</span><br><span class="line"><span class="built_in">..</span><span class="built_in">..</span>: 938152924839936</span><br><span class="line">sage: <span class="builtin-name">print</span>(ecm.factor(n))</span><br><span class="line">[2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 690712633549859897233, 690712633549859897233, 690712633549859897233, 690712633549859897233, 690712633549859897233, 690712633549859897233, 651132262883189171676209466993073, 651132262883189171676209466993073, 651132262883189171676209466993073, 651132262883189171676209466993073, 651132262883189171676209466993073]</span><br></pre></td></tr></table></figure>

<h4 id="exp-18"><a href="#exp-18" class="headerlink" title="exp"></a>exp</h4><p><a href="https://zhuanlan.zhihu.com/p/543272688" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/543272688</a></p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">q1 = <span class="number">2</span>^<span class="number">63</span></span><br><span class="line">q2 = <span class="number">690712633549859897233</span> ^ <span class="number">6</span></span><br><span class="line">q3 = <span class="number">651132262883189171676209466993073</span> ^ <span class="number">5</span></span><br><span class="line">G1s = <span class="keyword">Mod</span>(x ** <span class="number">3</span> + a * x + b, q1).nth_root(<span class="number">2</span>, <span class="keyword">all</span>=<span class="literal">True</span>)</span><br><span class="line">G2s = <span class="keyword">Mod</span>(x ** <span class="number">3</span> + a * x + b, q2).nth_root(<span class="number">2</span>, <span class="keyword">all</span>=<span class="literal">True</span>)</span><br><span class="line">G3s = <span class="keyword">Mod</span>(x ** <span class="number">3</span> + a * x + b, q3).nth_root(<span class="number">2</span>, <span class="keyword">all</span>=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> G1 <span class="keyword">in</span> G1s:</span><br><span class="line">    <span class="keyword">for</span> G2 <span class="keyword">in</span> G2s:</span><br><span class="line">        <span class="keyword">for</span> G3 <span class="keyword">in</span> G3s:</span><br><span class="line">            m = long_to_bytes(int(crt([ZZ(G1), ZZ(G2), ZZ(G3)], [q1, q2, q3])))</span><br><span class="line">                <span class="keyword">if</span> b<span class="symbol">'CCTF</span>&#123;' <span class="keyword">in</span> m:</span><br><span class="line">                    print(m)</span><br><span class="line">                    break</span><br></pre></td></tr></table></figure>

<h4 id="result-18"><a href="#result-18" class="headerlink" title="result"></a>result</h4><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b' CCTF&#123;<span class="number">8E4</span>uTy_0f_L1f7iN9_cOm3_Up!!&#125;  CCTF&#123;<span class="number">8E4</span>uTy_0f_L1f7iN9_cOm3_Up!!&#125;  CCTF&#123;<span class="number">8E4</span>uTy_0f_L1f7iN9_cOm3_Up!!&#125; _______________________<span class="string">'</span></span><br></pre></td></tr></table></figure>

<h2 id="medium-hard"><a href="#medium-hard" class="headerlink" title="medium-hard"></a>medium-hard</h2><h3 id="Watery-soup"><a href="#Watery-soup" class="headerlink" title="Watery soup"></a>Watery soup</h3><p>分值：226</p>
<p>考点：构造</p>
<h4 id="challenge-19"><a href="#challenge-19" class="headerlink" title="challenge"></a>challenge</h4><p>Watery soup</p>
<p>Find a message in a <a href="https://cr.yp.toc.tf/tasks/watery_soup_74adab5bd0fc0deae1a98a6e0fd8bcfc4ae59025.txz" target="_blank" rel="noopener">mess</a>!</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc <span class="number">05</span><span class="selector-class">.cr</span><span class="selector-class">.yp</span><span class="selector-class">.toc</span><span class="selector-class">.tf</span> <span class="number">37377</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="comment">#from flag import flag</span></span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(<span class="string">b"a"</span>*<span class="number">33</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="number">256</span> &lt; flag.bit_length() &lt; <span class="number">512</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">die</span><span class="params">(*args)</span>:</span></span><br><span class="line">	pr(*args)</span><br><span class="line">	quit()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pr</span><span class="params">(*args)</span>:</span></span><br><span class="line">	s = <span class="string">" "</span>.join(map(str, args))</span><br><span class="line">	sys.stdout.write(s + <span class="string">"\n"</span>)</span><br><span class="line">	sys.stdout.flush()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sc</span><span class="params">()</span>:</span> <span class="keyword">return</span> sys.stdin.readline().strip()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">	border = <span class="string">"|"</span></span><br><span class="line">	pr(border*<span class="number">72</span>)</span><br><span class="line">	pr(border, <span class="string">"Hi crypto-experts, send us your prime and we will mix the flag with "</span>, border)</span><br><span class="line">	pr(border, <span class="string">"it! Now can you find the flag in the mixed watery soup!? Good luck! "</span>, border)</span><br><span class="line">	pr(border*<span class="number">72</span>)</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		pr(<span class="string">"| Options: \n|\t[S]end the prime! \n|\t[Q]uit"</span>)</span><br><span class="line">		ans = sc().lower()</span><br><span class="line">		<span class="keyword">if</span> ans == <span class="string">'s'</span>:</span><br><span class="line">			pr(border, <span class="string">"Send your prime here: "</span>)</span><br><span class="line">			p = sc()</span><br><span class="line">			<span class="keyword">try</span>: p = int(p)</span><br><span class="line">			<span class="keyword">except</span>: die(border, <span class="string">"Your input is not valid!!"</span>)</span><br><span class="line">			<span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">128</span> &lt;= p.bit_length() &lt;= <span class="number">224</span>): die(border, <span class="string">"Your prime is out of bounds :("</span>)</span><br><span class="line">			<span class="keyword">if</span> <span class="keyword">not</span> isPrime(p): die(border, <span class="string">"Your input is NOT prime! Kidding me!?"</span>)</span><br><span class="line">			pr(border, <span class="string">"Send the base here: "</span>)</span><br><span class="line">			g = sc()</span><br><span class="line">			<span class="keyword">try</span>: g = int(g) % p</span><br><span class="line">			<span class="keyword">except</span>: die(<span class="string">"| Your base is not valid!!"</span>)</span><br><span class="line">			<span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">64</span> &lt; g.bit_length() &lt; <span class="number">128</span>): die(border, <span class="string">"Your base is too small!!"</span>)</span><br><span class="line">			result = (pow(g ** <span class="number">3</span> * flag, flag - g, p) * flag + flag * flag + g) % p</span><br><span class="line">			pr(border, <span class="string">f"WooW, here is the mixed flag: <span class="subst">&#123;result&#125;</span>"</span>)</span><br><span class="line">		<span class="keyword">elif</span> ans == <span class="string">'q'</span>: die(border, <span class="string">"Quitting ..."</span>)</span><br><span class="line">		<span class="keyword">else</span>: die(border, <span class="string">"Bye ..."</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>: main()</span><br></pre></td></tr></table></figure>

<h4 id="Thought-17"><a href="#Thought-17" class="headerlink" title="Thought"></a>Thought</h4><p>$O(g) = (g^3 \cdot f) ^ {f-g} \cdot f + f^2 + g \pmod p$</p>
<p>如果直接解方程得话，因为 $f-g$ 不知道。所以想着能不能联立方程把这 $f$ 消掉。然后想着能不能找到两个 $g$，满足 $g_i^3 \equiv 1 \pmod p$ ，然后就有<br>$$<br>(O(g_1)-f^2-g_1)/(O(g_2)-f^2-g_2) \equiv (f^{f-g_1}f) / (f^{f-g_2}f) \equiv f^{g_2-g_1}   \pmod p \<br>(O(g_1)-f^2-g_1) \equiv f^{g_2-g_1} \cdot (O(g_2)-f^2-g_2) \pmod p \<br>(O(g_1)-f^2-g_1) - f^{g_2-g_1} \cdot (O(g_2)-f^2-g_2)  \equiv 0 \pmod p<br>$$<br>但是这个degree $(g_2-g_1)$ 太大了，如果控制 $g_2-g_1$ 的值<br>$$<br>(O(g_1)-f^2-g_1)/(O(g_2)-f^2-g_2) \equiv (g_1^{3f-3g_1}f^{f-g_1}f) / (g_2^{3f-3g_2}f^{f-g_2}f) \equiv (\frac{g_2^{3f-3g_2}}{g_1^{3f-3g_1}})f^{g_2-g_1}   \pmod p \<br>$$<br>右式前面那一大块还是有 $f$，</p>
<p>除法不行再来看看乘法，因为有负幂次</p>
<p>如果 $(O(g_1)-f^2-g_1) \cdot (O(g_2) -f^2-g_2) \equiv (g_1^3 \cdot f)^{f-g_1} \cdot f \cdot (g_2^3 \cdot f)^{f-g_2} \cdot f  \equiv (g_1g_2)^{3f}/g_1^{3g_1}g_2^{3g_2} \cdot f^{f+1} \cdot f^{f+1} / f^{g_1+g_2} $</p>
<p>这里能不能控制 $g_1g_2=\pm 1,g_1+g_2 = 0$，但是要求 $64\lt g.nbits() \lt 128$，而且还有一个 $f^{2f+2}$ 呢。</p>
<p>如果要处理掉那个 $f^{2f+2}$ ，我们可以给两个交互的值做一个幂次，即原式改为<br>$$<br>(O(g_1)-f^2-g_1)^X \cdot (O(g_2) -f^2-g_2)^Y \equiv (g_1^Xg_2^Y)^{3f}/g_1^{3g_1X}g_2^{3g_2Y} \cdot f^{X(f+1)+Y(f+1)} / f^{g_1X+g_2Y}<br>$$<br>那就考虑 $g_1^Xg_2^Y=1,g_1X+g_2Y=0,X+Y=0$</p>
<p>显然这里要求$X=-Y$，那就需要 $g_1=g_2=1$ 了，不太行</p>
<p>那我们就再加一条变量<br>$$<br>g_1^Xg_2^Yg_3^Z=1,g_1X+g_2Y+g_3Z=0,X+Y+Z=0<br>$$</p>
<p>姑且设 $X=Y=1,Z=-2$</p>
<p>就有 $g_1g_2 \equiv g_3^2,g_1+g_2\equiv2g_3$</p>
<p>似乎只有 $g_1=g_2=g_3$ 才能满足这些条件，但这显然不符合题目要求。</p>
<p>我们再设 $X=1,Y=2,Z=-3$</p>
<p>就有 $g_1g_2^2\equiv g_3^3,g_1+2g_2\equiv 3g_3$</p>
<p>我们有 $g_1 =-8g_2 ,g_3 = -2g_2$</p>
<p>然后我们就有<br>$$<br>(O(g_1)-f^2-g_1)^1 \cdot (O(g_2) -f^2-g_2)^2\cdot(O(g_3) -f^2-g_3)^{-3}   \equiv (g_1^Xg_2^Yg_3^Z)^{3f}/g_1^{3Xg_1}g_2^{3Yg_2}g_3^{-3Zg_3} \cdot f^{(f+1)(1+2-3)} / f^{g_1X+g_2Y+g3Z} \ \equiv 1/g_1^{3g_1}g_2^{6g_2}g_3^{-9g_3} / f^{g_1X+g_2Y+g3Z}<br>$$<br>注意到这里是 $g_1X+g_2Y+g_3Z \equiv 0 \pmod p$，实际上 $3p-8g_2 + 2g_2+ -6g_2+-3p = 0$ 所以上式右手边为<br>$$<br>1/g_1^{3g_1}g_2^{6g_2}g_3^{-9g_3}<br>$$<br>所以<br>$$<br>(O(g_1)-f^2-g_1)^1 \cdot (O(g_2) -f^2-g_2)^2  \cdot g_1^{3g_1}g_2^{6g_2}g_3^{-9g_3} =(O(g_3) -f^2-g_3)^{3}<br>$$<br>PS：这里用的前面的脚本找的 $p-1$ 光滑的 $p$，也不知道有没有必要就是说（因为前面有求离散对数的想法…..）</p>
<h4 id="exp-19"><a href="#exp-19" class="headerlink" title="exp"></a>exp</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env <span class="keyword">python3</span></span><br><span class="line"></span><br><span class="line">from Crypto.Util.<span class="keyword">number</span> import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def gen_primes(nbit, imbalance):</span><br><span class="line">	<span class="keyword">p</span> = <span class="number">2</span></span><br><span class="line">	FACTORS = [<span class="keyword">p</span>]</span><br><span class="line">	<span class="keyword">while</span> <span class="keyword">p</span>.bit_length() &lt; nbit - <span class="number">2</span> * imbalance:</span><br><span class="line">		factor = getPrime(imbalance)</span><br><span class="line">		FACTORS.<span class="keyword">append</span>(factor)</span><br><span class="line">		<span class="keyword">p</span> *= factor</span><br><span class="line">	rbit = (nbit - <span class="keyword">p</span>.bit_length()) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> True:</span><br><span class="line">		r, s = [getPrime(rbit) <span class="keyword">for</span> _ in <span class="string">'01'</span>]</span><br><span class="line">		_p = <span class="keyword">p</span> * r * s</span><br><span class="line">		<span class="keyword">if</span> _p.bit_length() &lt; nbi<span class="variable">t:</span> rbit += <span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> _p.bit_length() &gt; nbi<span class="variable">t:</span> rbit -= <span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> isPrime(_p + <span class="number">1</span>):</span><br><span class="line">			FACTORS.<span class="built_in">extend</span>((r, s))</span><br><span class="line">			<span class="keyword">p</span> = _p + <span class="number">1</span></span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">	FACTORS.<span class="keyword">sort</span>()</span><br><span class="line">	<span class="keyword">return</span> (<span class="keyword">p</span>, FACTORS)</span><br><span class="line"></span><br><span class="line">def genkey(nbit, imbalance, <span class="keyword">e</span>):</span><br><span class="line">	<span class="keyword">while</span> True:</span><br><span class="line">		<span class="keyword">p</span>, FACTORS = gen_primes(nbit // <span class="number">2</span>, imbalance)</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">len</span>(FACTORS) != <span class="built_in">len</span>(<span class="keyword">set</span>(FACTORS)):</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		q, q_factors = gen_primes(nbit // <span class="number">2</span>, imbalance + <span class="number">1</span>)</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">len</span>(q_factors) != <span class="built_in">len</span>(<span class="keyword">set</span>(q_factors)):</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		factors = FACTORS + q_factors</span><br><span class="line">		<span class="keyword">if</span> <span class="keyword">e</span> not in factor<span class="variable">s:</span></span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">print</span>(<span class="keyword">p</span>.bit_length(),q.bit_length())</span><br><span class="line">	n = <span class="keyword">p</span> * q</span><br><span class="line">	<span class="keyword">return</span> n, (<span class="keyword">p</span>, q)</span><br><span class="line"></span><br><span class="line">nbit = <span class="number">256</span></span><br><span class="line">imbalance = <span class="number">16</span></span><br><span class="line"><span class="keyword">e</span> = <span class="number">0</span>x10001</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n, PRIMES = genkey(nbit, imbalance, <span class="keyword">e</span>)</span><br><span class="line"><span class="keyword">print</span>(PRIMES)</span><br><span class="line"></span><br><span class="line"><span class="keyword">p</span> = <span class="number">241073702737973665011723294586981868543</span></span><br><span class="line"><span class="keyword">p</span> = <span class="number">281001512981116565134944031254704290547</span></span><br><span class="line"><span class="keyword">p</span> = <span class="number">243080850308481335113421227369194998483</span></span><br><span class="line"><span class="keyword">p</span> = <span class="number">269995126298881109995199221021359578159</span></span><br><span class="line">g2 = <span class="number">2</span>**<span class="number">126</span></span><br><span class="line">g1 =  (-<span class="number">8</span> * g2)%<span class="keyword">p</span></span><br><span class="line">g3 = (-<span class="number">2</span> * g2)%<span class="keyword">p</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>(<span class="keyword">p</span>.bit_length(),g1.bit_length(),g2.bit_length(),g3.bit_length())</span><br><span class="line"></span><br><span class="line"># sage</span><br><span class="line">from pwn import *</span><br><span class="line">context.log_level=<span class="string">'debug'</span></span><br><span class="line"><span class="keyword">sh</span> = remote(<span class="string">"05.cr.yp.toc.tf"</span>,<span class="number">37377</span>)</span><br><span class="line">def oracle(g,<span class="keyword">p</span>):</span><br><span class="line">	<span class="keyword">sh</span>.recvuntil(<span class="string">"[Q]uit\n"</span>)</span><br><span class="line">	<span class="keyword">sh</span>.sendline(<span class="string">"S"</span>)</span><br><span class="line">	<span class="keyword">sh</span>.recvuntil(<span class="string">"here: \n"</span>)</span><br><span class="line">	<span class="keyword">sh</span>.sendline(str(<span class="keyword">p</span>))</span><br><span class="line">	<span class="keyword">sh</span>.recvuntil(<span class="string">"here: \n"</span>)</span><br><span class="line">	<span class="keyword">sh</span>.sendline(str(g))</span><br><span class="line">	<span class="keyword">sh</span>.recvuntil(<span class="string">"flag: "</span>)</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">int</span>(<span class="keyword">sh</span>.recvuntil(<span class="string">"\n"</span>)[:-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">ps</span> = [<span class="number">241073702737973665011723294586981868543</span>,</span><br><span class="line"><span class="number">281001512981116565134944031254704290547</span>,</span><br><span class="line"><span class="number">243080850308481335113421227369194998483</span>,</span><br><span class="line"><span class="number">269995126298881109995199221021359578159</span>]</span><br><span class="line">mp=[]</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">p</span> in <span class="keyword">p</span><span class="variable">s:</span></span><br><span class="line">	g2 = <span class="number">2</span>**<span class="number">126</span></span><br><span class="line">	c2=oracle(g2,<span class="keyword">p</span>)</span><br><span class="line">	g1 =  (-<span class="number">8</span> * g2)%<span class="keyword">p</span></span><br><span class="line">	c1=oracle(g1,<span class="keyword">p</span>)</span><br><span class="line">	g3 = (-<span class="number">2</span> * g2)%<span class="keyword">p</span></span><br><span class="line">	c3=oracle(g3,<span class="keyword">p</span>)</span><br><span class="line"></span><br><span class="line">	#print(<span class="keyword">p</span>.bit_length(),g1.bit_length(),g2.bit_length(),g3.bit_length())</span><br><span class="line">	R.<span class="symbol">&lt;x&gt;</span> = Zmod(<span class="keyword">p</span>)[]</span><br><span class="line">	z1 = <span class="built_in">pow</span>(g1,<span class="number">3</span>*g1,<span class="keyword">p</span>)</span><br><span class="line">	z2 = <span class="built_in">pow</span>(g2,<span class="number">6</span>*g2,<span class="keyword">p</span>)</span><br><span class="line">	z3 = <span class="built_in">pow</span>(g3,-<span class="number">9</span>*g3,<span class="keyword">p</span>)</span><br><span class="line">	<span class="keyword">f</span> = (c1-<span class="keyword">x</span>^<span class="number">2</span>-g1)*((c2-<span class="keyword">x</span>^<span class="number">2</span>-g2)^<span class="number">2</span>)*z1*z2*z3 - (c3-<span class="keyword">x</span>^<span class="number">2</span>-g3)^<span class="number">3</span></span><br><span class="line">	mp.<span class="keyword">append</span>([<span class="keyword">f</span>.roots()[i][<span class="number">0</span>] <span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">2</span>)])</span><br><span class="line"></span><br><span class="line">from Crypto.Util.<span class="keyword">number</span> import *</span><br><span class="line"><span class="keyword">for</span> i in mp[<span class="number">0</span>]:</span><br><span class="line">	<span class="keyword">for</span> <span class="keyword">j</span> in mp[<span class="number">1</span>]:</span><br><span class="line">		<span class="keyword">for</span> <span class="keyword">k</span> in mp[<span class="number">2</span>]:</span><br><span class="line">			<span class="keyword">for</span> <span class="keyword">l</span> in mp[<span class="number">3</span>]:</span><br><span class="line">				<span class="keyword">m</span> = crt([<span class="keyword">int</span>(i),<span class="keyword">int</span>(<span class="keyword">j</span>),<span class="keyword">int</span>(<span class="keyword">k</span>),<span class="keyword">int</span>(<span class="keyword">l</span>)],<span class="keyword">ps</span>)</span><br><span class="line">				<span class="keyword">if</span> <span class="keyword">b</span><span class="string">"CCTF"</span> in long_to_bytes(<span class="keyword">m</span>):</span><br><span class="line">					<span class="keyword">print</span>(long_to_bytes(<span class="keyword">m</span>))</span><br></pre></td></tr></table></figure>

<h4 id="result-19"><a href="#result-19" class="headerlink" title="result"></a>result</h4><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b'CCTF&#123;Pl34se_S!r_i_w4N7_5omE_M0R3_5OuP!!&#125;<span class="string">'</span></span><br></pre></td></tr></table></figure>

<h3 id="313-Loyal"><a href="#313-Loyal" class="headerlink" title="313 Loyal"></a>313 Loyal</h3><p>分值：209</p>
<p>考点：paillier cryptosystem, Homomorphic properties</p>
<h4 id="challenge-20"><a href="#challenge-20" class="headerlink" title="challenge"></a>challenge</h4><p>I have developed a probabilistic asymmetric algorithm for public key cryptography. Then I added some functions to harden it, you can try this oracle now. But I think it is still <a href="https://cr.yp.toc.tf/tasks/313_loyal_5644f2dfac340437d9165ec6a96387a92c9be38d.txz" target="_blank" rel="noopener">unbreakable</a>! What about you?</p>
<p><strong>Note:</strong> The source code updated, please download again!</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc <span class="number">07</span><span class="selector-class">.cr</span><span class="selector-class">.yp</span><span class="selector-class">.toc</span><span class="selector-class">.tf</span> <span class="number">31377</span></span><br></pre></td></tr></table></figure>

<h4 id="Thought-18"><a href="#Thought-18" class="headerlink" title="Thought"></a>Thought</h4><p>同态走一波，交互中的处理解密后相当于</p>
<p>$m_i = r\cdot (D(poly[0]) \cdot f_i + D(poly[1]) \cdot f_i^2 + D(poly[2]) \cdot f_i^3 \cdots) + f_i$</p>
<p>poly给个 $[E(0),E(0)]$，然后解密就能直接得到明文 <code>y4HCcRRMt{h!PF_00nOT71e3o3N0RCn_C5}pmH_C3!M</code></p>
<p>被最后 <code>shuffle(result)</code> 了，所以我们得构造一下，留一个标志</p>
<p>23333，不用了就是说，题目有POINTS.sort()，</p>
<h4 id="exp-20"><a href="#exp-20" class="headerlink" title="exp"></a>exp</h4><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from random import *</span><br><span class="line">import sys</span><br><span class="line">flag= b<span class="string">"a"</span>*<span class="number">2</span></span><br><span class="line"></span><br><span class="line">def keygen(nbit):</span><br><span class="line">	p, q = [getPrime(nbit) for _ in '__']</span><br><span class="line">	n, phi = p * q, (p - <span class="number">1</span>) * (q - <span class="number">1</span>) <span class="comment">// 2</span></span><br><span class="line">	while True:</span><br><span class="line">		g = getRandomRange(<span class="number">2</span>, n ** <span class="number">2</span>)</span><br><span class="line">		if GCD(g, n) == <span class="number">1</span>:</span><br><span class="line">			w = (<span class="built_in">pow</span>(g, phi, n ** <span class="number">2</span>) - <span class="number">1</span>) <span class="comment">// n</span></span><br><span class="line">			if GCD(w, n) == <span class="number">1</span>:</span><br><span class="line">				u = inverse(w, n)</span><br><span class="line">				break</span><br><span class="line">	pkey, skey = (n, g), (phi, u)</span><br><span class="line">	return pkey, skey</span><br><span class="line"></span><br><span class="line">def encrypt(pkey, m):</span><br><span class="line">	n, g = pkey</span><br><span class="line">	while True:</span><br><span class="line">		r = getRandomRange(<span class="number">2</span>, n)</span><br><span class="line">		if GCD(r, n) == <span class="number">1</span>:</span><br><span class="line">			break</span><br><span class="line">	return (<span class="built_in">pow</span>(g, m, n ** <span class="number">2</span>) * <span class="built_in">pow</span>(r, n, n ** <span class="number">2</span>)) % (n ** <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">def L(x,n):</span><br><span class="line">	return (x-<span class="number">1</span>)<span class="comment">//n</span></span><br><span class="line"></span><br><span class="line">def decrypt(sk,c,n):</span><br><span class="line">	Lambda, u = sk</span><br><span class="line">	m=(L(<span class="built_in">pow</span>(c,Lambda,n**<span class="number">2</span>),n)*u)%n</span><br><span class="line">	return m</span><br><span class="line"></span><br><span class="line">def add(pkey, a, b):</span><br><span class="line">	n, g = pkey</span><br><span class="line">	return <span class="built_in">pow</span>(a * b, <span class="number">1</span>, n ** <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">def multiply(pkey, a, k):</span><br><span class="line">	n, g = pkey</span><br><span class="line">	return <span class="built_in">pow</span>(a, k, n ** <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">def mul_poly(n, P, Q):</span><br><span class="line">	R = [<span class="number">0</span>] * (len(P) + len(Q))</span><br><span class="line">	for i in range(len(P)):</span><br><span class="line">		for j in range(len(Q)):</span><br><span class="line">			R[i+j] += (R[i + j] + P[i] * Q[j]) % n</span><br><span class="line">	return R</span><br><span class="line"></span><br><span class="line">def encrypt_poly(pkey, poly):</span><br><span class="line">	return [encrypt(pkey, term) for term in poly]</span><br><span class="line"></span><br><span class="line">def client_genpoly(pkey, points):</span><br><span class="line">	n, g = pkey</span><br><span class="line">	result = [<span class="number">1</span>]</span><br><span class="line">	for point in points:</span><br><span class="line">		result = mul_poly(n, result, [-point, <span class="number">1</span>])</span><br><span class="line">	return encrypt_poly(pkey, result)</span><br><span class="line"></span><br><span class="line">def evaluate_poly(pkey, poly, point):</span><br><span class="line">	n, g = pkey</span><br><span class="line">	_point = point</span><br><span class="line">	result = poly[<span class="number">0</span>]</span><br><span class="line">	for term in poly[<span class="number">1</span>:]:</span><br><span class="line">		result = add((n, g), result, multiply((n, g), term, _point))</span><br><span class="line">		_point = (_point * point) % n</span><br><span class="line">	return result</span><br><span class="line"></span><br><span class="line">def backend(pkey, poly, points):</span><br><span class="line">	n, g = pkey</span><br><span class="line">	R = []</span><br><span class="line">	for point in points:</span><br><span class="line">		result = evaluate_poly((n, g), poly, point)</span><br><span class="line">		result = multiply((n, g), result, getRandomRange(<span class="number">2</span>, n))</span><br><span class="line">		result = add((n, g), result, encrypt((n, g), point))</span><br><span class="line">		R.append(result)</span><br><span class="line">	return R</span><br><span class="line"></span><br><span class="line">POINTS = []</span><br><span class="line">for i in range(len(flag)):</span><br><span class="line">	POINTS.append(getRandomRange(<span class="number">2</span>, <span class="number">2</span> ** <span class="number">64</span>) * <span class="number">2</span> ** <span class="number">10</span>)</span><br><span class="line">POINTS.sort()</span><br><span class="line">for i in range(len(flag)):</span><br><span class="line">	POINTS[i] += flag[i]</span><br><span class="line"></span><br><span class="line">nbit = <span class="number">256</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#pkey, skey = keygen(nbit)</span></span><br><span class="line">pkey,skey = (<span class="number">8983025019747376462297416653504653560143717774277487268850273211947558329216360360860149180983608842607976796458487804140587479094830448025755096545144497</span>, <span class="number">39731172096476404258382334612980796427609232314781624939316778468164398684304697816364082061332364391985762624841996838368191881107968535717464420001080645817166058541017585108878564010798647594217487978324909939331031718886070579425358413244493346052109748996979570687086012138664475326345367218468552512086</span>),(<span class="number">4491512509873688231148708326752326780071858887138743634425136605973779164608084844589301889169145935681436639346715428462044150156908234212259061733932920</span>, <span class="number">4133856416919793681590686025820765995031321904145976790655198178331831628277063442563440913562455923032491945677717658580173062624722204381499487375119933</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">poly=[encrypt(pkey, <span class="number">0</span>),encrypt(pkey, <span class="number">0</span>)]</span><br><span class="line">n, g = pkey</span><br><span class="line"></span><br><span class="line">print(n,g,poly)</span><br><span class="line"></span><br><span class="line">sss='''| result[0] = <span class="number">60701364673871</span><span class="number">36853867256883</span><span class="number">66943119745062</span><span class="number">05703702029549</span><span class="number">36289342325877</span><span class="number">29880505778336</span><span class="number">44429122896297</span><span class="number">20733038255902</span><span class="number">50811007516295</span><span class="number">71179362400300</span><span class="number">52618818907613</span><span class="number">73431117931067</span><span class="number">28012955599396</span><span class="number">78080340559937</span><span class="number">80518810527274</span><span class="number">74682664697093</span><span class="number">67719444395761</span><span class="number">34116151720001</span><span class="number">97331483387389</span><span class="number">88477885602331</span><span class="number">97854213342000</span><span class="number">63270381794245</span></span><br><span class="line">| result[1] = <span class="number">54505714023959</span><span class="number">13253997254068</span><span class="number">82737930537555</span><span class="number">76505190909700</span><span class="number">05445660783800</span><span class="number">60992915847705</span><span class="number">40537730243507</span><span class="number">87474668147085</span><span class="number">71901391742907</span><span class="number">57042575260752</span><span class="number">92372472852884</span><span class="number">56110681529217</span><span class="number">59850791799612</span><span class="number">57569436661427</span><span class="number">10357842444515</span><span class="number">61577073442533</span><span class="number">47508235757890</span><span class="number">74568190574368</span><span class="number">82288500053622</span><span class="number">94042006419176</span><span class="number">78200863871871</span><span class="number">84772178256497</span></span><br><span class="line">| result[2] = <span class="number">31482244269832</span><span class="number">77430209321988</span><span class="number">04999602910929</span><span class="number">53288614981664</span><span class="number">81770415399647</span><span class="number">16480275975389</span><span class="number">39919368674593</span><span class="number">18173185060388</span><span class="number">87420677055958</span><span class="number">87769325167576</span><span class="number">20932020140731</span><span class="number">61563361373402</span><span class="number">27336618516467</span><span class="number">32906789869623</span><span class="number">58461195269805</span><span class="number">14739643514081</span><span class="number">82601106317763</span><span class="number">03754731321220</span><span class="number">49959095866560</span><span class="number">73418120325924</span><span class="number">04412688293057</span><span class="number">30268427579685</span></span><br><span class="line">| result[3] = <span class="number">21269066534820</span><span class="number">84479190316835</span><span class="number">12533026613780</span><span class="number">09045674764390</span><span class="number">13322139127617</span><span class="number">48423738223875</span><span class="number">97405434628556</span><span class="number">89431221779080</span><span class="number">62912760374092</span><span class="number">54287468293050</span><span class="number">70119848450577</span><span class="number">05215954332893</span><span class="number">69839519721579</span><span class="number">59578706087877</span><span class="number">48588286065004</span><span class="number">07079695185066</span><span class="number">23446269026377</span><span class="number">86000533190243</span><span class="number">74276255764488</span><span class="number">14241986501177</span><span class="number">86529428254564</span><span class="number">39614530036182</span></span><br><span class="line">| result[4] = <span class="number">17726688771976</span><span class="number">15488506873004</span><span class="number">34551908832695</span><span class="number">25441213807838</span><span class="number">86503819102709</span><span class="number">91489337564565</span><span class="number">49504383830879</span><span class="number">49303123513662</span><span class="number">98119195212966</span><span class="number">00120227451862</span><span class="number">95070660194297</span><span class="number">78849667020737</span><span class="number">41341153318302</span><span class="number">01772274304083</span><span class="number">62474257075345</span><span class="number">42820001264527</span><span class="number">44389245728755</span><span class="number">59501731848502</span><span class="number">26884844739032</span><span class="number">12204719462428</span><span class="number">61552542688758</span><span class="number">21400430386321</span></span><br><span class="line">| result[5] = <span class="number">35581860655885</span><span class="number">09216348342340</span><span class="number">03466040486894</span><span class="number">62882882756754</span><span class="number">69657379685648</span><span class="number">93009869532769</span><span class="number">45441662627908</span><span class="number">81202448319927</span><span class="number">34489876446590</span><span class="number">97506243719064</span><span class="number">99822436368218</span><span class="number">93359832021075</span><span class="number">00032263863291</span><span class="number">68109610613063</span><span class="number">70526511938326</span><span class="number">33671948091747</span><span class="number">29416146425846</span><span class="number">38893086479628</span><span class="number">24508327390390</span><span class="number">65067938997224</span><span class="number">00718482854310</span><span class="number">37044105552233</span></span><br><span class="line">| result[6] = <span class="number">70262218169601</span><span class="number">16895632560114</span><span class="number">69229989527581</span><span class="number">83545527211453</span><span class="number">22419717498165</span><span class="number">56436410999662</span><span class="number">05886141855918</span><span class="number">59611159366655</span><span class="number">47177714101729</span><span class="number">39175497105544</span><span class="number">87990824370604</span><span class="number">99121339175677</span><span class="number">31452132168722</span><span class="number">47253847646380</span><span class="number">89925822050239</span><span class="number">05085397231349</span><span class="number">62485255345571</span><span class="number">14969518408958</span><span class="number">98245143454512</span><span class="number">96251725705973</span><span class="number">61554628115282</span><span class="number">87491960222811</span></span><br><span class="line">| result[7] = <span class="number">12795117201194</span><span class="number">96735679054176</span><span class="number">76685031145122</span><span class="number">67924019154453</span><span class="number">29934396379965</span><span class="number">85953505190919</span><span class="number">84396355283867</span><span class="number">47141494003358</span><span class="number">08483755560218</span><span class="number">04326920619318</span><span class="number">33606156797717</span><span class="number">07497713514260</span><span class="number">69410874784474</span><span class="number">08066663361062</span><span class="number">21946441152066</span><span class="number">47671405511436</span><span class="number">90796385206137</span><span class="number">94526343266501</span><span class="number">30519927260404</span><span class="number">79428110238830</span><span class="number">51921552499807</span><span class="number">68944441280471</span></span><br><span class="line">| result[8] = <span class="number">29614433752881</span><span class="number">25727227771936</span><span class="number">71396855194843</span><span class="number">35743547386264</span><span class="number">16847947528786</span><span class="number">65998856724291</span><span class="number">75204283879232</span><span class="number">25196189248904</span><span class="number">66312805810127</span><span class="number">07224071363004</span><span class="number">50387340229301</span><span class="number">22685192450787</span><span class="number">65587356381014</span><span class="number">45820957155172</span><span class="number">58729288194092</span><span class="number">82901936309811</span><span class="number">79581796002900</span><span class="number">26857637907973</span><span class="number">53218312562241</span><span class="number">76898992759843</span><span class="number">16895132752394</span><span class="number">72807021572121</span></span><br><span class="line">| result[9] = <span class="number">22516684635991</span><span class="number">63506518217595</span><span class="number">15740087486455</span><span class="number">94707696075503</span><span class="number">63206027807992</span><span class="number">23888702125648</span><span class="number">38708853941193</span><span class="number">36316265500251</span><span class="number">73274328395111</span><span class="number">80511583812509</span><span class="number">07047672421689</span><span class="number">55595936532763</span><span class="number">25046380499276</span><span class="number">87762573538319</span><span class="number">97235968267655</span><span class="number">90155361573577</span><span class="number">16540104388303</span><span class="number">98177557463159</span><span class="number">63588141798754</span><span class="number">54060010275478</span><span class="number">18471941350187</span><span class="number">39913349584325</span></span><br><span class="line">| result[10] = <span class="number">13399450171607</span><span class="number">88466449485665</span><span class="number">73618129316259</span><span class="number">14963618697366</span><span class="number">83106272175197</span><span class="number">14031451233206</span><span class="number">74009008821282</span><span class="number">98356853178709</span><span class="number">40674520848948</span><span class="number">73241556069878</span><span class="number">95628957051620</span><span class="number">05423728398156</span><span class="number">50194434551341</span><span class="number">81725526400014</span><span class="number">92185047816902</span><span class="number">61221856732320</span><span class="number">67346596544798</span><span class="number">65272916537396</span><span class="number">43201023307300</span><span class="number">67233005556496</span><span class="number">90648245386568</span><span class="number">409998847934</span>2</span><br><span class="line">| result[11] = <span class="number">69287254090604</span><span class="number">49667491815539</span><span class="number">74721795819574</span><span class="number">32096162716627</span><span class="number">81563617188788</span><span class="number">98094675906912</span><span class="number">68907858811035</span><span class="number">26019540150009</span><span class="number">52825940423264</span><span class="number">18234802296422</span><span class="number">69916323083603</span><span class="number">08855979355140</span><span class="number">69001789428122</span><span class="number">96343956366130</span><span class="number">85732414683887</span><span class="number">69427582928754</span><span class="number">92324290830799</span><span class="number">05063553935340</span><span class="number">01812279916307</span><span class="number">46141425950053</span><span class="number">63454857910998</span><span class="number">63372329968516</span></span><br><span class="line">| result[12] = <span class="number">16759195422769</span><span class="number">79261012777121</span><span class="number">01173917269441</span><span class="number">71091960737436</span><span class="number">81602726026736</span><span class="number">12425681768316</span><span class="number">15850689545674</span><span class="number">22843107747944</span><span class="number">01134924026700</span><span class="number">84544913473934</span><span class="number">87788590048401</span><span class="number">84401397508808</span><span class="number">75692736494521</span><span class="number">04118495478526</span><span class="number">83254457499739</span><span class="number">75236495533868</span><span class="number">12175079820638</span><span class="number">03775082484005</span><span class="number">05013953093455</span><span class="number">09182790332176</span><span class="number">12085442453943</span><span class="number">09774591546395</span></span><br><span class="line">| result[13] = <span class="number">40076475379029</span><span class="number">37131569115720</span><span class="number">03740269617471</span><span class="number">71058330824061</span><span class="number">10183544549672</span><span class="number">70928456296645</span><span class="number">24783040634705</span><span class="number">72094245582006</span><span class="number">86251662831093</span><span class="number">53526947365834</span><span class="number">81472304597789</span><span class="number">71858713586409</span><span class="number">38536741635051</span><span class="number">08972842362670</span><span class="number">35530812322214</span><span class="number">44893658041997</span><span class="number">50081606925282</span><span class="number">98053777698511</span><span class="number">32893495601067</span><span class="number">71154665737559</span><span class="number">05869724011850</span><span class="number">00811090538556</span></span><br><span class="line">| result[14] = <span class="number">71711004763431</span><span class="number">42412954727919</span><span class="number">37768887803573</span><span class="number">34638452565649</span><span class="number">00202791914204</span><span class="number">48436666805099</span><span class="number">48122126885305</span><span class="number">22181238204550</span><span class="number">81593379337723</span><span class="number">20896035393540</span><span class="number">02892911252568</span><span class="number">24435198422600</span><span class="number">52075295474113</span><span class="number">78034479622566</span><span class="number">48674878946199</span><span class="number">80383279601210</span><span class="number">80242642165973</span><span class="number">14791206716431</span><span class="number">41277657873408</span><span class="number">56010716134539</span><span class="number">01927075128582</span><span class="number">87529651245448</span></span><br><span class="line">| result[15] = <span class="number">20791606033656</span><span class="number">01609462861796</span><span class="number">62690892263535</span><span class="number">49652775886836</span><span class="number">01905238379194</span><span class="number">24268551448147</span><span class="number">47295577757921</span><span class="number">37197686616432</span><span class="number">93496456094649</span><span class="number">72383827102785</span><span class="number">33568812785698</span><span class="number">84936750641363</span><span class="number">57879213697810</span><span class="number">23228116860292</span><span class="number">61111027108259</span><span class="number">13940354102696</span><span class="number">64694346048801</span><span class="number">80016352170902</span><span class="number">48096358971800</span><span class="number">53249187247408</span><span class="number">95472177558621</span><span class="number">45072867276542</span></span><br><span class="line">| result[16] = <span class="number">75524796633982</span><span class="number">20898870471591</span><span class="number">25514731657392</span><span class="number">74261376865710</span><span class="number">51198556472592</span><span class="number">70936213111032</span><span class="number">09006337490642</span><span class="number">00937697741943</span><span class="number">29057582299671</span><span class="number">99550227182286</span><span class="number">55006332985362</span><span class="number">15985670201602</span><span class="number">51853455880998</span><span class="number">69570066091949</span><span class="number">78310809036978</span><span class="number">28163730364557</span><span class="number">17645890562543</span><span class="number">80527751290182</span><span class="number">22117239901453</span><span class="number">59577850804623</span><span class="number">53813391380073</span><span class="number">36966032324535</span></span><br><span class="line">| result[17] = <span class="number">88218139059899</span><span class="number">79131671277386</span><span class="number">72861827214546</span><span class="number">18656699723200</span><span class="number">58426591083853</span><span class="number">77447790783711</span><span class="number">18904680406250</span><span class="number">18780557786597</span><span class="number">00744787395727</span><span class="number">71036509069961</span><span class="number">94158170295426</span><span class="number">49403913592227</span><span class="number">71872703134289</span><span class="number">72125836953999</span><span class="number">73238803444400</span><span class="number">92644011640586</span><span class="number">93978746681473</span><span class="number">88580348082268</span><span class="number">20581624360824</span><span class="number">77237896733586</span><span class="number">94181382237994</span><span class="number">406391687869</span>7</span><br><span class="line">| result[18] = <span class="number">23858579030504</span><span class="number">54824139461333</span><span class="number">12958671989162</span><span class="number">69460872458465</span><span class="number">55816784485284</span><span class="number">35245090938059</span><span class="number">61758176046984</span><span class="number">46410717421099</span><span class="number">32922303597758</span><span class="number">65831814447038</span><span class="number">05603080614565</span><span class="number">96064539530406</span><span class="number">42384946279969</span><span class="number">21518911891342</span><span class="number">14001897088864</span><span class="number">15836423398229</span><span class="number">66202840737635</span><span class="number">60691838051930</span><span class="number">76648017540211</span><span class="number">92074282675933</span><span class="number">31018256926050</span><span class="number">13711191136020</span></span><br><span class="line">| result[19] = <span class="number">93469183542030</span><span class="number">55264838411202</span><span class="number">51772815643874</span><span class="number">08775427179430</span><span class="number">87903300777815</span><span class="number">34745150901189</span><span class="number">60793078169240</span><span class="number">96770296222263</span><span class="number">45023293229542</span><span class="number">70019799599026</span><span class="number">07357883723659</span><span class="number">51153923507008</span><span class="number">08947923180743</span><span class="number">24351758507435</span><span class="number">69091091473668</span><span class="number">22782989951207</span><span class="number">30565793512961</span><span class="number">04763407053907</span><span class="number">44060829577237</span><span class="number">99455330409612</span><span class="number">49797778027187</span><span class="number">386892577409</span></span><br><span class="line">| result[20] = <span class="number">53549326491556</span><span class="number">74924512424856</span><span class="number">42685288213043</span><span class="number">23571880706981</span><span class="number">89345750374747</span><span class="number">78111023127515</span><span class="number">00086148327418</span><span class="number">00366924402320</span><span class="number">22621761696984</span><span class="number">30461986240040</span><span class="number">34943829053327</span><span class="number">29773130961425</span><span class="number">06488063219805</span><span class="number">92885742681740</span><span class="number">14279533607252</span><span class="number">10678433115875</span><span class="number">09400555960857</span><span class="number">86595353262214</span><span class="number">42286819812159</span><span class="number">81547756814204</span><span class="number">87328764123096</span><span class="number">34036656163383</span></span><br><span class="line">| result[21] = <span class="number">55222350252509</span><span class="number">84123914090639</span><span class="number">85491124530231</span><span class="number">12784051423474</span><span class="number">48823128400842</span><span class="number">27718046568458</span><span class="number">98906882092803</span><span class="number">32393484050569</span><span class="number">49070348234280</span><span class="number">39348059313701</span><span class="number">49019849444701</span><span class="number">20899725336989</span><span class="number">80894869449739</span><span class="number">17435591950642</span><span class="number">14629801190023</span><span class="number">17262647649678</span><span class="number">82248690974079</span><span class="number">30696253764012</span><span class="number">14410464118657</span><span class="number">61857675170523</span><span class="number">15176571129233</span><span class="number">30480129163394</span></span><br><span class="line">| result[22] = <span class="number">54383042832687</span><span class="number">71315256798143</span><span class="number">26142453276308</span><span class="number">96037469221404</span><span class="number">40788639827114</span><span class="number">06279070172152</span><span class="number">25774516223165</span><span class="number">34635992770998</span><span class="number">92941475006325</span><span class="number">32772555538685</span><span class="number">92791531132250</span><span class="number">61853915123208</span><span class="number">49008655889439</span><span class="number">01241048553573</span><span class="number">34124229719144</span><span class="number">44079238718453</span><span class="number">45472288230555</span><span class="number">08585274152615</span><span class="number">92835787831733</span><span class="number">42051434120107</span><span class="number">62801509471183</span><span class="number">45123209496012</span></span><br><span class="line">| result[23] = <span class="number">35415702116663</span><span class="number">71979367930944</span><span class="number">85714412303356</span><span class="number">49679652346834</span><span class="number">21041908735080</span><span class="number">20311333095200</span><span class="number">73015911063285</span><span class="number">52862902202435</span><span class="number">29074761617828</span><span class="number">55987076300661</span><span class="number">10767985384168</span><span class="number">38147736849841</span><span class="number">69614895405277</span><span class="number">66120197842933</span><span class="number">87492837707638</span><span class="number">51935118478987</span><span class="number">02777427370401</span><span class="number">23953783933925</span><span class="number">42417614803751</span><span class="number">23982285968033</span><span class="number">70212323152881</span><span class="number">08113937955559</span></span><br><span class="line">| result[24] = <span class="number">77311376414735</span><span class="number">23309195692593</span><span class="number">33429286352747</span><span class="number">08978684257645</span><span class="number">71680411339955</span><span class="number">37140235825316</span><span class="number">06632148219973</span><span class="number">36821866367181</span><span class="number">82729492067051</span><span class="number">69102858209221</span><span class="number">72269565666730</span><span class="number">93632922716581</span><span class="number">33480258326067</span><span class="number">42779915577492</span><span class="number">76217199455421</span><span class="number">78413438011676</span><span class="number">66346929398365</span><span class="number">95806957293733</span><span class="number">84539727292051</span><span class="number">11757498224321</span><span class="number">63805198881068</span><span class="number">80694068805459</span></span><br><span class="line">| result[25] = <span class="number">41529714518679</span><span class="number">10445661509943</span><span class="number">06168457580819</span><span class="number">83056782336280</span><span class="number">29312961385304</span><span class="number">77488333672143</span><span class="number">25002402088267</span><span class="number">19071502180474</span><span class="number">89208656486231</span><span class="number">42120762365373</span><span class="number">48673284209719</span><span class="number">64550130202391</span><span class="number">83373288560579</span><span class="number">42606006706520</span><span class="number">06871349512205</span><span class="number">91419796173683</span><span class="number">08276875917824</span><span class="number">42607495616178</span><span class="number">26924419724965</span><span class="number">73795129414181</span><span class="number">53322599050765</span><span class="number">67273380342177</span></span><br><span class="line">| result[26] = <span class="number">78934023973015</span><span class="number">54741035949436</span><span class="number">30111415274694</span><span class="number">88211362978027</span><span class="number">08856257680614</span><span class="number">58199076023426</span><span class="number">63202811386262</span><span class="number">95795820638748</span><span class="number">29299339881640</span><span class="number">37938470659762</span><span class="number">97990821622330</span><span class="number">11927583483677</span><span class="number">18269596157629</span><span class="number">22303397365594</span><span class="number">70430165648974</span><span class="number">17294289237275</span><span class="number">11310949140882</span><span class="number">53855926532623</span><span class="number">18324018451966</span><span class="number">10332139949415</span><span class="number">82106690533214</span><span class="number">66011572476847</span></span><br><span class="line">| result[27] = <span class="number">31320932316349</span><span class="number">77228609046523</span><span class="number">20540510517941</span><span class="number">76405615427761</span><span class="number">01538669687926</span><span class="number">11908095493928</span><span class="number">13975028528244</span><span class="number">11097311029083</span><span class="number">60762111244233</span><span class="number">36616805929661</span><span class="number">32059986333609</span><span class="number">75293285812111</span><span class="number">63055065734185</span><span class="number">33740820219828</span><span class="number">14331563672050</span><span class="number">04278804400721</span><span class="number">51522611701159</span><span class="number">81356055143251</span><span class="number">23860975124167</span><span class="number">72473431063407</span><span class="number">84207977127843</span><span class="number">87943565985110</span></span><br><span class="line">| result[28] = <span class="number">61615833676933</span><span class="number">16608233676908</span><span class="number">68658711028423</span><span class="number">16919223122542</span><span class="number">62739541934072</span><span class="number">99762083160641</span><span class="number">29377840521633</span><span class="number">91455572601615</span><span class="number">97085960022807</span><span class="number">45351159091674</span><span class="number">63881646054318</span><span class="number">39753294768811</span><span class="number">54656750277826</span><span class="number">74154902192395</span><span class="number">44311468239649</span><span class="number">60957247463417</span><span class="number">28687515984142</span><span class="number">01625479323239</span><span class="number">79806824067555</span><span class="number">76711747686555</span><span class="number">38440675258502</span><span class="number">74474528310300</span></span><br><span class="line">| result[29] = <span class="number">17858697213202</span><span class="number">68316109518474</span><span class="number">58861874152757</span><span class="number">87380085552763</span><span class="number">74203812024144</span><span class="number">85565235775593</span><span class="number">54574407298939</span><span class="number">20638492261587</span><span class="number">29219691220018</span><span class="number">96758816300114</span><span class="number">20642425877506</span><span class="number">46414722003115</span><span class="number">08468415911230</span><span class="number">46064293394670</span><span class="number">95148302112124</span><span class="number">37819850220045</span><span class="number">66075150293261</span><span class="number">75160235124391</span><span class="number">40337808639567</span><span class="number">90489068053099</span><span class="number">77429807344154</span><span class="number">35491937931896</span></span><br><span class="line">| result[30] = <span class="number">34346790038388</span><span class="number">47163230386258</span><span class="number">50856450971300</span><span class="number">98720109170630</span><span class="number">71366577777488</span><span class="number">19448675513762</span><span class="number">55801912635440</span><span class="number">13040811511414</span><span class="number">86606049942098</span><span class="number">79849280917397</span><span class="number">83507148430519</span><span class="number">98318346234081</span><span class="number">64544668180303</span><span class="number">16353979327963</span><span class="number">58666686480032</span><span class="number">34643202017407</span><span class="number">17379130520629</span><span class="number">29421247588034</span><span class="number">81011437127550</span><span class="number">93953200931878</span><span class="number">48753710155201</span><span class="number">277337004562</span>7</span><br><span class="line">| result[31] = <span class="number">55296486580580</span><span class="number">67456080502279</span><span class="number">27306156505195</span><span class="number">78766688949252</span><span class="number">37170276229745</span><span class="number">27199990983016</span><span class="number">31097181290431</span><span class="number">08004214291412</span><span class="number">58934042026239</span><span class="number">20417018513557</span><span class="number">28153402298992</span><span class="number">02351879223549</span><span class="number">88868589310212</span><span class="number">32192139054043</span><span class="number">16798013244481</span><span class="number">03623007589571</span><span class="number">65823307365171</span><span class="number">26400169819747</span><span class="number">99501707571209</span><span class="number">59683713081315</span><span class="number">42569919412920</span><span class="number">70451355395380</span></span><br><span class="line">| result[32] = <span class="number">15683825059527</span><span class="number">22374405655968</span><span class="number">25015119825362</span><span class="number">92418609203084</span><span class="number">23783996345731</span><span class="number">00681326832641</span><span class="number">68727671275680</span><span class="number">30249024470563</span><span class="number">42624499471058</span><span class="number">33465996329110</span><span class="number">36176386160816</span><span class="number">31999816690752</span><span class="number">29559205476635</span><span class="number">00165009732866</span><span class="number">16332437066994</span><span class="number">79067393531345</span><span class="number">96548217551503</span><span class="number">64279945773772</span><span class="number">74992050348435</span><span class="number">13214353573936</span><span class="number">31398135808007</span><span class="number">13500429127065</span></span><br><span class="line">| result[33] = <span class="number">79089731655664</span><span class="number">65942160370183</span><span class="number">36918174234959</span><span class="number">74527897708959</span><span class="number">32743135345572</span><span class="number">74254565687516</span><span class="number">35923281066657</span><span class="number">14866263349289</span><span class="number">00023493869889</span><span class="number">37076599708551</span><span class="number">22947583954685</span><span class="number">36042314872167</span><span class="number">37963865879551</span><span class="number">27302582686112</span><span class="number">07234303547406</span><span class="number">49623843510117</span><span class="number">03593322366056</span><span class="number">99373810046327</span><span class="number">00211522998544</span><span class="number">17713813067346</span><span class="number">83953713189856</span><span class="number">29073789065357</span></span><br><span class="line">| result[34] = <span class="number">21460569824913</span><span class="number">65517126167738</span><span class="number">53708184049345</span><span class="number">28843151111628</span><span class="number">07567998166911</span><span class="number">05720596395756</span><span class="number">26981528972048</span><span class="number">81571420902545</span><span class="number">37619685272753</span><span class="number">61557400560847</span><span class="number">30134381000362</span><span class="number">51534546725574</span><span class="number">64316157235901</span><span class="number">37002795044032</span><span class="number">28105659350221</span><span class="number">20998393518027</span><span class="number">12273128939875</span><span class="number">56389978718699</span><span class="number">07101597359826</span><span class="number">96255890286467</span><span class="number">39893727210166</span><span class="number">66049925650456</span></span><br><span class="line">| result[35] = <span class="number">30357471700897</span><span class="number">55282758829783</span><span class="number">85427206453864</span><span class="number">84333478129105</span><span class="number">96227723546680</span><span class="number">84837338700988</span><span class="number">42125393221161</span><span class="number">60804828915201</span><span class="number">82097085018473</span><span class="number">69893338903483</span><span class="number">56513679986526</span><span class="number">51740083632766</span><span class="number">36836194733392</span><span class="number">70098617293133</span><span class="number">79530609896548</span><span class="number">62206958291624</span><span class="number">69126541592059</span><span class="number">56031849244452</span><span class="number">35289465285373</span><span class="number">36679432406761</span><span class="number">15987494261043</span><span class="number">13055248956579</span></span><br><span class="line">| result[36] = <span class="number">66195583187466</span><span class="number">11747143158017</span><span class="number">88150620331647</span><span class="number">55151649992899</span><span class="number">79385902663408</span><span class="number">00167103668412</span><span class="number">08725185551306</span><span class="number">73432847288465</span><span class="number">36108031827788</span><span class="number">70799901014792</span><span class="number">67079110392205</span><span class="number">55385758350520</span><span class="number">24690253183215</span><span class="number">32129826257240</span><span class="number">33137620430490</span><span class="number">29002001953084</span><span class="number">71364768562705</span><span class="number">58294245342426</span><span class="number">13423062212897</span><span class="number">99247676200567</span><span class="number">32570957646819</span><span class="number">70896250671977</span></span><br><span class="line">| result[37] = <span class="number">49003911875690</span><span class="number">11665887501460</span><span class="number">59842636340596</span><span class="number">50654319648994</span><span class="number">44614761504660</span><span class="number">18552981504241</span><span class="number">69467393711635</span><span class="number">42301152656753</span><span class="number">78562332009509</span><span class="number">69219779755961</span><span class="number">99109071306546</span><span class="number">24334049625434</span><span class="number">90156490003111</span><span class="number">21631182589005</span><span class="number">70378515272985</span><span class="number">11148357386169</span><span class="number">29983473823288</span><span class="number">64282725023121</span><span class="number">62237066368599</span><span class="number">03359045421655</span><span class="number">36008614280535</span><span class="number">16351207797738</span></span><br><span class="line">| result[38] = <span class="number">71367507491803</span><span class="number">67230336450507</span><span class="number">78243591787539</span><span class="number">51125198410885</span><span class="number">47985126813235</span><span class="number">33115544308648</span><span class="number">49726439584142</span><span class="number">08139981702097</span><span class="number">36673875142173</span><span class="number">21690324236692</span><span class="number">49473717637760</span><span class="number">18960661012274</span><span class="number">01121377079365</span><span class="number">05209582865689</span><span class="number">52147997174856</span><span class="number">21919836974687</span><span class="number">11876782526587</span><span class="number">85712783723931</span><span class="number">60561486223736</span><span class="number">30918742500916</span><span class="number">05669748121231</span><span class="number">18299140384922</span></span><br><span class="line">| result[39] = <span class="number">62810724118805</span><span class="number">84899360013512</span><span class="number">29282173034634</span><span class="number">53389592498155</span><span class="number">02343928452720</span><span class="number">80665175104050</span><span class="number">01857312033709</span><span class="number">93833930686235</span><span class="number">18276439506098</span><span class="number">61193914434015</span><span class="number">03084827111250</span><span class="number">37382310253593</span><span class="number">85022570295192</span><span class="number">90677275551034</span><span class="number">11700002740762</span><span class="number">01885965220443</span><span class="number">56373703555507</span><span class="number">09842186121831</span><span class="number">75594820652181</span><span class="number">58128971713525</span><span class="number">23369552236684</span><span class="number">90546941035537</span></span><br><span class="line">| result[40] = <span class="number">55854579310329</span><span class="number">15832452313196</span><span class="number">46309190993703</span><span class="number">88400065850466</span><span class="number">82204809222004</span><span class="number">35256245294927</span><span class="number">35287316835816</span><span class="number">15387381285540</span><span class="number">89046131033000</span><span class="number">44529403478660</span><span class="number">62260003436613</span><span class="number">15319006278462</span><span class="number">21227994960248</span><span class="number">76466499050538</span><span class="number">01104972719311</span><span class="number">48220508417013</span><span class="number">37547804987309</span><span class="number">37124788105284</span><span class="number">27963088706404</span><span class="number">86783600153729</span><span class="number">82543474158306</span><span class="number">006585769150</span>5</span><br><span class="line">| result[41] = <span class="number">45519014546016</span><span class="number">21574045444424</span><span class="number">56023190440572</span><span class="number">77793090377517</span><span class="number">00646898796048</span><span class="number">96141814406788</span><span class="number">49348761856468</span><span class="number">94270404401223</span><span class="number">26270254176446</span><span class="number">71867705688036</span><span class="number">15731121737754</span><span class="number">16414501031369</span><span class="number">04021932300270</span><span class="number">97096584685203</span><span class="number">15665986023985</span><span class="number">79950818476946</span><span class="number">16569736058642</span><span class="number">64308848578947</span><span class="number">74397231175767</span><span class="number">47922343102011</span><span class="number">80046899746050</span><span class="number">380229916915</span>9</span><br><span class="line">| result[42] = <span class="number">15231283044446</span><span class="number">66162136381017</span><span class="number">44583773799809</span><span class="number">65061715034718</span><span class="number">55669404990801</span><span class="number">73503221064949</span><span class="number">68359959811085</span><span class="number">84323636231301</span><span class="number">76122002924079</span><span class="number">84558138898897</span><span class="number">35487222765357</span><span class="number">41531289443659</span><span class="number">79225025175276</span><span class="number">49247311429621</span><span class="number">77377671524060</span><span class="number">59316217564256</span><span class="number">93874231401627</span><span class="number">57444695008543</span><span class="number">71658586413444</span><span class="number">57311232011020</span><span class="number">63118673830416</span><span class="number">09094690184151</span></span><br><span class="line">'''</span><br><span class="line">import re</span><br><span class="line">s = re.findall(<span class="string">".*? = (\d+)"</span>,sss)</span><br><span class="line"><span class="meta">#print(s)</span></span><br><span class="line">flag=<span class="string">""</span></span><br><span class="line">FLAG = []</span><br><span class="line">for each in s:</span><br><span class="line">	FLAG += [decrypt(skey,int(each),n)]</span><br><span class="line">FLAG.sort()</span><br><span class="line">flag = ''.join(chr(i%<span class="number">256</span>) for i in FLAG)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<h4 id="result-20"><a href="#result-20" class="headerlink" title="result"></a>result</h4><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CCTF&#123;<span class="number">4</span><span class="symbol">n0</span>t<span class="number">3</span>R_h<span class="number">0</span>MomORpH<span class="number">1</span>C_<span class="number">3</span><span class="symbol">NcRyP7</span>!<span class="number">0</span><span class="symbol">n_5</span>CH<span class="number">3</span>Me!&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Soda"><a href="#Soda" class="headerlink" title="Soda*"></a>Soda*</h3><p>分值：209</p>
<p>考点：signature forge</p>
<h4 id="challenge-21"><a href="#challenge-21" class="headerlink" title="challenge"></a>challenge</h4><p>You may ask yourself how factoreal is skipping RSA? Here he comes with this <a href="https://cr.yp.toc.tf/tasks/soda_8356c83d83dea0ab31df6650fe4c1e8c23afa5b0.txz" target="_blank" rel="noopener">one</a>!</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc <span class="number">01</span><span class="selector-class">.cr</span><span class="selector-class">.yp</span><span class="selector-class">.toc</span><span class="selector-class">.tf</span> <span class="number">37711</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> p, q, flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">soda</span><span class="params">(g, p, q, m)</span>:</span></span><br><span class="line">	n, phi = p * q, (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">	<span class="keyword">if</span> isPrime(m) <span class="keyword">and</span> m.bit_length() &lt;= <span class="number">128</span>:</span><br><span class="line">		e = m</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		e = <span class="number">2</span> * (pow(g, m**<span class="number">2</span>, n) % <span class="number">2</span>**<span class="number">152</span>) ^ <span class="number">1</span></span><br><span class="line">	<span class="keyword">if</span> GCD(e, phi) == <span class="number">1</span>:</span><br><span class="line">		d = inverse(e, phi)</span><br><span class="line">		<span class="keyword">return</span> pow(g, d, n)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">die</span><span class="params">(*args)</span>:</span></span><br><span class="line">	pr(*args)</span><br><span class="line">	quit()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pr</span><span class="params">(*args)</span>:</span></span><br><span class="line">	s = <span class="string">" "</span>.join(map(str, args))</span><br><span class="line">	sys.stdout.write(s + <span class="string">"\n"</span>)</span><br><span class="line">	sys.stdout.flush()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sc</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="keyword">return</span> sys.stdin.readline().strip()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">	border = <span class="string">"|"</span></span><br><span class="line">	pr(border*<span class="number">72</span>)</span><br><span class="line">	pr(border, <span class="string">"Hi all cryptographers! Welcome to SODA crypto oracle, we do SODAing!"</span>, border)</span><br><span class="line">	pr(border, <span class="string">"You mission is find a way to SODA a given message, I think its easy."</span>, border)</span><br><span class="line">	border = <span class="string">"|"</span></span><br><span class="line">	</span><br><span class="line">	n = p * q</span><br><span class="line">	phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">	g = <span class="number">31337</span></span><br><span class="line"></span><br><span class="line">	CRY = <span class="string">"Long Live Crypto :))"</span></span><br><span class="line">	m = bytes_to_long(CRY.encode(<span class="string">'utf-8'</span>))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		pr(<span class="string">"| Options: \n|\t[G]et the parameters \n|\t[T]ry the soda \n|\t[V]erify the signature \n|\t[Q]uit"</span>)</span><br><span class="line">		ans = sc().lower()</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> ans == <span class="string">'g'</span>:</span><br><span class="line">			pr(border, <span class="string">f'n = <span class="subst">&#123;n&#125;</span>'</span>)</span><br><span class="line">			pr(border, <span class="string">f'g = <span class="subst">&#123;g&#125;</span>'</span>)</span><br><span class="line">		<span class="keyword">elif</span> ans == <span class="string">'t'</span>:</span><br><span class="line">			pr(border, <span class="string">"please send your integer to get soda: "</span>)</span><br><span class="line">			s = sc()</span><br><span class="line">			<span class="keyword">try</span>:</span><br><span class="line">				s = int(s)</span><br><span class="line">			<span class="keyword">except</span>:</span><br><span class="line">				die(border, <span class="string">"Something went wrong! Your input is not valid!! Bye!!!"</span>)</span><br><span class="line">			h = soda(g, p, q, s)</span><br><span class="line">			<span class="keyword">if</span> h != <span class="literal">None</span>:</span><br><span class="line">				<span class="keyword">if</span> s == m:</span><br><span class="line">					die(border, <span class="string">'Are you kidding me? We will never SODA it!! Bye!!!'</span>)</span><br><span class="line">				<span class="keyword">else</span>:</span><br><span class="line">					pr(border, <span class="string">f"soda(g, p, q, m) = <span class="subst">&#123;soda(g, p, q, s)&#125;</span>"</span>)</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				pr(border, <span class="string">'Something went wrong! See source code!!'</span>)	</span><br><span class="line">		<span class="keyword">elif</span> ans == <span class="string">"v"</span>:</span><br><span class="line">			pr(border, <span class="string">"please send the soda to verify: "</span>)</span><br><span class="line">			sd = sc()</span><br><span class="line">			<span class="keyword">try</span>:</span><br><span class="line">				sd = int(sd)</span><br><span class="line">			<span class="keyword">except</span>:</span><br><span class="line">				die(border, <span class="string">"Your input is not valid! Bye!!"</span>)</span><br><span class="line">			_e = <span class="number">2</span> * (pow(g, m**<span class="number">2</span>, n) % <span class="number">2</span>**<span class="number">152</span>) ^ <span class="number">1</span></span><br><span class="line">			<span class="keyword">if</span> pow(sd, _e, n) == g:</span><br><span class="line">				die(border, <span class="string">"Congrats! your got the flag: "</span> + flag)</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				pr(border, <span class="string">"[ERR]: Your answer is NOT correct!!!"</span>)</span><br><span class="line">		<span class="keyword">elif</span> ans == <span class="string">'q'</span>:</span><br><span class="line">			die(border, <span class="string">"Quitting ..."</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			die(border, <span class="string">"Bye bye ..."</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>

<h4 id="Thought-19"><a href="#Thought-19" class="headerlink" title="Thought"></a>Thought</h4><p>$e = 2 \cdot (g^{m^2}%n) % 2^{152}) \oplus 1$</p>
<p>这里用的是 $m^2$</p>
<p>限制不让 $s=m$</p>
<p>emmmm，但是没说不让 $s=-m$ </p>
<h4 id="exp-21"><a href="#exp-21" class="headerlink" title="exp"></a>exp</h4><h4 id="result-21"><a href="#result-21" class="headerlink" title="result"></a>result</h4><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-<span class="number">0</span>-<span class="number">7</span>-centos ~]<span class="comment"># nc 01.cr.yp.toc.tf 37711</span></span><br><span class="line"><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span></span><br><span class="line"><span class="params">| Hi all cryptographers! Welcome to SODA crypto oracle, we <span class="keyword">do</span> SODAing! |</span></span><br><span class="line"><span class="params">| You mission is find a way to SODA a given message, I think its easy. |</span></span><br><span class="line"><span class="params">| Options: </span></span><br><span class="line"><span class="params">|</span>	[G]et the parameters </span><br><span class="line"><span class="params">|	[T]ry the soda </span></span><br><span class="line"><span class="params">|</span>	[V]erify the signature </span><br><span class="line"><span class="params">|	[Q]uit</span></span><br><span class="line"><span class="params">T</span></span><br><span class="line"><span class="params">|</span> please send your integer to get <span class="symbol">soda:</span> </span><br><span class="line">-<span class="number">436368298743117038953816769867134146642565540137</span></span><br><span class="line"><span class="params">| soda(g, p, q, m) = 79559095642922266463148997031064319613325134865931925211002769523336997914218584554135332631438918297442868689016949177146172826664238399782606128281653170770356172139616842694434150846482170779338124730300765599381100281978959304884291887782907002310338483665832672081733896484850235842710260881749486555655</span></span><br><span class="line"><span class="params">|</span> <span class="symbol">Options:</span> </span><br><span class="line"><span class="params">|	[G]et the parameters </span></span><br><span class="line"><span class="params">|</span>	[T]ry the soda </span><br><span class="line"><span class="params">|	[V]erify the signature </span></span><br><span class="line"><span class="params">|</span>	[Q]uit</span><br><span class="line">V</span><br><span class="line"><span class="params">| please send the soda to verify: </span></span><br><span class="line"><span class="params">79559095642922266463148997031064319613325134865931925211002769523336997914218584554135332631438918297442868689016949177146172826664238399782606128281653170770356172139616842694434150846482170779338124730300765599381100281978959304884291887782907002310338483665832672081733896484850235842710260881749486555655</span></span><br><span class="line"><span class="params">|</span> Congrats! your got the <span class="symbol">flag:</span> CCTF&#123;f4cToriZat!On__5Tt4cK_0n_4_5i9na7urE!&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Sparse"><a href="#Sparse" class="headerlink" title="Sparse*"></a>Sparse*</h3><p>分值：114</p>
<p>考点：RSA</p>
<h4 id="challenge-22"><a href="#challenge-22" class="headerlink" title="challenge"></a>challenge</h4><p>RSA is fun, the <a href="https://cr.yp.toc.tf/tasks/sparse_fb29617a2523b12a84488e55fc709afd98717d94.txz" target="_blank" rel="noopener">frozen RSA</a> is even more fun!</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sparse</span><span class="params">(p, k)</span>:</span></span><br><span class="line">	nbit = p.bit_length()</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		CF = [getRandomRange(<span class="number">-1</span>, <span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">'_'</span> * k]</span><br><span class="line">		XP = [getRandomRange(<span class="number">3</span>, nbit - <span class="number">3</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">'_'</span> * k]</span><br><span class="line">		A = sum([CF[_] * <span class="number">2</span> ** XP[_] <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">0</span>, k)])</span><br><span class="line">		q = p + A</span><br><span class="line">		<span class="keyword">if</span> isPrime(q) * A != <span class="number">0</span>:</span><br><span class="line">			<span class="keyword">return</span> q</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">417</span>)</span><br><span class="line">q = sparse(p, <span class="number">5</span>)</span><br><span class="line">e, n = <span class="number">65537</span>, p * q</span><br><span class="line">print(<span class="string">f'n = <span class="subst">&#123;n&#125;</span>'</span>)</span><br><span class="line">m = bytes_to_long(flag.encode(<span class="string">'utf-8'</span>))</span><br><span class="line"><span class="keyword">assert</span> m &lt; n</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">print(<span class="string">f'c = <span class="subst">&#123;c&#125;</span>'</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="number">94144887513744538681657844856583985690903055376400570170371837200724227314957348031684706936655253125445176582486308241015430205703156336248578475428712275706238423997982248462635972817633320331030484841129628650918661036694615254018290264619628335177</span></span><br><span class="line">c = <span class="number">80250313885079761377138486357617323555591919111371649902793873860183455237161293320577683249054725852540874552433031133240624696119120378419135912301004715004977978507247634217071922495893934816945961054193052791946557226599493364850793396744903765857</span></span><br></pre></td></tr></table></figure>

<h4 id="Thought-20"><a href="#Thought-20" class="headerlink" title="Thought"></a>Thought</h4><p>$p,q$ 有小于十个不同的比特。</p>
<p>（由于题目的p,q仅有一个比特不同，所以很容易遍历，但是如果有10个比特不同，很难想象，应该有别的方法）</p>
<h4 id="exp-22"><a href="#exp-22" class="headerlink" title="exp"></a>exp</h4><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number <span class="built_in">import</span> *</span><br><span class="line"><span class="built_in">import</span> gmpy2</span><br><span class="line"><span class="attr">n</span> = <span class="number">94144887513744538681657844856583985690903055376400570170371837200724227314957348031684706936655253125445176582486308241015430205703156336248578475428712275706238423997982248462635972817633320331030484841129628650918661036694615254018290264619628335177</span></span><br><span class="line"><span class="attr">c</span> = <span class="number">80250313885079761377138486357617323555591919111371649902793873860183455237161293320577683249054725852540874552433031133240624696119120378419135912301004715004977978507247634217071922495893934816945961054193052791946557226599493364850793396744903765857</span></span><br><span class="line"><span class="attr">list1=[]</span></span><br><span class="line">for i <span class="keyword">in</span> range(<span class="number">3</span>,<span class="number">417</span>-<span class="number">3</span>):</span><br><span class="line">    list1.append(<span class="number">2</span>**i)</span><br><span class="line">for a <span class="keyword">in</span> list1:</span><br><span class="line">    <span class="attr">A</span> = a</span><br><span class="line">    <span class="attr">z</span> = gmpy2.iroot(A**<span class="number">2</span>+<span class="number">4</span>*n,<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">if</span> z[<span class="number">1</span>]:</span><br><span class="line">        <span class="keyword">if</span> isPrime((A+z[<span class="number">0</span>])//<span class="number">2</span>):</span><br><span class="line">            <span class="attr">p</span> = ((A+z[<span class="number">0</span>])//<span class="number">2</span>)</span><br><span class="line">            <span class="attr">q</span> = n//p</span><br><span class="line">            <span class="attr">e</span> = <span class="number">65537</span></span><br><span class="line">            <span class="attr">d</span> = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">            <span class="attr">m</span> = pow(c,d,n)</span><br><span class="line">            print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<h4 id="result-22"><a href="#result-22" class="headerlink" title="result"></a>result</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">b'CCTF&#123;5pArs3_dIfFeRenc3_f4ct0r1za7iOn_m3th0d!&#125;'</span></span><br></pre></td></tr></table></figure>

<h3 id="Larisa"><a href="#Larisa" class="headerlink" title="Larisa"></a>Larisa</h3><p>分值：174</p>
<p>考点：SymmetricGroup</p>
<h4 id="challenge-23"><a href="#challenge-23" class="headerlink" title="challenge"></a>challenge</h4><p>You think you can understand the way our cryptosystem encrypts messages? Here you can challenge yourself by decrypting this <a href="https://cr.yp.toc.tf/tasks/larisa_685cb550e9e30c70f374aec11548afc6aed2212d.txz" target="_blank" rel="noopener">message</a>!</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genperm</span><span class="params">(n)</span>:</span></span><br><span class="line">	_ = list(range(<span class="number">1</span>, n + <span class="number">1</span>))</span><br><span class="line">	shuffle(_)</span><br><span class="line">	<span class="keyword">return</span> _</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genlatrow</span><span class="params">(n)</span>:</span></span><br><span class="line">	A = []</span><br><span class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> range(n): A.append(genperm(n))</span><br><span class="line">	<span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">prodlat</span><span class="params">(A, B)</span>:</span></span><br><span class="line">	<span class="keyword">assert</span> len(A) == len(B)</span><br><span class="line">	C, G = [], SymmetricGroup(len(A))</span><br><span class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> range(len(A)):</span><br><span class="line">		g = (G(A[_]) * G(B[_])).tuple()</span><br><span class="line">		C.append(list(g))</span><br><span class="line">	<span class="keyword">return</span> C</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">powlat</span><span class="params">(A, n)</span>:</span></span><br><span class="line">	<span class="keyword">assert</span> n &gt;= <span class="number">0</span></span><br><span class="line">	B = bin(n)[<span class="number">2</span>:]</span><br><span class="line">	c, R = len(B), [list(range(<span class="number">1</span>, len(A) + <span class="number">1</span>)) <span class="keyword">for</span> _ <span class="keyword">in</span> range(len(A))]</span><br><span class="line">	<span class="keyword">if</span> n == <span class="number">0</span>: <span class="keyword">return</span> R</span><br><span class="line">	<span class="keyword">else</span>:	</span><br><span class="line">		<span class="keyword">for</span> b <span class="keyword">in</span> B:</span><br><span class="line">			<span class="keyword">if</span> b == <span class="string">'1'</span>:</span><br><span class="line">				<span class="keyword">if</span> c == <span class="number">1</span>: R = prodlat(R, A)</span><br><span class="line">				<span class="keyword">else</span>:</span><br><span class="line">					T = A</span><br><span class="line">					<span class="keyword">for</span> _ <span class="keyword">in</span> range(c - <span class="number">1</span>): T = prodlat(T, T)</span><br><span class="line">					R = prodlat(R, T)</span><br><span class="line">			c -= <span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> R</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pad</span><span class="params">(msg, n)</span>:</span></span><br><span class="line">	<span class="keyword">assert</span> len(msg) &lt;= n</span><br><span class="line">	<span class="keyword">return</span> msg + msg[<span class="number">-1</span>] * (n - len(msg))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">embed</span><span class="params">(msg, n)</span>:</span></span><br><span class="line">	<span class="keyword">assert</span> len(msg) &lt; n</span><br><span class="line">	msg = pad(msg, n)</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		r, s = [randint(<span class="number">2</span>, n) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">'__'</span>]</span><br><span class="line">		<span class="keyword">if</span> gcd(r, len(msg)) == <span class="number">1</span>:</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">	A = []</span><br><span class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> range(n):</span><br><span class="line">		<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">			R = genperm(n)</span><br><span class="line">			<span class="keyword">if</span> R[(_ * r + s) % n] == ord(msg[_]):</span><br><span class="line">				A.append(R)</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(A, e = <span class="number">65537</span>)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> powlat(A, e)</span><br><span class="line"></span><br><span class="line">l, e = <span class="number">128</span>, <span class="number">65537</span></span><br><span class="line">M = embed(flag, l)</span><br><span class="line">C = encrypt(M, e)</span><br><span class="line">print(C)</span><br></pre></td></tr></table></figure>

<h4 id="Thought-21"><a href="#Thought-21" class="headerlink" title="Thought"></a>Thought</h4><p>组了一个多维的SymmetricGroup，然后实现了一下幂运算。用的最经典的那个平方乘方法</p>
<p>并不能把他看作是一个矩阵，，因为做幂次运算的时候，每一行都仅与自己相关，所以在做幂次运算的时候，其实也可以给他拆开来一行一行做</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">def prodlat(A, B):</span><br><span class="line">    assert <span class="built_in">len</span>(A) == <span class="built_in">len</span>(B)</span><br><span class="line">    C, G = [], SymmetricGroup(<span class="built_in">len</span>(A))</span><br><span class="line">    <span class="keyword">for</span> _ in <span class="built_in">range</span>(<span class="built_in">len</span>(A)):</span><br><span class="line">        g = (G(A[_]) * G(B[_])).tuple()</span><br><span class="line">        C.<span class="keyword">append</span>(<span class="keyword">list</span>(g))</span><br><span class="line">    <span class="keyword">return</span> C</span><br></pre></td></tr></table></figure>

<p>加密是$C = M^e$，我们可以拿到阶，计算一下逆元，再乘回来就好了</p>
<h4 id="exp-23"><a href="#exp-23" class="headerlink" title="exp"></a>exp</h4><p><a href="https://remyoudompheng.github.io/ctf/cryptoctf2022/larisa.html" target="_blank" rel="noopener">https://remyoudompheng.github.io/ctf/cryptoctf2022/larisa.html</a></p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">t = [[...]]</span><br><span class="line">embed = []</span><br><span class="line"><span class="keyword">G</span> = SymmetricGroup(128)</span><br><span class="line"><span class="keyword">for</span> perm <span class="keyword">in</span> t:</span><br><span class="line">    <span class="keyword">g</span> = <span class="keyword">G</span>(perm)</span><br><span class="line">    <span class="keyword">order</span> = <span class="keyword">g</span>.<span class="keyword">order</span>()</span><br><span class="line">    <span class="keyword">d</span> = pow(65537, -1, <span class="keyword">order</span>)</span><br><span class="line">    embed.<span class="keyword">append</span>((<span class="keyword">g</span>**<span class="keyword">d</span>).tuple())</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> <span class="keyword">range</span>(1, 128, 2):</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> <span class="keyword">range</span>(128):</span><br><span class="line">        txt = bytes(embed[i][(r * i + s) % 128] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">range</span>(128))</span><br><span class="line">        <span class="keyword">if</span> b<span class="string">"CCTF"</span> <span class="keyword">in</span> txt:</span><br><span class="line">            <span class="keyword">print</span>(txt)</span><br></pre></td></tr></table></figure>

<h4 id="result-23"><a href="#result-23" class="headerlink" title="result"></a>result</h4><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b'the flag: CCTF&#123;pUbliC_k3y_crypt0graphY_u5in9_rOw-l4t!N_5quAr3S!&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;<span class="string">'</span></span><br></pre></td></tr></table></figure>

<h3 id="Shaim"><a href="#Shaim" class="headerlink" title="Shaim"></a>Shaim</h3><p>分值：226</p>
<p>考点：分组哈希</p>
<h4 id="challenge-24"><a href="#challenge-24" class="headerlink" title="challenge"></a>challenge</h4><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Do</span> you believe that every hash <span class="function"><span class="keyword">function</span></span> has weaknesses? <span class="keyword">If</span> yes, can you find <span class="built_in">any</span> collision?</span><br><span class="line"></span><br><span class="line">nc <span class="number">01.</span>cr.yp.toc.tf <span class="number">37113</span></span><br></pre></td></tr></table></figure>

<h4 id="Thought-22"><a href="#Thought-22" class="headerlink" title="Thought"></a>Thought</h4><p>$h1 = msg+length+padding$</p>
<p>$h2 = Sbox(h1)$</p>
<p>$H_0 = h2[0]$</p>
<p>$H_i = E(H_{i-1}) \oplus H_{i-1} \oplus h2_i$</p>
<p>$hash = sha256(H_{-1})$</p>
<p>想要哈希一样的话，我们其实只用管最后一组就好，不过最后一组是length+padding或者纯padding，我们不能随意控制。</p>
<p>换个想法，由于后一组的结果与前一组相关，我们也可以控制前面的值，让其到达后面的值与原值一致即可。</p>
<p>考虑前三组，</p>
<p>$H_0 = h2_0$</p>
<p>$H_1 = E(H_{0}) \oplus H_{0} \oplus h2_1$</p>
<p>$H_2 = E(H_{1}) \oplus H_{1} \oplus h2_2$</p>
<p>我们只要更改 $h2_0,h2_1$ 为 $$h2_0’,h2_1’$$，使得后面的 $H_1’ = H_1$ ，这样后面也就都有 $H_i’ = H_i$ 即可满足条件。</p>
<p>若改为 $h2_0’$，那么 $H_1’ = E(H_0’) \oplus H_0’ \oplus h2_1$</p>
<p>想要让 $H_1’ = H_1$</p>
<p>可以两边同时异或 $H_1’ \oplus H_1$ </p>
<p>则有 $H_1 = E(H_0’) \oplus H_0’ \oplus h2_1 \oplus H_1’ \oplus H_1$</p>
<p>于是我们设 $h2_1’ = h2_1 \oplus H_1’ \oplus H_1$</p>
<p>不过就是说，想要走到 $h2$，还得过一个 $Sbox$，所以我们控制 $h2$ 的话，得先逆一个 $Sbox$ 去控制 $msg$，然后题目很恶心的用了 $utf-8$，就没那么随心所欲了。需要en爆。这里我们每次随机控制 $msg_1$，然后计算 $msg_2$，遇到符合要求的，就传过去。</p>
<h4 id="exp-24"><a href="#exp-24" class="headerlink" title="exp"></a>exp</h4><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">from Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line">from hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> sys, string</span><br><span class="line"></span><br><span class="line">def randstr(l):</span><br><span class="line">	rstr = [(string.printable[:<span class="number">62</span>] + <span class="string">'_'</span>)[getRandomRange(<span class="number">0</span>, <span class="number">62</span>)] <span class="keyword">for</span> _ in range(l)]</span><br><span class="line">	<span class="keyword">return</span> <span class="string">''</span>.<span class="built_in">join</span>(rstr).encode(<span class="string">'utf-8'</span>)</span><br><span class="line"></span><br><span class="line">def shaim(msg):</span><br><span class="line">	SBOX = [</span><br><span class="line">		<span class="number">0xbe</span>, <span class="number">0xc5</span>, <span class="number">0x0f</span>, <span class="number">0x83</span>, <span class="number">0xb2</span>, <span class="number">0x77</span>, <span class="number">0xa8</span>, <span class="number">0x40</span>, <span class="number">0x4c</span>, <span class="number">0x53</span>, <span class="number">0x65</span>, <span class="number">0xd6</span>, <span class="number">0x27</span>, <span class="number">0xa7</span>, <span class="number">0x7c</span>, <span class="number">0x48</span>, </span><br><span class="line">		<span class="number">0x1a</span>, <span class="number">0x60</span>, <span class="number">0x30</span>, <span class="number">0x17</span>, <span class="number">0xf3</span>, <span class="number">0x80</span>, <span class="number">0x04</span>, <span class="number">0x74</span>, <span class="number">0xd2</span>, <span class="number">0x5a</span>, <span class="number">0x2c</span>, <span class="number">0x8e</span>, <span class="number">0xa0</span>, <span class="number">0x32</span>, <span class="number">0x38</span>, <span class="number">0xcb</span>, </span><br><span class="line">		<span class="number">0xe5</span>, <span class="number">0x4d</span>, <span class="number">0x19</span>, <span class="number">0x8f</span>, <span class="number">0xd9</span>, <span class="number">0x6d</span>, <span class="number">0x86</span>, <span class="number">0x58</span>, <span class="number">0xfc</span>, <span class="number">0xfa</span>, <span class="number">0xba</span>, <span class="number">0xdd</span>, <span class="number">0xc7</span>, <span class="number">0x57</span>, <span class="number">0xc1</span>, <span class="number">0x1c</span>, </span><br><span class="line">		<span class="number">0x6a</span>, <span class="number">0x0c</span>, <span class="number">0x7b</span>, <span class="number">0x4b</span>, <span class="number">0xc8</span>, <span class="number">0x52</span>, <span class="number">0x54</span>, <span class="number">0x82</span>, <span class="number">0x47</span>, <span class="number">0x5d</span>, <span class="number">0xc9</span>, <span class="number">0xe8</span>, <span class="number">0x6b</span>, <span class="number">0xdb</span>, <span class="number">0x5e</span>, <span class="number">0x08</span>,</span><br><span class="line">		<span class="number">0xfb</span>, <span class="number">0x8d</span>, <span class="number">0x0e</span>, <span class="number">0x43</span>, <span class="number">0x37</span>, <span class="number">0x39</span>, <span class="number">0x50</span>, <span class="number">0x91</span>, <span class="number">0x7e</span>, <span class="number">0xf4</span>, <span class="number">0xe7</span>, <span class="number">0x35</span>, <span class="number">0xb8</span>, <span class="number">0x88</span>, <span class="number">0x20</span>, <span class="number">0x8b</span>, </span><br><span class="line">		<span class="number">0x90</span>, <span class="number">0xe9</span>, <span class="number">0xee</span>, <span class="number">0xd5</span>, <span class="number">0xd3</span>, <span class="number">0xc3</span>, <span class="number">0xff</span>, <span class="number">0xa9</span>, <span class="number">0xae</span>, <span class="number">0x64</span>, <span class="number">0xf5</span>, <span class="number">0xac</span>, <span class="number">0x11</span>, <span class="number">0x4a</span>, <span class="number">0x76</span>, <span class="number">0x06</span>, </span><br><span class="line">		<span class="number">0x18</span>, <span class="number">0x8a</span>, <span class="number">0xa3</span>, <span class="number">0xec</span>, <span class="number">0x56</span>, <span class="number">0x94</span>, <span class="number">0xdf</span>, <span class="number">0x42</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0xda</span>, <span class="number">0x6c</span>, <span class="number">0xb1</span>, <span class="number">0x12</span>, <span class="number">0xf2</span>, <span class="number">0xfe</span>, </span><br><span class="line">		<span class="number">0xbf</span>, <span class="number">0x21</span>, <span class="number">0x1b</span>, <span class="number">0x4e</span>, <span class="number">0x9f</span>, <span class="number">0x97</span>, <span class="number">0xa6</span>, <span class="number">0x2b</span>, <span class="number">0x0b</span>, <span class="number">0xd4</span>, <span class="number">0x93</span>, <span class="number">0xc6</span>, <span class="number">0x03</span>, <span class="number">0x71</span>, <span class="number">0x14</span>, <span class="number">0x7a</span>, </span><br><span class="line">		<span class="number">0x02</span>, <span class="number">0x0a</span>, <span class="number">0xc4</span>, <span class="number">0xdc</span>, <span class="number">0x36</span>, <span class="number">0x96</span>, <span class="number">0xd0</span>, <span class="number">0x09</span>, <span class="number">0x33</span>, <span class="number">0x26</span>, <span class="number">0xbc</span>, <span class="number">0x1d</span>, <span class="number">0xb6</span>, <span class="number">0xde</span>, <span class="number">0xe6</span>, <span class="number">0xe3</span>, </span><br><span class="line">		<span class="number">0xeb</span>, <span class="number">0x28</span>, <span class="number">0x8c</span>, <span class="number">0x24</span>, <span class="number">0x99</span>, <span class="number">0x3f</span>, <span class="number">0xc0</span>, <span class="number">0x6f</span>, <span class="number">0xa2</span>, <span class="number">0xc2</span>, <span class="number">0xfd</span>, <span class="number">0x3c</span>, <span class="number">0x2d</span>, <span class="number">0x15</span>, <span class="number">0xf6</span>, <span class="number">0xad</span>, </span><br><span class="line">		<span class="number">0x2f</span>, <span class="number">0xbd</span>, <span class="number">0x67</span>, <span class="number">0x05</span>, <span class="number">0x68</span>, <span class="number">0xa1</span>, <span class="number">0x69</span>, <span class="number">0x13</span>, <span class="number">0xca</span>, <span class="number">0x9d</span>, <span class="number">0x3a</span>, <span class="number">0x01</span>, <span class="number">0x63</span>, <span class="number">0xd7</span>, <span class="number">0x75</span>, <span class="number">0x07</span>, </span><br><span class="line">		<span class="number">0x59</span>, <span class="number">0xb9</span>, <span class="number">0x46</span>, <span class="number">0xf8</span>, <span class="number">0xcd</span>, <span class="number">0x5c</span>, <span class="number">0x70</span>, <span class="number">0x95</span>, <span class="number">0xf9</span>, <span class="number">0x16</span>, <span class="number">0x45</span>, <span class="number">0xd1</span>, <span class="number">0x98</span>, <span class="number">0x79</span>, <span class="number">0x9c</span>, <span class="number">0x81</span>, </span><br><span class="line">		<span class="number">0x44</span>, <span class="number">0x62</span>, <span class="number">0x6e</span>, <span class="number">0xb4</span>, <span class="number">0x34</span>, <span class="number">0xce</span>, <span class="number">0x84</span>, <span class="number">0xab</span>, <span class="number">0x29</span>, <span class="number">0x1e</span>, <span class="number">0x2a</span>, <span class="number">0x9b</span>, <span class="number">0xe2</span>, <span class="number">0x25</span>, <span class="number">0xb5</span>, <span class="number">0x87</span>, </span><br><span class="line">		<span class="number">0x23</span>, <span class="number">0x3d</span>, <span class="number">0x5f</span>, <span class="number">0xaa</span>, <span class="number">0xf7</span>, <span class="number">0x9e</span>, <span class="number">0xed</span>, <span class="number">0xb3</span>, <span class="number">0xe1</span>, <span class="number">0x72</span>, <span class="number">0x7d</span>, <span class="number">0x3b</span>, <span class="number">0xb7</span>, <span class="number">0x0d</span>, <span class="number">0x51</span>, <span class="number">0x9a</span>, </span><br><span class="line">		<span class="number">0x4f</span>, <span class="number">0x55</span>, <span class="number">0xf1</span>, <span class="number">0xf0</span>, <span class="number">0xe0</span>, <span class="number">0x31</span>, <span class="number">0x7f</span>, <span class="number">0xbb</span>, <span class="number">0x89</span>, <span class="number">0x5b</span>, <span class="number">0xe4</span>, <span class="number">0x78</span>, <span class="number">0x73</span>, <span class="number">0xef</span>, <span class="number">0xea</span>, <span class="number">0x92</span>, </span><br><span class="line">		<span class="number">0x61</span>, <span class="number">0x41</span>, <span class="number">0x1f</span>, <span class="number">0xcc</span>, <span class="number">0xb0</span>, <span class="number">0x49</span>, <span class="number">0x85</span>, <span class="number">0x3e</span>, <span class="number">0x66</span>, <span class="number">0xaf</span>, <span class="number">0xd8</span>, <span class="number">0x2e</span>, <span class="number">0xa5</span>, <span class="number">0x10</span>, <span class="number">0xa4</span>, <span class="number">0xcf</span></span><br><span class="line">		]</span><br><span class="line">	nbit, hmsg = <span class="number">64</span>, msg.<span class="built_in">hex</span>()</span><br><span class="line">	hmsg += <span class="string">'f'</span> + <span class="built_in">hex</span>(len(msg.<span class="built_in">hex</span>())*<span class="number">4</span>)[<span class="number">2</span>:]</span><br><span class="line">	hmsg += (nbit - (<span class="number">4</span>*len(hmsg) % nbit)) <span class="comment">// 4 * 'f'</span></span><br><span class="line">	H, SBOX_M  = [], <span class="string">''</span></span><br><span class="line">	<span class="keyword">for</span> i in range (<span class="number">0</span>, len(hmsg) - <span class="number">1</span>, <span class="number">2</span>):</span><br><span class="line">		tmp = <span class="built_in">hex</span>(SBOX[<span class="built_in">int</span>(hmsg[i:i+<span class="number">2</span>], <span class="number">16</span>)])[<span class="number">2</span>:]</span><br><span class="line">		tmp = <span class="string">'0'</span> + tmp <span class="keyword">if</span> len(tmp) % <span class="number">2</span> <span class="keyword">else</span> tmp</span><br><span class="line">		SBOX_M += tmp</span><br><span class="line">	hmsg = SBOX_M  </span><br><span class="line">	l = nbit <span class="comment">// 4     </span></span><br><span class="line">	H.<span class="built_in">append</span>((<span class="built_in">int</span>(hmsg[<span class="number">0</span>:l], <span class="number">16</span>)))</span><br><span class="line">	<span class="keyword">for</span> i in range(<span class="number">1</span>, len(hmsg) <span class="comment">// l):</span></span><br><span class="line">		plain = long_to_bytes(<span class="built_in">int</span>(hmsg[i*l:(i+<span class="number">1</span>)*l], <span class="number">16</span>))</span><br><span class="line">		<span class="built_in">key</span> = long_to_bytes(H[i<span class="number">-1</span>])</span><br><span class="line">		_DES = DES.<span class="keyword">new</span>(<span class="built_in">key</span> = <span class="built_in">key</span>, mode = DES.MODE_OFB, IV = <span class="built_in">key</span>)</span><br><span class="line">		H.<span class="built_in">append</span>(bytes_to_long(_DES.encrypt(plain)) ^ bytes_to_long(<span class="built_in">key</span>))</span><br><span class="line">	dgst = sha256(long_to_bytes(H[<span class="number">-1</span>])).hexdigest()</span><br><span class="line">	<span class="keyword">return</span> dgst</span><br><span class="line"></span><br><span class="line">msg = b<span class="string">'ETjrPXxW39mjyXXnU7ODK80xxZJxqpzVJgDIvVuzjk5ftsw1O9pQkYZsRUx1Cp4iSN'</span></span><br><span class="line"><span class="built_in">print</span>(len(msg))</span><br><span class="line">#msg = b<span class="string">'iN0U5jaQAvsPSNBfqXezg4kqjV5d02uFWXS44aqdsvyoYXcK\x98\x9f\x0f\x19\xa8^\xd6\xb4'</span></span><br><span class="line">SBOX = [</span><br><span class="line">	<span class="number">0xbe</span>, <span class="number">0xc5</span>, <span class="number">0x0f</span>, <span class="number">0x83</span>, <span class="number">0xb2</span>, <span class="number">0x77</span>, <span class="number">0xa8</span>, <span class="number">0x40</span>, <span class="number">0x4c</span>, <span class="number">0x53</span>, <span class="number">0x65</span>, <span class="number">0xd6</span>, <span class="number">0x27</span>, <span class="number">0xa7</span>, <span class="number">0x7c</span>, <span class="number">0x48</span>, </span><br><span class="line">	<span class="number">0x1a</span>, <span class="number">0x60</span>, <span class="number">0x30</span>, <span class="number">0x17</span>, <span class="number">0xf3</span>, <span class="number">0x80</span>, <span class="number">0x04</span>, <span class="number">0x74</span>, <span class="number">0xd2</span>, <span class="number">0x5a</span>, <span class="number">0x2c</span>, <span class="number">0x8e</span>, <span class="number">0xa0</span>, <span class="number">0x32</span>, <span class="number">0x38</span>, <span class="number">0xcb</span>, </span><br><span class="line">	<span class="number">0xe5</span>, <span class="number">0x4d</span>, <span class="number">0x19</span>, <span class="number">0x8f</span>, <span class="number">0xd9</span>, <span class="number">0x6d</span>, <span class="number">0x86</span>, <span class="number">0x58</span>, <span class="number">0xfc</span>, <span class="number">0xfa</span>, <span class="number">0xba</span>, <span class="number">0xdd</span>, <span class="number">0xc7</span>, <span class="number">0x57</span>, <span class="number">0xc1</span>, <span class="number">0x1c</span>, </span><br><span class="line">	<span class="number">0x6a</span>, <span class="number">0x0c</span>, <span class="number">0x7b</span>, <span class="number">0x4b</span>, <span class="number">0xc8</span>, <span class="number">0x52</span>, <span class="number">0x54</span>, <span class="number">0x82</span>, <span class="number">0x47</span>, <span class="number">0x5d</span>, <span class="number">0xc9</span>, <span class="number">0xe8</span>, <span class="number">0x6b</span>, <span class="number">0xdb</span>, <span class="number">0x5e</span>, <span class="number">0x08</span>,</span><br><span class="line">	<span class="number">0xfb</span>, <span class="number">0x8d</span>, <span class="number">0x0e</span>, <span class="number">0x43</span>, <span class="number">0x37</span>, <span class="number">0x39</span>, <span class="number">0x50</span>, <span class="number">0x91</span>, <span class="number">0x7e</span>, <span class="number">0xf4</span>, <span class="number">0xe7</span>, <span class="number">0x35</span>, <span class="number">0xb8</span>, <span class="number">0x88</span>, <span class="number">0x20</span>, <span class="number">0x8b</span>, </span><br><span class="line">	<span class="number">0x90</span>, <span class="number">0xe9</span>, <span class="number">0xee</span>, <span class="number">0xd5</span>, <span class="number">0xd3</span>, <span class="number">0xc3</span>, <span class="number">0xff</span>, <span class="number">0xa9</span>, <span class="number">0xae</span>, <span class="number">0x64</span>, <span class="number">0xf5</span>, <span class="number">0xac</span>, <span class="number">0x11</span>, <span class="number">0x4a</span>, <span class="number">0x76</span>, <span class="number">0x06</span>, </span><br><span class="line">	<span class="number">0x18</span>, <span class="number">0x8a</span>, <span class="number">0xa3</span>, <span class="number">0xec</span>, <span class="number">0x56</span>, <span class="number">0x94</span>, <span class="number">0xdf</span>, <span class="number">0x42</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0xda</span>, <span class="number">0x6c</span>, <span class="number">0xb1</span>, <span class="number">0x12</span>, <span class="number">0xf2</span>, <span class="number">0xfe</span>, </span><br><span class="line">	<span class="number">0xbf</span>, <span class="number">0x21</span>, <span class="number">0x1b</span>, <span class="number">0x4e</span>, <span class="number">0x9f</span>, <span class="number">0x97</span>, <span class="number">0xa6</span>, <span class="number">0x2b</span>, <span class="number">0x0b</span>, <span class="number">0xd4</span>, <span class="number">0x93</span>, <span class="number">0xc6</span>, <span class="number">0x03</span>, <span class="number">0x71</span>, <span class="number">0x14</span>, <span class="number">0x7a</span>, </span><br><span class="line">	<span class="number">0x02</span>, <span class="number">0x0a</span>, <span class="number">0xc4</span>, <span class="number">0xdc</span>, <span class="number">0x36</span>, <span class="number">0x96</span>, <span class="number">0xd0</span>, <span class="number">0x09</span>, <span class="number">0x33</span>, <span class="number">0x26</span>, <span class="number">0xbc</span>, <span class="number">0x1d</span>, <span class="number">0xb6</span>, <span class="number">0xde</span>, <span class="number">0xe6</span>, <span class="number">0xe3</span>, </span><br><span class="line">	<span class="number">0xeb</span>, <span class="number">0x28</span>, <span class="number">0x8c</span>, <span class="number">0x24</span>, <span class="number">0x99</span>, <span class="number">0x3f</span>, <span class="number">0xc0</span>, <span class="number">0x6f</span>, <span class="number">0xa2</span>, <span class="number">0xc2</span>, <span class="number">0xfd</span>, <span class="number">0x3c</span>, <span class="number">0x2d</span>, <span class="number">0x15</span>, <span class="number">0xf6</span>, <span class="number">0xad</span>, </span><br><span class="line">	<span class="number">0x2f</span>, <span class="number">0xbd</span>, <span class="number">0x67</span>, <span class="number">0x05</span>, <span class="number">0x68</span>, <span class="number">0xa1</span>, <span class="number">0x69</span>, <span class="number">0x13</span>, <span class="number">0xca</span>, <span class="number">0x9d</span>, <span class="number">0x3a</span>, <span class="number">0x01</span>, <span class="number">0x63</span>, <span class="number">0xd7</span>, <span class="number">0x75</span>, <span class="number">0x07</span>, </span><br><span class="line">	<span class="number">0x59</span>, <span class="number">0xb9</span>, <span class="number">0x46</span>, <span class="number">0xf8</span>, <span class="number">0xcd</span>, <span class="number">0x5c</span>, <span class="number">0x70</span>, <span class="number">0x95</span>, <span class="number">0xf9</span>, <span class="number">0x16</span>, <span class="number">0x45</span>, <span class="number">0xd1</span>, <span class="number">0x98</span>, <span class="number">0x79</span>, <span class="number">0x9c</span>, <span class="number">0x81</span>, </span><br><span class="line">	<span class="number">0x44</span>, <span class="number">0x62</span>, <span class="number">0x6e</span>, <span class="number">0xb4</span>, <span class="number">0x34</span>, <span class="number">0xce</span>, <span class="number">0x84</span>, <span class="number">0xab</span>, <span class="number">0x29</span>, <span class="number">0x1e</span>, <span class="number">0x2a</span>, <span class="number">0x9b</span>, <span class="number">0xe2</span>, <span class="number">0x25</span>, <span class="number">0xb5</span>, <span class="number">0x87</span>, </span><br><span class="line">	<span class="number">0x23</span>, <span class="number">0x3d</span>, <span class="number">0x5f</span>, <span class="number">0xaa</span>, <span class="number">0xf7</span>, <span class="number">0x9e</span>, <span class="number">0xed</span>, <span class="number">0xb3</span>, <span class="number">0xe1</span>, <span class="number">0x72</span>, <span class="number">0x7d</span>, <span class="number">0x3b</span>, <span class="number">0xb7</span>, <span class="number">0x0d</span>, <span class="number">0x51</span>, <span class="number">0x9a</span>, </span><br><span class="line">	<span class="number">0x4f</span>, <span class="number">0x55</span>, <span class="number">0xf1</span>, <span class="number">0xf0</span>, <span class="number">0xe0</span>, <span class="number">0x31</span>, <span class="number">0x7f</span>, <span class="number">0xbb</span>, <span class="number">0x89</span>, <span class="number">0x5b</span>, <span class="number">0xe4</span>, <span class="number">0x78</span>, <span class="number">0x73</span>, <span class="number">0xef</span>, <span class="number">0xea</span>, <span class="number">0x92</span>, </span><br><span class="line">	<span class="number">0x61</span>, <span class="number">0x41</span>, <span class="number">0x1f</span>, <span class="number">0xcc</span>, <span class="number">0xb0</span>, <span class="number">0x49</span>, <span class="number">0x85</span>, <span class="number">0x3e</span>, <span class="number">0x66</span>, <span class="number">0xaf</span>, <span class="number">0xd8</span>, <span class="number">0x2e</span>, <span class="number">0xa5</span>, <span class="number">0x10</span>, <span class="number">0xa4</span>, <span class="number">0xcf</span></span><br><span class="line">	]</span><br><span class="line">nbit, hmsg = <span class="number">64</span>, msg.<span class="built_in">hex</span>()</span><br><span class="line">#<span class="built_in">print</span>(hmsg)</span><br><span class="line">hmsg += <span class="string">'f'</span> + <span class="built_in">hex</span>(len(msg.<span class="built_in">hex</span>())*<span class="number">4</span>)[<span class="number">2</span>:]</span><br><span class="line">#<span class="built_in">print</span>(hmsg)</span><br><span class="line">hmsg += (nbit - (<span class="number">4</span>*len(hmsg) % nbit)) <span class="comment">// 4 * 'f'</span></span><br><span class="line"><span class="built_in">print</span>(hmsg)</span><br><span class="line">H, SBOX_M  = [], <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i in range (<span class="number">0</span>, len(hmsg) - <span class="number">1</span>, <span class="number">2</span>):</span><br><span class="line">	tmp = <span class="built_in">hex</span>(SBOX[<span class="built_in">int</span>(hmsg[i:i+<span class="number">2</span>], <span class="number">16</span>)])[<span class="number">2</span>:].rjust(<span class="number">2</span>,<span class="string">'0'</span>)</span><br><span class="line">	#tmp = <span class="string">'0'</span> + tmp <span class="keyword">if</span> len(tmp) % <span class="number">2</span> <span class="keyword">else</span> tmp</span><br><span class="line">	SBOX_M += tmp</span><br><span class="line">hmsg = SBOX_M  </span><br><span class="line"><span class="built_in">print</span>(hmsg)</span><br><span class="line">l = nbit <span class="comment">// 4    </span></span><br><span class="line">H.<span class="built_in">append</span>((<span class="built_in">int</span>(hmsg[<span class="number">0</span>:l], <span class="number">16</span>)))</span><br><span class="line"></span><br><span class="line">#<span class="built_in">print</span>(<span class="built_in">hex</span>(H[<span class="number">0</span>]))</span><br><span class="line"><span class="keyword">for</span> i in range(<span class="number">1</span>, len(hmsg) <span class="comment">// l):</span></span><br><span class="line">	plain = long_to_bytes(<span class="built_in">int</span>(hmsg[i*l:(i+<span class="number">1</span>)*l], <span class="number">16</span>))</span><br><span class="line">	<span class="built_in">key</span> = long_to_bytes(H[i<span class="number">-1</span>])</span><br><span class="line">	_DES = DES.<span class="keyword">new</span>(<span class="built_in">key</span> = <span class="built_in">key</span>, mode = DES.MODE_OFB, IV = <span class="built_in">key</span>)</span><br><span class="line">	H.<span class="built_in">append</span>(bytes_to_long(_DES.encrypt(plain)) ^ bytes_to_long(<span class="built_in">key</span>))</span><br><span class="line"></span><br><span class="line">dgst = sha256(long_to_bytes(H[<span class="number">-1</span>])).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'dgst'</span>,dgst)</span><br><span class="line"></span><br><span class="line">def check(msg):</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		msg = msg.decode()</span><br><span class="line">	except:</span><br><span class="line">		<span class="keyword">return</span> False</span><br><span class="line">	<span class="keyword">for</span> each in msg:</span><br><span class="line">		<span class="keyword">if</span> each not in string.printable[:<span class="number">62</span>]:</span><br><span class="line">			<span class="keyword">return</span> False</span><br><span class="line">	<span class="keyword">return</span> True</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ in range(<span class="number">1000000</span>):</span><br><span class="line">	H1 = H[<span class="number">1</span>]</span><br><span class="line">	h21 = (<span class="built_in">int</span>(hmsg[<span class="number">1</span>*l:(<span class="number">1</span>+<span class="number">1</span>)*l], <span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	#<span class="keyword">for</span> _ in range(<span class="number">100</span>):</span><br><span class="line">	msgf = randstr(<span class="number">8</span>)+msg[<span class="number">8</span>:<span class="number">16</span>]</span><br><span class="line">	hmsgf = msgf.<span class="built_in">hex</span>()</span><br><span class="line">	Hf, SBOX_Mf  = [], <span class="string">''</span></span><br><span class="line">	<span class="keyword">for</span> i in range (<span class="number">0</span>, len(hmsgf) - <span class="number">1</span>, <span class="number">2</span>):</span><br><span class="line">		tmp = <span class="built_in">hex</span>(SBOX[<span class="built_in">int</span>(hmsgf[i:i+<span class="number">2</span>], <span class="number">16</span>)])[<span class="number">2</span>:].rjust(<span class="number">2</span>,<span class="string">'0'</span>)</span><br><span class="line">		#tmp = <span class="string">'0'</span> + tmp <span class="keyword">if</span> len(tmp) % <span class="number">2</span> <span class="keyword">else</span> tmp</span><br><span class="line">		SBOX_Mf += tmp</span><br><span class="line">	hmsgf = SBOX_Mf  </span><br><span class="line">	#<span class="built_in">print</span>(hmsgf)</span><br><span class="line">	l = nbit <span class="comment">// 4    </span></span><br><span class="line">	Hf.<span class="built_in">append</span>((<span class="built_in">int</span>(hmsgf[<span class="number">0</span>:l], <span class="number">16</span>)))</span><br><span class="line"></span><br><span class="line">	#<span class="built_in">print</span>(<span class="built_in">hex</span>(H[<span class="number">0</span>]))</span><br><span class="line">	<span class="keyword">for</span> i in range(<span class="number">1</span>, len(hmsgf) <span class="comment">// l):</span></span><br><span class="line">		plain = long_to_bytes(<span class="built_in">int</span>(hmsgf[i*l:(i+<span class="number">1</span>)*l], <span class="number">16</span>))</span><br><span class="line">		#<span class="built_in">print</span>(hmsg[i*l:(i+<span class="number">1</span>)*l])</span><br><span class="line">		<span class="built_in">key</span> = long_to_bytes(Hf[i<span class="number">-1</span>],<span class="number">8</span>)</span><br><span class="line">		_DES = DES.<span class="keyword">new</span>(<span class="built_in">key</span> = <span class="built_in">key</span>, mode = DES.MODE_OFB, IV = <span class="built_in">key</span>)</span><br><span class="line">		Hf.<span class="built_in">append</span>(bytes_to_long(_DES.encrypt(plain)) ^ bytes_to_long(<span class="built_in">key</span>))</span><br><span class="line"></span><br><span class="line">	H1_ = Hf[<span class="number">1</span>]</span><br><span class="line">	h21 = h21 ^ H1_ ^ H1</span><br><span class="line"></span><br><span class="line">	h21 = <span class="built_in">hex</span>(h21)[<span class="number">2</span>:].rjust(<span class="number">16</span>,<span class="string">'0'</span>)</span><br><span class="line"></span><br><span class="line">	tmp21=<span class="string">''</span></span><br><span class="line">	<span class="keyword">for</span> i in range(<span class="number">0</span>,len(h21),<span class="number">2</span>):</span><br><span class="line">		tmp21 += <span class="built_in">hex</span>(SBOX.index(<span class="built_in">int</span>(h21[i:i+<span class="number">2</span>], <span class="number">16</span>)))[<span class="number">2</span>:].rjust(<span class="number">2</span>,<span class="string">'0'</span>)</span><br><span class="line">	#<span class="built_in">print</span>(tmp21)</span><br><span class="line">	#<span class="built_in">print</span>(bytes.fromhex(tmp21))</span><br><span class="line">	target = bytes.fromhex(tmp21)</span><br><span class="line">	<span class="keyword">if</span> check(target):</span><br><span class="line">		msg = msgf[:<span class="number">8</span>]+target+msg[<span class="number">16</span>:]</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">"[+]"</span>,msg)</span><br><span class="line">		<span class="built_in">exit</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">66</span></span><br><span class="line"><span class="number">45546</span>a725058785733396d6a7958586e55374f444b383078785a4a7871707a564a6744497656757a6a6b3566747377314f3970516b595a735255783143703469534ef210ffffffff</span><br><span class="line"><span class="number">39</span>d3da1b90ae0ba94b5d12dad4aeaef2c3828b3735476a0b0bf5e70b21bf93ffe74237f4a6ff9793da6c52df9f4e2b0c8b5dbfe96c64f54eeec30b0c43bfc822d5201f1acfcfcfcf</span><br><span class="line">dgst <span class="number">296</span>f717f86e45b5abba7af44cc95e217dbfc439d8b9006e8541ee5b7b844360f</span><br><span class="line">[+] b<span class="string">'kikPuOwPDsz5spcJU7ODK80xxZJxqpzVJgDIvVuzjk5ftsw1O9pQkYZsRUx1Cp4iSN'</span></span><br></pre></td></tr></table></figure>

<h4 id="result-24"><a href="#result-24" class="headerlink" title="result"></a>result</h4><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-<span class="number">0</span>-<span class="number">7</span>-centos ~]<span class="comment"># nc 01.cr.yp.toc.tf 37113</span></span><br><span class="line"><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span></span><br><span class="line"><span class="params">|  Hey hash breakers! Try to find the collision <span class="keyword">for</span> given message <span class="keyword">and</span>  |</span></span><br><span class="line"><span class="params">|  get the flag! You have only one chance to get it <span class="keyword">in</span> each round! :P  |</span></span><br><span class="line"><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span><span class="params">||</span></span><br><span class="line"><span class="params">| Options: </span></span><br><span class="line"><span class="params">|</span>	[G]et the message with hash </span><br><span class="line"><span class="params">|	[S]<span class="keyword">end</span> collision </span></span><br><span class="line"><span class="params">|</span>	[Q]uit</span><br><span class="line">G</span><br><span class="line"><span class="params">| msg = b'ETjrPXxW39mjyXXnU7ODK80xxZJxqpzVJgDIvVuzjk5ftsw1O9pQkYZsRUx1Cp4iSN'</span></span><br><span class="line"><span class="params">|</span> shaim(msg) = <span class="number">296</span>f717f86e45b5abba7af44cc95e217dbfc439d8b9006e8541ee5b7b844360f</span><br><span class="line"><span class="params">| Options: </span></span><br><span class="line"><span class="params">|</span>	[G]et the message with hash </span><br><span class="line"><span class="params">|	[S]<span class="keyword">end</span> collision </span></span><br><span class="line"><span class="params">|</span>	[Q]uit</span><br><span class="line">s</span><br><span class="line"><span class="params">| please send message with same hash: </span></span><br><span class="line"><span class="params">WQ4J2kGsPSIjxfY8U7ODK80xxZJxqpzVJgDIvVuzjk5ftsw1O9pQkYZsRUx1Cp4iSN</span></span><br><span class="line"><span class="params">|</span> Congrats, you got the <span class="symbol">flag:</span> CCTF&#123;A9aiN____DES____N0T_w3AkNEs5!!&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Lagima"><a href="#Lagima" class="headerlink" title="Lagima"></a>Lagima</h3><p>分值：164</p>
<p>考点：SymmetricGroup</p>
<h4 id="challenge-25"><a href="#challenge-25" class="headerlink" title="challenge"></a>challenge</h4><p>You are in the road to learn some interesting cryptosystems, decrypt our <a href="https://cr.yp.toc.tf/tasks/lagima_8db674d97463b80a80919f35aa51ce4c1039d028.txz" target="_blank" rel="noopener">cipher</a>!</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genperm</span><span class="params">(n)</span>:</span></span><br><span class="line">	_ = list(range(<span class="number">1</span>, n + <span class="number">1</span>))</span><br><span class="line">	shuffle(_)</span><br><span class="line">	<span class="keyword">return</span> _</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genlatrow</span><span class="params">(n)</span>:</span></span><br><span class="line">	A = []</span><br><span class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> range(n): A.append(genperm(n))</span><br><span class="line">	<span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">prodlat</span><span class="params">(A, B)</span>:</span></span><br><span class="line">	<span class="keyword">assert</span> len(A) == len(B)</span><br><span class="line">	C, G = [], SymmetricGroup(len(A))</span><br><span class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> range(len(A)):</span><br><span class="line">		g = (G(A[_]) * G(B[_])).tuple()</span><br><span class="line">		C.append(list(g))</span><br><span class="line">	<span class="keyword">return</span> C</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">powlat</span><span class="params">(A, n)</span>:</span></span><br><span class="line">	<span class="keyword">assert</span> n &gt;= <span class="number">0</span></span><br><span class="line">	B = bin(n)[<span class="number">2</span>:]</span><br><span class="line">	c, R = len(B), [list(range(<span class="number">1</span>, len(A) + <span class="number">1</span>)) <span class="keyword">for</span> _ <span class="keyword">in</span> range(len(A))]</span><br><span class="line">	<span class="keyword">if</span> n == <span class="number">0</span>: <span class="keyword">return</span> R</span><br><span class="line">	<span class="keyword">else</span>:	</span><br><span class="line">		<span class="keyword">for</span> b <span class="keyword">in</span> B:</span><br><span class="line">			<span class="keyword">if</span> b == <span class="string">'1'</span>:</span><br><span class="line">				<span class="keyword">if</span> c == <span class="number">1</span>: R = prodlat(R, A)</span><br><span class="line">				<span class="keyword">else</span>:</span><br><span class="line">					T = A</span><br><span class="line">					<span class="keyword">for</span> _ <span class="keyword">in</span> range(c - <span class="number">1</span>): T = prodlat(T, T)</span><br><span class="line">					R = prodlat(R, T)</span><br><span class="line">			c -= <span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> R</span><br><span class="line"></span><br><span class="line">G = genlatrow(<span class="number">313</span>)</span><br><span class="line">secret = int.from_bytes(flag.lstrip(<span class="string">b'CCTF&#123;'</span>).rstrip(<span class="string">b'&#125;'</span>), <span class="string">'big'</span>)</span><br><span class="line">H = powlat(G, secret)</span><br><span class="line"></span><br><span class="line">print(<span class="string">f'G = <span class="subst">&#123;G&#125;</span>'</span>)</span><br><span class="line">print(<span class="string">f'H = <span class="subst">&#123;H&#125;</span>'</span>)</span><br></pre></td></tr></table></figure>

<p>前面那个求底数，现在这个求指数了。</p>
<h4 id="Thought-23"><a href="#Thought-23" class="headerlink" title="Thought"></a>Thought</h4><p>对称群的一个数学性质，之前也不知道，看题解发现的</p>
<h4 id="exp-25"><a href="#exp-25" class="headerlink" title="exp"></a>exp</h4><p><a href="https://remyoudompheng.github.io/ctf/cryptoctf2022/lagima.html" target="_blank" rel="noopener">https://remyoudompheng.github.io/ctf/cryptoctf2022/lagima.html</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line">from sage.all <span class="keyword">import</span> SymmetricGroup, CRT</span><br><span class="line"></span><br><span class="line">with <span class="keyword">open</span>(<span class="string">"output.txt"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    lG = next(f)</span><br><span class="line">    <span class="type">G</span> = json.loads(lG.<span class="built_in">split</span>(<span class="string">"="</span>)[-<span class="number">1</span>])</span><br><span class="line">    lH = next(f)</span><br><span class="line">    <span class="type">H</span> = json.loads(lH.<span class="built_in">split</span>(<span class="string">"="</span>)[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="type">Sn</span> = <span class="type">SymmetricGroup</span>(<span class="number">313</span>)</span><br><span class="line">g = [<span class="type">Sn</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="type">G</span>]</span><br><span class="line">h = [<span class="type">Sn</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="type">H</span>]</span><br><span class="line"></span><br><span class="line">rems = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i, gi <span class="keyword">in</span> <span class="built_in">enumerate</span>(g):</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">c</span> <span class="keyword">in</span> gi.cycle_tuples():</span><br><span class="line">        l = len(<span class="built_in">c</span>)</span><br><span class="line">        k = <span class="built_in">c</span>.index(h[i](<span class="built_in">c</span>[<span class="number">0</span>]))</span><br><span class="line">        <span class="keyword">if</span> l <span class="keyword">in</span> rems:</span><br><span class="line">            <span class="built_in">assert</span> rems[l] == k</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            rems[l] = k</span><br><span class="line"><span class="built_in">c</span> = <span class="type">CRT</span>(list(rems.values()), list(rems.keys()))</span><br><span class="line"><span class="built_in">print</span>(int(<span class="built_in">c</span>).to_bytes(<span class="number">64</span>, <span class="string">"big"</span>).lstrip(b'\<span class="number">0</span>'))</span><br></pre></td></tr></table></figure>

<h4 id="result-25"><a href="#result-25" class="headerlink" title="result"></a>result</h4><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b'3lGam4L_eNcR!p710n_4nD_L4T!n_5QuarS3!<span class="string">'</span></span><br></pre></td></tr></table></figure>

<h3 id="Versace"><a href="#Versace" class="headerlink" title="Versace"></a>Versace</h3><p>分值：226</p>
<p>考点：大整数分解</p>
<h4 id="challenge-26"><a href="#challenge-26" class="headerlink" title="challenge"></a>challenge</h4><p>What is most important when we have prime numbers? Answer and decrypt the <a href="https://cr.yp.toc.tf/tasks/versace_a271dc523266ce3351aef5bf205617f30a2c3f33.txz" target="_blank" rel="noopener">message</a>!</p>
<p><strong>Note:</strong> The output file has changed, Please download again!</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># In the name of Allah</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">keygen</span><span class="params">(n)</span>:</span></span><br><span class="line">	e = <span class="number">65537</span></span><br><span class="line">	x, y = [getRandomRange(<span class="number">2</span>, n - <span class="number">2</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">'01'</span>]</span><br><span class="line">	fi = pow(<span class="number">5</span>, x, n)</span><br><span class="line">	th = pow(<span class="number">13</span>, y, n)</span><br><span class="line">	<span class="keyword">return</span> (n, e, fi, th)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(m, pubkey)</span>:</span></span><br><span class="line">	n, e, fi, th = pubkey</span><br><span class="line">	k, u, v = [getRandomRange(<span class="number">2</span>, n - <span class="number">2</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">'012'</span>]</span><br><span class="line">	c_1 = pow(k, e, n)</span><br><span class="line">	c_2 = pow(<span class="number">5</span>, u, n)</span><br><span class="line">	c_3 = pow(<span class="number">13</span>, v, n)</span><br><span class="line">	c_4 = pow(fi, u, n) * pow(th, v, n) * pow(k + <span class="number">1</span>, e, n) * m % n</span><br><span class="line">	<span class="keyword">return</span> c_1, c_2, c_3, c_4</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">141886649864474336567180245736091175577519141092893110664440298696325928109107819365023509727482657156444454196974621121317731892910779276975799862237645015028934626195549529415068518701179353407407170273107294065819774663163018151369555922179926003735413019069305586784817562889650637936781439564028325920769</span></span><br><span class="line">pubkey = keygen(n)</span><br><span class="line">msg = bytes_to_long(flag.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">enc = encrypt(msg, pubkey)</span><br><span class="line"></span><br><span class="line">print(<span class="string">f'pubkey = <span class="subst">&#123;pubkey&#125;</span>'</span>)</span><br><span class="line">print(<span class="string">f'enc = <span class="subst">&#123;enc&#125;</span>'</span>)</span><br><span class="line"></span><br><span class="line">pubkey = (<span class="number">141886649864474336567180245736091175577519141092893110664440298696325928109107819365023509727482657156444454196974621121317731892910779276975799862237645015028934626195549529415068518701179353407407170273107294065819774663163018151369555922179926003735413019069305586784817562889650637936781439564028325920769</span>, <span class="number">65537</span>, <span class="number">125494383162828289973475117066203219587304356806057400173045477137700391356840397636206107925460433939119412469184723408274805651096828270461235114589209044543108910295997506041345432448035371092981112305692014036117962906342882215492784319467728201344342591126197621795974549431806828947671232171059809967991</span>, <span class="number">138257736445723754207239869344459794807808248188757696052272858978544083465381926995900887162870612185045399616892685750962667762789508194359878372465943702647287813020223160406789982302692329883577043521781397505345137392777694159916452699296748509096494301465498192136911589776144421856343483031920756519249</span>)</span><br><span class="line">enc = (<span class="number">88920444409754899592335110119456825172544580816901497880270628553955508488170483498726344301421934007876515783471747430111559265733377611608113080609941423596790625452564403457107243481310552344096683637970851198148957553062631972064855184560312748315536290880767375156429548232884895308088306625307674645678</span>, <span class="number">45539956581550314230977168288877082058214432324397034618326297663129864608739856352261029083496409133620455599376139981575342903237304167908534019438874239934645347320209162850653298515960349717851268830205737252263548268549179642907155075129172651815656517165432021020317138111104384072600486843574535899860</span>, <span class="number">69849817078368866947686316374564245958824276178721440086311727765763093314086243149277327430285562537315291446874425715021031882041090977200029684675392021083309757246079110723453995717856469919242618068208424495615283285085190255592463862108516827540775850882615540406750734639040903336048095547788528187976</span>, <span class="number">20285007564778647051596518902857046010716548094264173639037549746086538656814534621919993169453446815272789643882592631536755194356753848872566348635207131520597253599540337542405837637606323276917410384296602682043902830628022440639028040137219164743287397377174047728489836106561656239657061612908104843401</span>)</span><br></pre></td></tr></table></figure>

<h4 id="Thought-24"><a href="#Thought-24" class="headerlink" title="Thought"></a>Thought</h4><p>想要解密肯定是要先算出 $fi^u \cdot th^v \cdot (k+1)^e$</p>
<p>题目给出了 $n,e,fi,th,k^e,5^u,13^v$</p>
<p>那么我们需要解出 $k,u,v$</p>
<p>其中 $k$ 要大整数分解</p>
<p>$u,v$ 要解离散对数</p>
<p>只要能够分解这个 $n$ 就好了。</p>
<p>发现使用 Williams p+1 可以给这 $n$ 秒分了，</p>
<p>然后 $p-1 = 2^{18} \cdot 3^{30} \cdot 7^{53} \cdot 11^{12}$，好解离散对数</p>
<p>但是另一半似乎有点难搞，</p>
<p>chao，多运行几次，会发现结果不一样，原来有三个因子，都是这样子的形式。</p>
<p>分解之后分别在 $p,q,r$ 求离散对数，求 $m$，最后给 $m$ 走一个 crt 就好了。</p>
<h4 id="exp-26"><a href="#exp-26" class="headerlink" title="exp"></a>exp</h4><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">from gmpy2 import iroot,gcd</span><br><span class="line">from tqdm import tqdm</span><br><span class="line">import random</span><br><span class="line">from math import log</span><br><span class="line">prime = [<span class="number">2,3,5,7</span>,<span class="number">11,13,17,19</span>,<span class="number">23,29,31,37</span>,<span class="number">41,43,47,53</span>,<span class="number">59,61,67,71</span>,<span class="number">73,79,83,89</span>,<span class="number">97,101,103,107</span>,<span class="number">109,113,127,131</span>,<span class="number">137,139,149,151</span>,<span class="number">157,163,167,173</span>,<span class="number">179,181,191,193</span>,<span class="number">197,199,211,223</span>,<span class="number">227,229,233,239</span>,<span class="number">241,251,257</span>,<span class="number">263,269</span>,<span class="number">271,277</span>,<span class="number">281,283</span>,<span class="number">293,307</span>,<span class="number">311,313</span>,<span class="number">317,331</span>,<span class="number">337,347</span>,<span class="number">349,353</span>,<span class="number">359,367</span>,<span class="number">373,379</span>,<span class="number">383,389</span>,<span class="number">397,401</span>,<span class="number">409,419</span>,<span class="number">421,431</span>,<span class="number">433,439</span>,<span class="number">443,449</span>,<span class="number">457,461</span>,<span class="number">463,467</span>,<span class="number">479,487</span>,<span class="number">491,499</span>,<span class="number">503,509</span>,<span class="number">521,523</span>,<span class="number">541,547</span>,<span class="number">557,563</span>,<span class="number">569,571</span>,<span class="number">577,587</span>,<span class="number">593,599</span>,<span class="number">601,607</span>,<span class="number">613,617</span>,<span class="number">619,631</span>,<span class="number">641,643</span>,<span class="number">647,653</span>,<span class="number">659,661</span>,<span class="number">673,677</span>,<span class="number">683,691</span>,<span class="number">701,709</span>,<span class="number">719,727</span>,<span class="number">733,739</span>,<span class="number">743,751</span>,<span class="number">757,761</span>,<span class="number">769,773</span>,<span class="number">787,797</span>,<span class="number">809,811</span>,<span class="number">821,823</span>,<span class="number">827,829</span>,<span class="number">839,853</span>,<span class="number">857,859</span>,<span class="number">863,877</span>,<span class="number">881,883</span>,<span class="number">887,907</span>,<span class="number">911,919</span>,<span class="number">929,937</span>,<span class="number">941,947</span>,<span class="number">953,967</span>,<span class="number">971,977</span>,<span class="number">983,991</span>,<span class="number">997</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def Lucas_pow(P, R):</span><br><span class="line">	<span class="keyword">A</span>, B = P, <span class="number">2</span></span><br><span class="line">	R = bin(R)[<span class="number">3</span>:]</span><br><span class="line">	for i in R:</span><br><span class="line">		if int(i) == <span class="number">1</span>:</span><br><span class="line">			<span class="keyword">A</span>, B = (P * <span class="keyword">A</span>**<span class="number">2</span> - <span class="keyword">A</span> * B - P) % n, (<span class="keyword">A</span>**<span class="number">2</span> - <span class="number">2</span>) % n</span><br><span class="line">		else:</span><br><span class="line">			<span class="keyword">A</span>, B = (<span class="keyword">A</span>**<span class="number">2</span> - <span class="number">2</span>) % n, (<span class="keyword">A</span> * B - P) % n</span><br><span class="line">	return gcd(<span class="keyword">A</span> - <span class="number">2</span>, n)</span><br><span class="line"></span><br><span class="line">def Williams_p_1(n):</span><br><span class="line">	print("[+]Trying William's p+<span class="number">1</span>...\n")</span><br><span class="line">	R = <span class="number">1</span></span><br><span class="line">	B = int(iroot(n, <span class="number">2</span>)[<span class="number">0</span>])</span><br><span class="line">	B = log(B)</span><br><span class="line">	for pi in prime:</span><br><span class="line">		for i in range(int(B/log(pi))):</span><br><span class="line">			R *= pi</span><br><span class="line">	while True:</span><br><span class="line">		P = random.randint(<span class="number">2</span>, int(B))</span><br><span class="line">		p = Lucas_pow(P, R)</span><br><span class="line">		if p &gt; <span class="number">1</span> and p &lt; n:</span><br><span class="line">			q = n // p</span><br><span class="line">			print("p: ", p)</span><br><span class="line">			print("q: ", q)</span><br><span class="line">			return p,q</span><br><span class="line"></span><br><span class="line">n = <span class="number">141886649864474336567180245736091175577519141092893110664440298696325928109107819365023509727482657156444454196974621121317731892910779276975799862237645015028934626195549529415068518701179353407407170273107294065819774663163018151369555922179926003735413019069305586784817562889650637936781439564028325920769</span></span><br><span class="line"></span><br><span class="line"># run this function servral times we get</span><br><span class="line">Williams_p_1(n)</span><br><span class="line"># q = <span class="number">104492689192892408108975038373966852967734827395344990285038653889732962680833</span></span><br><span class="line"># p = <span class="number">12735676857401163601385118447483795668229644118624917660231942016044435957817541173149617917604011645058841872384142319678290750015804888147769138207522817</span></span><br><span class="line"># r = <span class="number">106618752612001652530923691512073519044983443846656721126867402977583225110529</span></span><br><span class="line"></span><br><span class="line"># sage</span><br><span class="line">pubkey = (<span class="number">141886649864474336567180245736091175577519141092893110664440298696325928109107819365023509727482657156444454196974621121317731892910779276975799862237645015028934626195549529415068518701179353407407170273107294065819774663163018151369555922179926003735413019069305586784817562889650637936781439564028325920769</span>, <span class="number">65537</span>, <span class="number">125494383162828289973475117066203219587304356806057400173045477137700391356840397636206107925460433939119412469184723408274805651096828270461235114589209044543108910295997506041345432448035371092981112305692014036117962906342882215492784319467728201344342591126197621795974549431806828947671232171059809967991</span>, <span class="number">138257736445723754207239869344459794807808248188757696052272858978544083465381926995900887162870612185045399616892685750962667762789508194359878372465943702647287813020223160406789982302692329883577043521781397505345137392777694159916452699296748509096494301465498192136911589776144421856343483031920756519249</span>)</span><br><span class="line">enc = (<span class="number">88920444409754899592335110119456825172544580816901497880270628553955508488170483498726344301421934007876515783471747430111559265733377611608113080609941423596790625452564403457107243481310552344096683637970851198148957553062631972064855184560312748315536290880767375156429548232884895308088306625307674645678</span>, <span class="number">45539956581550314230977168288877082058214432324397034618326297663129864608739856352261029083496409133620455599376139981575342903237304167908534019438874239934645347320209162850653298515960349717851268830205737252263548268549179642907155075129172651815656517165432021020317138111104384072600486843574535899860</span>, <span class="number">69849817078368866947686316374564245958824276178721440086311727765763093314086243149277327430285562537315291446874425715021031882041090977200029684675392021083309757246079110723453995717856469919242618068208424495615283285085190255592463862108516827540775850882615540406750734639040903336048095547788528187976</span>, <span class="number">20285007564778647051596518902857046010716548094264173639037549746086538656814534621919993169453446815272789643882592631536755194356753848872566348635207131520597253599540337542405837637606323276917410384296602682043902830628022440639028040137219164743287397377174047728489836106561656239657061612908104843401</span>)</span><br><span class="line"></span><br><span class="line">n, e, fi, th = pubkey</span><br><span class="line">c_1, c_2, c_3, c_4 = enc</span><br><span class="line">q = <span class="number">104492689192892408108975038373966852967734827395344990285038653889732962680833</span></span><br><span class="line">p = <span class="number">12735676857401163601385118447483795668229644118624917660231942016044435957817541173149617917604011645058841872384142319678290750015804888147769138207522817</span></span><br><span class="line">r = <span class="number">106618752612001652530923691512073519044983443846656721126867402977583225110529</span></span><br><span class="line"></span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">k = pow(c_1,d,n)</span><br><span class="line">up = discrete_log(Mod(c_2,p),Mod(<span class="number">5</span>,p))</span><br><span class="line">uq = discrete_log(Mod(c_2,q),Mod(<span class="number">5</span>,q))</span><br><span class="line">ur = discrete_log(Mod(c_2,r),Mod(<span class="number">5</span>,r))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">vp = discrete_log(Mod(c_3,p),Mod(<span class="number">13</span>,p))</span><br><span class="line">vq = discrete_log(Mod(c_3,q),Mod(<span class="number">13</span>,q))</span><br><span class="line">vr = discrete_log(Mod(c_3,r),Mod(<span class="number">13</span>,r))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fxxkp = pow(fi, up, p) * pow(th, vp, p) * pow(k + <span class="number">1</span>, e, p) % p</span><br><span class="line">fxxkq = pow(fi, uq, q) * pow(th, vq, q) * pow(k + <span class="number">1</span>, e, q) % q</span><br><span class="line">fxxkr = pow(fi, ur, r) * pow(th, vr, r) * pow(k + <span class="number">1</span>, e, r) % r</span><br><span class="line">mp = c_4 * inverse(int(fxxkp),int(p)) % p</span><br><span class="line">mq = c_4 * inverse(int(fxxkq),int(q)) % q</span><br><span class="line">mr = c_4 * inverse(int(fxxkr),int(r)) % r</span><br><span class="line">print(long_to_bytes(crt([mp,mq,mr],[p,q,r])))</span><br></pre></td></tr></table></figure>

<h4 id="result-26"><a href="#result-26" class="headerlink" title="result"></a>result</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">b'CCTF&#123;8As3d_oN_f4c70r1n9_4nD_d15cr3tE_lOgaRiThM!&#125;'</span></span><br></pre></td></tr></table></figure>

<h2 id="hard"><a href="#hard" class="headerlink" title="hard"></a>hard</h2><h3 id="GSDP"><a href="#GSDP" class="headerlink" title="GSDP"></a>GSDP</h3><p>分值：164</p>
<p>考点：</p>
<h4 id="challenge-27"><a href="#challenge-27" class="headerlink" title="challenge"></a>challenge</h4><p>A very <a href="https://cr.yp.toc.tf/tasks/GSDP_4d7e3b1773b3f3714c6496e6a868cf45b95af12f.txz" target="_blank" rel="noopener">modern cryptography</a>! Break it harder!</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash_base</span><span class="params">(m)</span>:</span></span><br><span class="line">	m = M(m)</span><br><span class="line">	_M = M(zero_matrix(d))</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(d):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> range(d):</span><br><span class="line">			_M[i, j] = pow(<span class="number">2</span>, m[i, j], n)</span><br><span class="line">	<span class="keyword">return</span> M(_M)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rand_poly</span><span class="params">(deg)</span>:</span></span><br><span class="line">	P = PolynomialRing(Zn, <span class="string">'x'</span>)</span><br><span class="line">	x = P.gen()</span><br><span class="line">	f = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> range(deg):</span><br><span class="line">		f += randint(<span class="number">0</span>, deg**<span class="number">2</span>)*x**(_)</span><br><span class="line">	<span class="keyword">return</span> f</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">matrox</span><span class="params">(a, b)</span>:</span></span><br><span class="line">	a, b = M(a), M(b)</span><br><span class="line">	R = zero_matrix(d)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(d):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> range(d):</span><br><span class="line">			R[i, j] = int(a[i, j]) ^^ int(b[i, j])</span><br><span class="line">	<span class="keyword">return</span> M(R)</span><br><span class="line"></span><br><span class="line">flag = flag.lstrip(<span class="string">'CCTF&#123;'</span>).rstrip(<span class="string">'&#125;'</span>)</span><br><span class="line"><span class="keyword">assert</span> len(flag) == <span class="number">25</span></span><br><span class="line">msg = [[ord(flag[j]) <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">5</span>*i, <span class="number">5</span>*i + <span class="number">5</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>)]</span><br><span class="line"></span><br><span class="line">nbit = <span class="number">72</span></span><br><span class="line">p, q = [getPrime(nbit) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">'01'</span>]</span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line">d, Zn = <span class="number">5</span>, Zmod(n)</span><br><span class="line">M = MatrixSpace(Zn, d, d)</span><br><span class="line"></span><br><span class="line">m = hash_base(msg)</span><br><span class="line">u, v = [randint(<span class="number">2</span>, <span class="number">14</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">'01'</span>]</span><br><span class="line">P = PolynomialRing(Zn, <span class="string">'x'</span>)</span><br><span class="line">x = P.gen()</span><br><span class="line">f, h = rand_poly(d), x**d + x + <span class="number">1</span></span><br><span class="line">r, s = [random_matrix(Zn, d) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">'01'</span>]</span><br><span class="line">y = f(r) ** u * s * f(r) ** v</span><br><span class="line">c_1 = h(r) ** u * s * h(r) ** v</span><br><span class="line">c_2 = matrox(hash_base(h(r) ** u * y * h(r) ** v), m)</span><br><span class="line"></span><br><span class="line">print(<span class="string">f'n = <span class="subst">&#123;n&#125;</span>'</span>)</span><br><span class="line">print(<span class="string">f'r = <span class="subst">&#123;r&#125;</span>'</span>)</span><br><span class="line">print(<span class="string">f's = <span class="subst">&#123;s&#125;</span>'</span>)</span><br><span class="line">print(<span class="string">f'y = <span class="subst">&#123;y&#125;</span>'</span>)</span><br><span class="line">print(<span class="string">f'c_1 = <span class="subst">&#123;c_1&#125;</span>'</span>)</span><br><span class="line">print(<span class="string">f'c_2 = <span class="subst">&#123;c_2&#125;</span>'</span>)</span><br></pre></td></tr></table></figure>

<h4 id="Thought-25"><a href="#Thought-25" class="headerlink" title="Thought"></a>Thought</h4><p>u，v那么小，，爆</p>
<h4 id="exp-27"><a href="#exp-27" class="headerlink" title="exp"></a>exp</h4><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">n=<span class="number">20474248118672564431085568112167867588651829</span></span><br><span class="line">r=<span class="string">[[2168977325369444782802512809005167009163457,9637731563002649997560875900298785659999735,11402741982195550777990817093767890991834736,6248261665690503242396669505673833765541530,18383713927317640760514600671318653784954042],</span></span><br><span class="line"><span class="string">[16744026390724915738262959513570982580233867,10819123318870588054961801715028528659245735,5382293825969147064471127752184942873958882,2344559383975384575566938072263260707083674,6107831242377773278696901510341268870768483],</span></span><br><span class="line"><span class="string">[13913478639322625565461944432421523802028490,1657756157808133991943366467693421012417454,20077078978711296540965234618986335826824167,15787724170325517021960596569296223410283963,11311327970428371404045885802092772454814312],</span></span><br><span class="line"><span class="string">[6961572103900078883590821780051797472394845,9455345930492634517894541442153982197931104,7188007809979291502164073459871201264229019,5450777010613496799286069470550372888274079,19294083677962489844799387987438241606854764],</span></span><br><span class="line"><span class="string">[2085952337131731679161648956407072286901978,6312527395255217479599228946227018949620025,3768572167307432043022080651953496439648407,12149358492352082063390352013944276402659624,1238053480843820309901822772557963596458725]]</span></span><br><span class="line">s=<span class="string">[[14359986778171934757328112351570087412922923,11851267097835964101770194163721259897123880,12595767519284390452196370829927812771980581,206471849033914539608937494910010443534631,16748276256578102130941428769109053956841543],</span></span><br><span class="line"><span class="string">[17260552917456245674154511124533873366489719,6705751087806309384311406617121931614484164,17060390771834209118913353599009244296476485,14200001344699610276445944574627003822066232,11014902955514050741738009264685742116160993],</span></span><br><span class="line"><span class="string">[6574547665819712697427953197398960761636762,12380657135986764418898027400335749204149860,20268210493845979828493975027685347139394991,18542561637456865344299035395313783209218383,7517573123535289654812496192079398350464721],</span></span><br><span class="line"><span class="string">[11797258068553520501845550128339899816126913,18396577268206658268808323909560870783161039,5490905135614309369346662799065239256309022,14271245849005639472351475697722779937695903,4543895191969014210971676462965142633095929],</span></span><br><span class="line"><span class="string">[8211670484406041965410550067328494865731128,9385233048164928123059801337014436991987865,2095213218314387589455876832673480152942740,13404162072797239424739266925419641170015472,6893572325245832032339890201821364839102869]]</span></span><br><span class="line">y=<span class="string">[[9455266042843307825749316910810796871873373,15333106063741475447799261101208428669252581,17507977101165165875868259123812011424101505,18840713703683969794184618879025658583771001,8194677825423260832777930195809869229371863],</span></span><br><span class="line"><span class="string">[12501728660245911874452737460699597975974127,19510243647017562462989706821025083261970404,16201393977361396153964696776216973010001356,9663056411865435751212414658633217623172749,3239680106699734686590526219042751814995824],</span></span><br><span class="line"><span class="string">[3712586611180063604215543952289707697324027,14733212399197986119485181728946640781107458,2840139099323763287710523315368925837277792,13720228569300291500610175158110171144774084,6108815350519225911945135207538331156078296],</span></span><br><span class="line"><span class="string">[7943973119701029382921917301472306070824581,2869347305630973901685036806460889911095637,10842022254827356928486285947954965977783240,20363982398752260203093070660357855892929807,3232527006736169029584220678644241677651188],</span></span><br><span class="line"><span class="string">[18741615057330867264302735709730246936126331,7207581826003452274777064725926668618294351,12235279908760679864964056098862023499484670,11395481161377031878998588680860748310228740,14691306415490831547905993706341909177907668]]</span></span><br><span class="line">c_1=<span class="string">[[14520715136678131886650886394655992310739740,5133803346119603685589690243318329447613811,8631069083165564771821540186676532972101042,11371460936058753234877719062830204068473293,4675643908977844081807119750891783452511801],</span></span><br><span class="line"><span class="string">[10758446634943798177756512241470807154028028,230322671654482905785761279475308992164431,19859272618066856343509476253828743509021381,10790059806866303289733349155468067057434048,7937553273189724162746367232714449171157875],</span></span><br><span class="line"><span class="string">[12713707768421115203045631708468778038780988,6562443329388128558909111073920129986165358,8629397281530840800788762372728359271085200,3497280351202001940823865223283895540070188,16324531747558707671873605114378727152000738],</span></span><br><span class="line"><span class="string">[17664302494165645750553234381674396726461155,11329821313213471881023356172069963076578223,17420708004114170496283987639981918922808988,4025301508682028642713745479550070150287792,13516995862604528976910352157951268294502659],</span></span><br><span class="line"><span class="string">[13197381126644223748863331681581035046689048,18134793368131211547774737770284104243998582,3304296884612368960093061281547555357926671,17654343876553302292700074689920978613390384,19965538184282119398237005639724114717256368]]</span></span><br><span class="line">c_2=<span class="string">[[7467508370111086497875591641000575993385737,436730215933598480688770862716304678927061,16388674389038775692052384536812272916184391,1544929917235051621830007372321346311674993,20266847919326089072814025756784393554435095],</span></span><br><span class="line"><span class="string">[8525400103718228392870804572553779730855209,6910832586632574200490719455813022347001485,17879158289938108082881632425571195671456277,10773037736439027909506921110474733019517450,6673285991052846421739430171898388311111793],</span></span><br><span class="line"><span class="string">[9870026505859633975247413380429542368374340,3599087047295232637660012477486366289652163,9771908525081529326761727267151928531319243,19335625816265272435673905591707160166566864,15219307175745538685718076680399058971932192],</span></span><br><span class="line"><span class="string">[7121095235650179073589022177762837236165521,10051305836914620675997951100253778882475518,14120877609199150307731361282669945615365363,3064435253345055470095756982744706296418025,126078528977194834765813221549264972548412],</span></span><br><span class="line"><span class="string">[18926039657432874696099563502261812215936524,14159758827498805644159739654028640645658626,4643672049840979864316682883185591331924981,20293416534996028081504808704845564317319704,5806383537343185356941724671128323142478351]]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def hash_base(m):</span><br><span class="line">	m = M(m)</span><br><span class="line">	_M = M(zero_matrix(d))</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(d):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> range(d):</span><br><span class="line">			_M[i, j] = <span class="built_in">pow</span>(<span class="number">2</span>, m[i, j], n)</span><br><span class="line">	<span class="keyword">return</span> M(_M)</span><br><span class="line"></span><br><span class="line">def rand_poly(<span class="built_in">deg</span>):</span><br><span class="line">	P = PolynomialRing(Zn, <span class="string">'x'</span>)</span><br><span class="line">	x = P.gen()</span><br><span class="line">	f = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="built_in">deg</span>):</span><br><span class="line">		f += randint(<span class="number">0</span>, <span class="built_in">deg</span>**<span class="number">2</span>)*x**(_)</span><br><span class="line">	<span class="keyword">return</span> f</span><br><span class="line"></span><br><span class="line">def matrox(a, b):</span><br><span class="line">	a, b = M(a), M(b)</span><br><span class="line">	R = zero_matrix(d)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(d):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> range(d):</span><br><span class="line">			R[i, j] = int(a[i, j]) ^^ int(b[i, j])</span><br><span class="line">	<span class="keyword">return</span> M(R)</span><br><span class="line"></span><br><span class="line">d, Zn = <span class="number">5</span>, Zmod(n)</span><br><span class="line">r = matrix(Zn,r)</span><br><span class="line">c_1 = matrix(Zn,c_1)</span><br><span class="line">s = matrix(Zn,s)</span><br><span class="line"><span class="keyword">for</span> u <span class="keyword">in</span> range(<span class="number">2</span>,<span class="number">14</span>):</span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> range(<span class="number">2</span>,<span class="number">14</span>):</span><br><span class="line">        <span class="keyword">if</span> c_1 == h(r) ** u * s * h(r) ** v:</span><br><span class="line">            <span class="built_in">print</span>(u,v)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">M = MatrixSpace(Zn, d, d)</span><br><span class="line">u = <span class="number">11</span></span><br><span class="line">v = <span class="number">12</span></span><br><span class="line">c_2 = matrix(Zmod(n),c_2)</span><br><span class="line">y = matrix(Zmod(n),y)</span><br><span class="line">m = matrox(hash_base(h(r) ** u * y * h(r) ** v), c_2)</span><br><span class="line">flag=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> m:</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> each:</span><br><span class="line">		flag+=chr(discrete_log(Mod(i,n),Mod(<span class="number">2</span>,n)))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h4 id="result-27"><a href="#result-27" class="headerlink" title="result"></a>result</h4><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PKCS_<span class="symbol">N0</span><span class="symbol">n_cOmMu74</span>T!v<span class="number">3</span>_rI<span class="symbol">n9</span></span><br></pre></td></tr></table></figure>

<h3 id="Persian-cat"><a href="#Persian-cat" class="headerlink" title="Persian cat"></a>Persian cat</h3><p>分值：247</p>
<p>考点：block cipher</p>
<h4 id="challenge-28"><a href="#challenge-28" class="headerlink" title="challenge"></a>challenge</h4><p>Persian cat</p>
<p>Can you check this crypto system and let us know the <a href="https://cr.yp.toc.tf/tasks/persian_cat_453315499dc129fa38c9728d61a002539c6999ff.txz" target="_blank" rel="noopener">message</a>? You will find this crypto system very adroit!</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nc <span class="number">03</span><span class="selector-class">.cr</span><span class="selector-class">.yp</span><span class="selector-class">.toc</span><span class="selector-class">.tf</span> <span class="number">11173</span></span><br><span class="line">nc <span class="number">07</span><span class="selector-class">.cr</span><span class="selector-class">.yp</span><span class="selector-class">.toc</span><span class="selector-class">.tf</span> <span class="number">11173</span></span><br><span class="line">nc <span class="number">05</span><span class="selector-class">.cr</span><span class="selector-class">.yp</span><span class="selector-class">.toc</span><span class="selector-class">.tf</span> <span class="number">11173</span></span><br><span class="line">nc <span class="number">02</span><span class="selector-class">.cr</span><span class="selector-class">.yp</span><span class="selector-class">.toc</span><span class="selector-class">.tf</span> <span class="number">11173</span></span><br></pre></td></tr></table></figure>

<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import random, sys</span><br><span class="line">#from secret import skey, flag</span><br><span class="line">flag = <span class="string">"CCTF"</span>*<span class="number">10</span></span><br><span class="line">skey = b<span class="string">"A"</span>*<span class="number">20</span></span><br><span class="line"><span class="symbol">Omega</span> = [</span><br><span class="line">		<span class="number">0x4e</span>, <span class="number">0x96</span>, <span class="number">0xfd</span>, <span class="number">0x7d</span>, <span class="number">0x8d</span>, <span class="number">0xf6</span>, <span class="number">0xdb</span>, <span class="number">0x33</span>, <span class="number">0x1e</span>, <span class="number">0x16</span>, <span class="number">0x9b</span>, <span class="number">0x6a</span>, <span class="number">0xe2</span>, <span class="number">0xc9</span>, <span class="number">0xa9</span>, <span class="number">0xe0</span>, </span><br><span class="line">		<span class="number">0x34</span>, <span class="number">0xe6</span>, <span class="number">0x86</span>, <span class="number">0xd6</span>, <span class="number">0x52</span>, <span class="number">0x02</span>, <span class="number">0x25</span>, <span class="number">0x1f</span>, <span class="number">0x23</span>, <span class="number">0xdf</span>, <span class="number">0xd5</span>, <span class="number">0x12</span>, <span class="number">0x45</span>, <span class="number">0x6b</span>, <span class="number">0x6f</span>, <span class="number">0x4d</span>, </span><br><span class="line">		<span class="number">0x31</span>, <span class="number">0x77</span>, <span class="number">0x09</span>, <span class="number">0xbf</span>, <span class="number">0x93</span>, <span class="number">0xca</span>, <span class="number">0x4b</span>, <span class="number">0xef</span>, <span class="number">0xee</span>, <span class="number">0x7c</span>, <span class="number">0x53</span>, <span class="number">0x1a</span>, <span class="number">0xc8</span>, <span class="number">0xea</span>, <span class="number">0x9d</span>, <span class="number">0xda</span>, </span><br><span class="line">		<span class="number">0x32</span>, <span class="number">0xa4</span>, <span class="number">0x11</span>, <span class="number">0x7b</span>, <span class="number">0xd8</span>, <span class="number">0x3f</span>, <span class="number">0x13</span>, <span class="number">0x57</span>, <span class="number">0x75</span>, <span class="number">0xcb</span>, <span class="number">0x37</span>, <span class="number">0x9a</span>, <span class="number">0x83</span>, <span class="number">0xa5</span>, <span class="number">0x3e</span>, <span class="number">0xd3</span>, </span><br><span class="line">		<span class="number">0x4a</span>, <span class="number">0x1d</span>, <span class="number">0x29</span>, <span class="number">0xb9</span>, <span class="number">0x18</span>, <span class="number">0x27</span>, <span class="number">0x2d</span>, <span class="number">0x0f</span>, <span class="number">0x15</span>, <span class="number">0x0d</span>, <span class="number">0x66</span>, <span class="number">0xae</span>, <span class="number">0xf5</span>, <span class="number">0xfa</span>, <span class="number">0x08</span>, <span class="number">0x9f</span>, </span><br><span class="line">		<span class="number">0xc6</span>, <span class="number">0x55</span>, <span class="number">0xa0</span>, <span class="number">0xb7</span>, <span class="number">0x28</span>, <span class="number">0x0e</span>, <span class="number">0xf4</span>, <span class="number">0x01</span>, <span class="number">0x04</span>, <span class="number">0x46</span>, <span class="number">0xf9</span>, <span class="number">0x39</span>, <span class="number">0xe3</span>, <span class="number">0x7f</span>, <span class="number">0x5e</span>, <span class="number">0x61</span>, </span><br><span class="line">		<span class="number">0x40</span>, <span class="number">0x26</span>, <span class="number">0xec</span>, <span class="number">0xb6</span>, <span class="number">0x14</span>, <span class="number">0xf0</span>, <span class="number">0x59</span>, <span class="number">0x50</span>, <span class="number">0xcf</span>, <span class="number">0x3a</span>, <span class="number">0x8b</span>, <span class="number">0x43</span>, <span class="number">0xaf</span>, <span class="number">0x10</span>, <span class="number">0xe5</span>, <span class="number">0xe8</span>, </span><br><span class="line">		<span class="number">0x03</span>, <span class="number">0xbd</span>, <span class="number">0x51</span>, <span class="number">0xa7</span>, <span class="number">0x1c</span>, <span class="number">0x8e</span>, <span class="number">0x7a</span>, <span class="number">0x98</span>, <span class="number">0x3c</span>, <span class="number">0xeb</span>, <span class="number">0xac</span>, <span class="number">0x54</span>, <span class="number">0x84</span>, <span class="number">0xf7</span>, <span class="number">0x62</span>, <span class="number">0x88</span>, </span><br><span class="line">		<span class="number">0x64</span>, <span class="number">0xa8</span>, <span class="number">0xbb</span>, <span class="number">0xab</span>, <span class="number">0xe1</span>, <span class="number">0x95</span>, <span class="number">0x94</span>, <span class="number">0x41</span>, <span class="number">0x2a</span>, <span class="number">0x60</span>, <span class="number">0x30</span>, <span class="number">0xcc</span>, <span class="number">0x48</span>, <span class="number">0xd2</span>, <span class="number">0x89</span>, <span class="number">0xb2</span>, </span><br><span class="line">		<span class="number">0x65</span>, <span class="number">0x76</span>, <span class="number">0x0a</span>, <span class="number">0xb8</span>, <span class="number">0x56</span>, <span class="number">0x4f</span>, <span class="number">0xc3</span>, <span class="number">0x87</span>, <span class="number">0xdd</span>, <span class="number">0x4c</span>, <span class="number">0xc2</span>, <span class="number">0xd4</span>, <span class="number">0x82</span>, <span class="number">0x35</span>, <span class="number">0x90</span>, <span class="number">0xa2</span>, </span><br><span class="line">		<span class="number">0x5f</span>, <span class="number">0xad</span>, <span class="number">0x19</span>, <span class="number">0x74</span>, <span class="number">0x73</span>, <span class="number">0xd0</span>, <span class="number">0x24</span>, <span class="number">0x69</span>, <span class="number">0x20</span>, <span class="number">0x07</span>, <span class="number">0xdc</span>, <span class="number">0x1b</span>, <span class="number">0x44</span>, <span class="number">0x58</span>, <span class="number">0xff</span>, <span class="number">0x5a</span>, </span><br><span class="line">		<span class="number">0x6c</span>, <span class="number">0xf2</span>, <span class="number">0xfb</span>, <span class="number">0x8c</span>, <span class="number">0x79</span>, <span class="number">0x97</span>, <span class="number">0xa6</span>, <span class="number">0x22</span>, <span class="number">0xb4</span>, <span class="number">0x7e</span>, <span class="number">0x5b</span>, <span class="number">0x17</span>, <span class="number">0x2f</span>, <span class="number">0x91</span>, <span class="number">0x71</span>, <span class="number">0xfe</span>, </span><br><span class="line">		<span class="number">0x38</span>, <span class="number">0xa3</span>, <span class="number">0x05</span>, <span class="number">0xb1</span>, <span class="number">0xba</span>, <span class="number">0x99</span>, <span class="number">0xd9</span>, <span class="number">0xf1</span>, <span class="number">0x21</span>, <span class="number">0x5c</span>, <span class="number">0x67</span>, <span class="number">0x6d</span>, <span class="number">0xde</span>, <span class="number">0xaa</span>, <span class="number">0xc7</span>, <span class="number">0x8f</span>, </span><br><span class="line">		<span class="number">0x81</span>, <span class="number">0x0b</span>, <span class="number">0xb0</span>, <span class="number">0xbc</span>, <span class="number">0x0c</span>, <span class="number">0xcd</span>, <span class="number">0x63</span>, <span class="number">0xc1</span>, <span class="number">0xfc</span>, <span class="number">0xc0</span>, <span class="number">0x42</span>, <span class="number">0x78</span>, <span class="number">0xc5</span>, <span class="number">0x8a</span>, <span class="number">0x06</span>, <span class="number">0x3d</span>, </span><br><span class="line">		<span class="number">0x2e</span>, <span class="number">0x9e</span>, <span class="number">0xa1</span>, <span class="number">0x80</span>, <span class="number">0xb3</span>, <span class="number">0xf8</span>, <span class="number">0xe9</span>, <span class="number">0x68</span>, <span class="number">0xd1</span>, <span class="number">0x36</span>, <span class="number">0x70</span>, <span class="number">0x49</span>, <span class="number">0xc4</span>, <span class="number">0xd7</span>, <span class="number">0x2c</span>, <span class="number">0x6e</span>, </span><br><span class="line">		<span class="number">0xe7</span>, <span class="number">0xb5</span>, <span class="number">0xbe</span>, <span class="number">0x92</span>, <span class="number">0xce</span>, <span class="number">0xed</span>, <span class="number">0xf3</span>, <span class="number">0x9c</span>, <span class="number">0xe4</span>, <span class="number">0x3b</span>, <span class="number">0x47</span>, <span class="number">0x2b</span>, <span class="number">0x85</span>, <span class="number">0x5d</span>, <span class="number">0x72</span>, <span class="number">0x01</span></span><br><span class="line">		]</span><br><span class="line"></span><br><span class="line">def padding(msg):</span><br><span class="line">	if len(msg) <span class="comment">% 32 != 0:</span></span><br><span class="line">		extra = <span class="string">'*'</span> * (<span class="number">32</span> - len(msg) <span class="comment">% 32)</span></span><br><span class="line">		return msg + extra</span><br><span class="line">	else:</span><br><span class="line">		return msg</span><br><span class="line"></span><br><span class="line">def keygen(u, v):</span><br><span class="line">	return [a ^ b for a, b in zip(u, v)][:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">def roadrunner(table, roadrunner_wile, lili, lilibeth, omega):</span><br><span class="line">	for z in range(<span class="number">16</span>):</span><br><span class="line">		roadrunner_wile[z] = (((omega[table[lili[z][<span class="number">0</span>]]] | omega[table[lili[z][<span class="number">1</span>]]]) +</span><br><span class="line">			(omega[table[lili[z][<span class="number">2</span>]]] | omega[table[lili[z][<span class="number">3</span>]]])) ^ ((omega[table[lili[z][<span class="number">4</span>]]] +</span><br><span class="line">			omega[table[lili[z][<span class="number">5</span>]]]) + (omega[table[lili[z][<span class="number">6</span>]]] ^ omega[table[lili[z][<span class="number">7</span>]]]))) <span class="comment">% 256</span></span><br><span class="line">		roadrunner_wile[z] = (roadrunner_wile[z] + (((~omega[table[lili[z][<span class="number">8</span>]]] ^ omega[table[lili[z][<span class="number">9</span>]]]) +</span><br><span class="line">			(omega[table[lili[z][<span class="number">10</span>]]] &amp; ~omega[table[lili[z][<span class="number">11</span>]]])) ^ ((omega[table[lili[z][<span class="number">12</span>]]] ^ </span><br><span class="line">			~omega[table[lili[z][<span class="number">13</span>]]]) + (omega[table[lili[z][<span class="number">14</span>]]] ^ omega[table[lili[z][<span class="number">15</span>]]])))) <span class="comment">% 256</span></span><br><span class="line">		roadrunner_wile[z] = (roadrunner_wile[z] + lilibeth[roadrunner_wile[z]] + lilibeth[z]) <span class="comment">% 256</span></span><br><span class="line">	return roadrunner_wile</span><br><span class="line"></span><br><span class="line">def roadrunner_init(table, roadrunner_wile, lili, lilibeth, omega):</span><br><span class="line">	<span class="symbol">SBOX</span> = [</span><br><span class="line">		[<span class="number">10</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">13</span>], </span><br><span class="line">		[<span class="number">1</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">9</span>], </span><br><span class="line">		[<span class="number">1</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">13</span>, <span class="number">12</span>], </span><br><span class="line">		[<span class="number">5</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">13</span>], </span><br><span class="line">		[<span class="number">10</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">7</span>], </span><br><span class="line">		[<span class="number">15</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">11</span>], </span><br><span class="line">		[<span class="number">13</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">1</span>], </span><br><span class="line">		[<span class="number">13</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">1</span>], </span><br><span class="line">		[<span class="number">11</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">15</span>], </span><br><span class="line">		[<span class="number">2</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">10</span>], </span><br><span class="line">		[<span class="number">13</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">15</span>], </span><br><span class="line">		[<span class="number">15</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">10</span>], </span><br><span class="line">		[<span class="number">10</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">13</span>], </span><br><span class="line">		[<span class="number">1</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">10</span>], </span><br><span class="line">		[<span class="number">14</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">1</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">7</span>], </span><br><span class="line">		[<span class="number">11</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">14</span>]</span><br><span class="line">		]</span><br><span class="line">	for z in range(<span class="number">16</span>):</span><br><span class="line">		roadrunner_wile[z] = (((omega[table[<span class="symbol">SBOX</span>[z][<span class="number">0</span>]]] | omega[table[<span class="symbol">SBOX</span>[z][<span class="number">1</span>]]]) +</span><br><span class="line">			(omega[table[<span class="symbol">SBOX</span>[z][<span class="number">2</span>]]] | omega[table[<span class="symbol">SBOX</span>[z][<span class="number">3</span>]]])) ^ ((omega[table[<span class="symbol">SBOX</span>[z][<span class="number">4</span>]]] +</span><br><span class="line">			omega[table[<span class="symbol">SBOX</span>[z][<span class="number">5</span>]]]) + ( omega[table[<span class="symbol">SBOX</span>[z][<span class="number">6</span>]]] ^ omega[table[<span class="symbol">SBOX</span>[z][<span class="number">7</span>]]]))) <span class="comment">% 256</span></span><br><span class="line">		roadrunner_wile[z] = (roadrunner_wile[z] + (((~omega[table[<span class="symbol">SBOX</span>[z][<span class="number">8</span>]]] ^ omega[table[<span class="symbol">SBOX</span>[z][<span class="number">9</span>]]]) + </span><br><span class="line">			(omega[table[<span class="symbol">SBOX</span>[z][<span class="number">10</span>]]] &amp; ~omega[table[<span class="symbol">SBOX</span>[z][<span class="number">11</span>]]])) ^ ((omega[table[<span class="symbol">SBOX</span>[z][<span class="number">12</span>]]] ^ </span><br><span class="line">			~omega[table[<span class="symbol">SBOX</span>[z][<span class="number">13</span>]]]) + (omega[table[<span class="symbol">SBOX</span>[z][<span class="number">14</span>]]] ^ omega[table[<span class="symbol">SBOX</span>[z][<span class="number">15</span>]]])))) <span class="comment">% 256</span></span><br><span class="line">	return roadrunner_wile</span><br><span class="line"></span><br><span class="line">def circle_it_out(msg, ruler, roadrunner_wile, lili, lilibeth, enc, l, r, omega):</span><br><span class="line">	for i in range(<span class="number">16</span>):</span><br><span class="line">		l[<span class="number">0</span>][i] = msg[i]</span><br><span class="line">		r[<span class="number">0</span>][i] = msg[i+<span class="number">16</span>]</span><br><span class="line">	for i in range(<span class="number">1</span>, ruler):</span><br><span class="line">		roadrunner_wile = roadrunner(r[i<span class="number">-1</span>], roadrunner_wile, lili, lilibeth, omega)</span><br><span class="line">		for y in range(<span class="number">16</span>):</span><br><span class="line">			l[i][y] = r[i<span class="number">-1</span>][y]</span><br><span class="line">			r[i][y] = (l[i<span class="number">-1</span>][y] ^ roadrunner_wile[y])<span class="comment">%256</span></span><br><span class="line">	for i in range(<span class="number">16</span>):</span><br><span class="line">		enc[i+<span class="number">16</span>] = l[ruler<span class="number">-1</span>][i]<span class="comment">%256</span></span><br><span class="line">		enc[i] = r[ruler<span class="number">-1</span>][i]<span class="comment">%256</span></span><br><span class="line">	return roadrunner_wile, enc, l, r</span><br><span class="line"></span><br><span class="line">def circle_it_out_init(msg, ruler, roadrunner_wile, lili, lilibeth, enc, l, r, omega):</span><br><span class="line">	for i in range(<span class="number">16</span>):</span><br><span class="line">		l[<span class="number">0</span>][i] = msg[i]</span><br><span class="line">		r[<span class="number">0</span>][i] = msg[i+<span class="number">16</span>]</span><br><span class="line">	for i in range(<span class="number">1</span>,ruler):</span><br><span class="line">		roadrunner_wile = roadrunner_init(r[i<span class="number">-1</span>], roadrunner_wile, lili, lilibeth, omega)</span><br><span class="line">		for y in range(<span class="number">16</span>):</span><br><span class="line">			l[i][y] = r[i<span class="number">-1</span>][y]</span><br><span class="line">			r[i][y] = (l[i<span class="number">-1</span>][y] ^ roadrunner_wile[y])<span class="comment">%256</span></span><br><span class="line">	for i in range(<span class="number">16</span>):</span><br><span class="line">		enc[i] = l[ruler<span class="number">-1</span>][i]<span class="comment">%256</span></span><br><span class="line">		enc[i+<span class="number">16</span>] = r[ruler<span class="number">-1</span>][i]<span class="comment">%256</span></span><br><span class="line">	return roadrunner_wile, enc, l, r</span><br><span class="line"></span><br><span class="line">def persian_init(key, roadrunner_wile, lili, lilibeth, enc, l, r, omega, <span class="symbol">Omega</span>):</span><br><span class="line">	stkey = [<span class="number">88</span>, <span class="number">20</span>, <span class="number">64</span>, <span class="number">181</span>, <span class="number">251</span>, <span class="number">167</span>, <span class="number">69</span>, <span class="number">243</span>, <span class="number">205</span>, <span class="number">166</span>, <span class="number">110</span>, <span class="number">65</span>, <span class="number">90</span>, <span class="number">176</span>, <span class="number">229</span>, <span class="number">46</span>, <span class="number">206</span>, <span class="number">104</span>, <span class="number">15</span>, <span class="number">19</span>, <span class="number">49</span>, <span class="number">101</span>, <span class="number">3</span>, <span class="number">223</span>, <span class="number">221</span>, <span class="number">231</span>, <span class="number">232</span>, <span class="number">43</span>, <span class="number">62</span>, <span class="number">193</span>, <span class="number">80</span>, <span class="number">228</span>]</span><br><span class="line">	for compt in range(<span class="number">256</span>):</span><br><span class="line">		omega[compt] = (<span class="symbol">Omega</span>[compt]^key[compt<span class="comment">%20]) % 256</span></span><br><span class="line">	for w in range(<span class="number">4</span>):</span><br><span class="line">		roadrunner_wile, enc, l, r = circle_it_out_init(stkey, <span class="number">32</span>, roadrunner_wile, lili, lilibeth, enc, l, r, omega);</span><br><span class="line">		for compt in range(<span class="number">256</span>):</span><br><span class="line">			omega[compt] = (omega[compt]^enc[compt<span class="comment">%32])%256</span></span><br><span class="line">		for compt in range(<span class="number">32</span>):</span><br><span class="line">			stkey[compt] = enc[compt]</span><br><span class="line">	for compt in range(<span class="number">16</span>):</span><br><span class="line">		err = <span class="number">0</span></span><br><span class="line">		ix = <span class="number">0</span></span><br><span class="line">		while ix &lt; <span class="number">16</span>:</span><br><span class="line">			roadrunner_wile, enc, l, r = circle_it_out_init(enc, <span class="number">4</span>, roadrunner_wile, lili, lilibeth, enc, l, r, omega)</span><br><span class="line">			x = <span class="number">0</span></span><br><span class="line">			while x &lt; ix:</span><br><span class="line">				if lili[compt][x] == (enc[<span class="number">7</span>]<span class="comment">%16):</span></span><br><span class="line">					x = ix</span><br><span class="line">					err = <span class="number">1</span></span><br><span class="line">					roadrunner_wile, enc, l, r = circle_it_out_init(enc, <span class="number">4</span>, roadrunner_wile, lili, lilibeth, enc, l, r, omega)</span><br><span class="line">				else: x += <span class="number">1</span></span><br><span class="line">			if err == <span class="number">0</span>: lili[compt][ix] = enc[<span class="number">7</span>]<span class="comment">%16</span></span><br><span class="line">			else:</span><br><span class="line">				err = <span class="number">0</span>;</span><br><span class="line">				ix = ix<span class="number">-1</span>;</span><br><span class="line">			ix += <span class="number">1</span></span><br><span class="line">	err = <span class="number">0</span> </span><br><span class="line">	ix = <span class="number">0</span></span><br><span class="line">	while ix &lt; <span class="number">256</span>:</span><br><span class="line">		roadrunner_wile, enc, l, r = circle_it_out_init(enc, <span class="number">4</span>, roadrunner_wile, lili, lilibeth, enc, l, r, omega)</span><br><span class="line">		x = <span class="number">0</span></span><br><span class="line">		while x &lt; ix:</span><br><span class="line">			if lilibeth[x] == ( enc[<span class="number">7</span>]<span class="comment">%256):</span></span><br><span class="line">				x  = ix </span><br><span class="line">				err = <span class="number">1</span></span><br><span class="line">				roadrunner_wile, enc, l, r = circle_it_out_init(enc, <span class="number">4</span>, roadrunner_wile, lili, lilibeth, enc, l, r, omega)</span><br><span class="line">			else:	</span><br><span class="line">				x += <span class="number">1</span></span><br><span class="line">		if err == <span class="number">0</span>: lilibeth[ix]=enc[<span class="number">7</span>]<span class="comment">%256</span></span><br><span class="line">		else:</span><br><span class="line">			err = <span class="number">0</span>;</span><br><span class="line">			ix = ix<span class="number">-1</span>;</span><br><span class="line">		ix += <span class="number">1</span></span><br><span class="line">	for compt in range(<span class="number">256</span>):</span><br><span class="line">		omega[compt] = (omega[compt] ^ key[compt<span class="comment">%20])%256	</span></span><br><span class="line">	for w in range(<span class="number">4</span>):</span><br><span class="line">		roadrunner_wile, enc, l, r = circle_it_out_init(stkey, <span class="number">32</span>, roadrunner_wile, lili, lilibeth, enc, l, r, omega)</span><br><span class="line">		for compt in range(<span class="number">256</span>):</span><br><span class="line">			omega[compt] = (omega[compt] ^ enc[compt<span class="comment">%32])%256</span></span><br><span class="line">		for compt in range(<span class="number">32</span>):</span><br><span class="line">			stkey[compt] = enc[compt]</span><br><span class="line">	return roadrunner_wile, lili, lilibeth, enc, l, r, omega</span><br><span class="line"></span><br><span class="line">def encrypt_iginition(msg, key):</span><br><span class="line">	roadrunner_wile = [<span class="number">0</span> for x in range(<span class="number">16</span>)]</span><br><span class="line">	lili = [[<span class="number">0</span> for x in range(<span class="number">16</span>)] for y in range(<span class="number">256</span>)] </span><br><span class="line">	lilibeth, omega = [[<span class="number">0</span> for x in range(<span class="number">256</span>)] for <span class="symbol">_</span> in <span class="string">'01'</span>]</span><br><span class="line">	enc = [<span class="number">0</span> for x in range(<span class="number">32</span>)]</span><br><span class="line">	l, r = [[[<span class="number">0</span> for x in range(<span class="number">16</span>)] for y in range(<span class="number">32</span>)] for <span class="symbol">_</span> in <span class="string">'01'</span>] </span><br><span class="line">	roadrunner_wile, lili, lilibeth, enc, l, r, omega = persian_init(key, roadrunner_wile, lili, lilibeth, enc, l, r, omega, <span class="symbol">Omega</span>)</span><br><span class="line">	roadrunner_wile, enc, l, r = circle_it_out(msg, <span class="number">6</span>, roadrunner_wile, lili, lilibeth, enc, l, r, omega)</span><br><span class="line">	return enc</span><br><span class="line"></span><br><span class="line">def encrypt(msg, key):</span><br><span class="line">	msg = padding(msg)</span><br><span class="line">	blocks = [msg[i*<span class="number">32</span>:i*<span class="number">32</span>+<span class="number">32</span>] for i in range(len(msg) // <span class="number">32</span>)]</span><br><span class="line">	ciphers = []</span><br><span class="line">	enc = encrypt_iginition([ord(item) for item in blocks[<span class="number">0</span>]], key)</span><br><span class="line">	ciphers.append(enc)</span><br><span class="line">	for i in range(len(blocks)<span class="number">-1</span>):</span><br><span class="line">		enc = encrypt_iginition([ord(item) for item in blocks[i+<span class="number">1</span>]], keygen([ord(item) for item in blocks[i]], ciphers[i]))</span><br><span class="line">		ciphers.append(enc)</span><br><span class="line">	return <span class="string">""</span>.join(<span class="string">""</span>.join(str(format(i, <span class="string">"02x"</span>)) for i in item) for item in ciphers)</span><br><span class="line"></span><br><span class="line">def die(*args):</span><br><span class="line">	pr(*args)</span><br><span class="line">	quit()</span><br><span class="line"></span><br><span class="line">def pr(*args):</span><br><span class="line">	s = <span class="string">" "</span>.join(map(str, args))</span><br><span class="line">	sys.stdout.write(s + <span class="string">"\n"</span>)</span><br><span class="line">	sys.stdout.flush()</span><br><span class="line"></span><br><span class="line">def sc():</span><br><span class="line">	return sys.stdin.readline().strip()</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">	border = <span class="string">"|"</span></span><br><span class="line">	pr(border*<span class="number">72</span>)</span><br><span class="line">	pr(border, <span class="string">"Hello guys! This challenge is about breaking a symmetric cipher that"</span>, border)</span><br><span class="line">	pr(border, <span class="string">"we have implemented here, your mission is find the flag, have fun :)"</span>, border)</span><br><span class="line">	pr(border*<span class="number">72</span>)</span><br><span class="line"></span><br><span class="line">	while <span class="symbol">True</span>:</span><br><span class="line">		pr(<span class="string">"| Options: \n|\t[E]encrypt message \n|\t[Q]uit"</span>)</span><br><span class="line">		ans = sc().lower()</span><br><span class="line">		if ans == <span class="string">'e'</span>:</span><br><span class="line">			pr(border, <span class="string">'please send you message: '</span>)</span><br><span class="line">			msg = sc()</span><br><span class="line">			enc = encrypt(msg + flag, skey)</span><br><span class="line">			pr(border, f<span class="string">'enc = &#123;enc&#125;'</span>)</span><br><span class="line">		elif ans == <span class="string">'q'</span>: die(<span class="string">"Quitting ..."</span>)</span><br><span class="line">		else: die(<span class="string">"Bye bye ..."</span>)</span><br><span class="line"></span><br><span class="line">if <span class="symbol">__name__</span> == <span class="string">'__main__'</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>

<h4 id="Thought-26"><a href="#Thought-26" class="headerlink" title="Thought"></a>Thought</h4><p>代码过于长了，加密的内容也好麻烦好绕，看着让人头大。不过细看一下，似乎也就是一个纸老虎</p>
<p>注意到 encrypt 函数，</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">def <span class="built_in">encrypt</span>(msg, key):</span><br><span class="line">	msg = padding(msg)</span><br><span class="line">	blocks = [msg[i*<span class="number">32</span>:i*<span class="number">32</span>+<span class="number">32</span>] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="built_in">len</span>(msg)<span class="comment"> // 32)]</span></span><br><span class="line">	ciphers = []</span><br><span class="line">	enc = encrypt_iginition([ord(<span class="keyword">item</span>) <span class="keyword">for</span> <span class="keyword">item</span> <span class="keyword">in</span> blocks[<span class="number">0</span>]], key)</span><br><span class="line">	ciphers.append(enc)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="built_in">len</span>(blocks)<span class="number">-1</span>):</span><br><span class="line">		enc = encrypt_iginition([ord(<span class="keyword">item</span>) <span class="keyword">for</span> <span class="keyword">item</span> <span class="keyword">in</span> blocks[i+<span class="number">1</span>]], keygen([ord(<span class="keyword">item</span>) <span class="keyword">for</span> <span class="keyword">item</span> <span class="keyword">in</span> blocks[i]], ciphers[i]))</span><br><span class="line">		ciphers.append(enc)</span><br><span class="line">	<span class="literal">return</span> <span class="string">""</span>.join(<span class="string">""</span>.join(str(<span class="built_in">format</span>(i, <span class="string">"02x"</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">item</span>) <span class="keyword">for</span> <span class="keyword">item</span> <span class="keyword">in</span> ciphers)</span><br></pre></td></tr></table></figure>

<p>是块加密，一次加密32个比特，加密公式为</p>
<p>$c_0 = Enc(m_0,k)$</p>
<p>$c_i = Enc(m_i,g(m_{i-1}) \oplus c_{i-1})$</p>
<p>有那么有点 $CBC$ 模式的味道。</p>
<p>注意到我们在交互的时候，传入 $msg$，会返回 $c = encrypt(msg+flag,k)$</p>
<p>那么进行一手逐字节爆破就可以了吧。第一次传入 “A” * 31，那么第一组就会是 “A”*31 + flag[0] 的密文，我们爆破这个字节就好了。以此类推可以获取flag的前32个字节。那后面的字节怎么办呢？</p>
<p>那我们可以第一次传入 “A” * 64，看第二组的密文来开始爆，这样能爆出 $flag$ 的64个字节，以此类推。。。（怪不得给了这么多地址）</p>
<p>但是春哥顶啊，直接就是对波斯猫的一个<a href="https://zhuanlan.zhihu.com/p/547108889" target="_blank" rel="noopener">硬撸</a>。</p>
<h4 id="exp-28"><a href="#exp-28" class="headerlink" title="exp"></a>exp</h4><h3 id="NLCS-x"><a href="#NLCS-x" class="headerlink" title="NLCS x"></a>NLCS x</h3><p>分值：375</p>
<p>考点：LFSR、PolynomialRing</p>
<h4 id="challenge-29"><a href="#challenge-29" class="headerlink" title="challenge"></a>challenge</h4><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env sage</span><br><span class="line"></span><br><span class="line">from <span class="symbol">Crypto</span>.<span class="symbol">Util</span>.number import *</span><br><span class="line">from flag import flag</span><br><span class="line"></span><br><span class="line">def <span class="symbol">Eval_Poly</span>(feedabck , <span class="symbol">States</span>):</span><br><span class="line">	next_s = <span class="number">0</span></span><br><span class="line">	for i in range(len(feedabck) - <span class="number">1</span>):</span><br><span class="line">		if feedabck[i]:</span><br><span class="line">			next_s = next_s + <span class="symbol">States</span>[i]</span><br><span class="line">	return next_s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = flag.lstrip(<span class="string">'CCTF&#123;'</span>).rstrip(<span class="string">'&#125;'</span>)</span><br><span class="line">m = bytes_to_long(flag.encode(<span class="string">'utf-8'</span>))</span><br><span class="line"><span class="symbol">IS</span>, l = <span class="string">'0'</span> + bin(m)[<span class="number">2</span>:], len(bin(m)[<span class="number">2</span>:]) + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">registers= [<span class="string">'s'</span> + str(i) for i in range(l)]</span><br><span class="line"><span class="symbol">A</span> = <span class="symbol">BooleanPolynomialRing</span>(names = registers, order = <span class="symbol">TermOrder</span>(<span class="string">"lex"</span>))</span><br><span class="line"></span><br><span class="line"><span class="symbol">P</span> = <span class="symbol">PolynomialRing</span>(<span class="symbol">ZZ</span>, <span class="string">'x'</span>)</span><br><span class="line">x, <span class="symbol">FF</span> = <span class="symbol">P</span>.gen(), <span class="symbol">GF</span>(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="symbol">IS</span> = [<span class="symbol">FF</span>(<span class="symbol">_</span>) for <span class="symbol">_</span> in <span class="symbol">IS</span>]</span><br><span class="line">f = x^<span class="number">64</span> + x^<span class="number">33</span> + x^<span class="number">30</span> + x^<span class="number">26</span> + x^<span class="number">25</span> + x^<span class="number">24</span> + x^<span class="number">23</span> + x^<span class="number">22</span> + x^<span class="number">21</span> + x^<span class="number">20</span> + x^<span class="number">18</span> + x^<span class="number">13</span> + x^<span class="number">12</span> + x^<span class="number">11</span> + x^<span class="number">10</span> + x^<span class="number">7</span> + x^<span class="number">5</span> + x^<span class="number">4</span> + x^<span class="number">2</span> + x + <span class="number">1</span></span><br><span class="line"><span class="symbol">LFSR</span> = <span class="symbol">LFSRCryptosystem</span>(<span class="symbol">FF</span>)</span><br><span class="line"></span><br><span class="line"><span class="symbol">Encryptor</span> = <span class="symbol">LFSR</span>((f,<span class="symbol">IS</span>))</span><br><span class="line"></span><br><span class="line">ins = <span class="symbol">Encryptor</span>.initial_state()</span><br><span class="line">poly = [<span class="symbol">FF</span>(<span class="symbol">_</span>) for <span class="symbol">_</span> in f.list()]</span><br><span class="line"><span class="symbol">SIZE</span> = <span class="number">2</span> ** (l // <span class="number">4</span>)</span><br><span class="line"><span class="symbol">IKEY</span> = lfsr_sequence(poly, <span class="symbol">IS</span>, <span class="symbol">SIZE</span>)</span><br><span class="line"><span class="symbol">KEY</span> = <span class="string">''</span></span><br><span class="line">for i in range(<span class="symbol">SIZE</span> - l):</span><br><span class="line">	<span class="symbol">S</span> = [<span class="symbol">FF</span>(t) for t in <span class="symbol">IKEY</span>[i:i + l]]</span><br><span class="line">	<span class="symbol">KEY</span> += str(</span><br><span class="line">		<span class="symbol">S</span>[<span class="number">0</span>] + <span class="symbol">S</span>[<span class="number">12</span>] + <span class="symbol">S</span>[<span class="number">62</span>] + <span class="symbol">S</span>[<span class="number">18</span>] + <span class="symbol">S</span>[<span class="number">36</span>] + </span><br><span class="line">		<span class="symbol">S</span>[<span class="number">2</span>]*<span class="symbol">S</span>[<span class="number">8</span>] + </span><br><span class="line">		<span class="symbol">S</span>[<span class="number">34</span>]*<span class="symbol">S</span>[<span class="number">20</span>] +</span><br><span class="line">		<span class="symbol">S</span>[<span class="number">27</span>]*<span class="symbol">S</span>[<span class="number">60</span>] +</span><br><span class="line">		<span class="symbol">S</span>[<span class="number">31</span>]*<span class="symbol">S</span>[<span class="number">34</span>] +</span><br><span class="line">		<span class="symbol">S</span>[<span class="number">63</span>]*<span class="symbol">S</span>[<span class="number">48</span>] +</span><br><span class="line">		<span class="symbol">S</span>[<span class="number">50</span>]*<span class="symbol">S</span>[<span class="number">15</span>] +</span><br><span class="line">		<span class="symbol">S</span>[<span class="number">25</span>]*<span class="symbol">S</span>[<span class="number">49</span>] +</span><br><span class="line">		<span class="symbol">S</span>[<span class="number">49</span>]*<span class="symbol">S</span>[<span class="number">7</span>]  +</span><br><span class="line">		<span class="symbol">S</span>[<span class="number">13</span>]*<span class="symbol">S</span>[<span class="number">61</span>]*<span class="symbol">S</span>[<span class="number">10</span>] +</span><br><span class="line">		<span class="symbol">S</span>[<span class="number">32</span>]*<span class="symbol">S</span>[<span class="number">37</span>]*<span class="symbol">S</span>[<span class="number">29</span>] +</span><br><span class="line">		<span class="symbol">S</span>[<span class="number">9</span>]*<span class="symbol">S</span>[<span class="number">6</span>]*<span class="symbol">S</span>[<span class="number">42</span>] +</span><br><span class="line">		<span class="symbol">S</span>[<span class="number">59</span>]*<span class="symbol">S</span>[<span class="number">26</span>]*<span class="symbol">S</span>[<span class="number">55</span>] +</span><br><span class="line">		<span class="symbol">S</span>[<span class="number">42</span>]*<span class="symbol">S</span>[<span class="number">41</span>]*<span class="symbol">S</span>[<span class="number">29</span>] +</span><br><span class="line">		<span class="symbol">S</span>[<span class="number">58</span>]*<span class="symbol">S</span>[<span class="number">24</span>]*<span class="symbol">S</span>[<span class="number">28</span>]</span><br><span class="line">		)</span><br><span class="line"></span><br><span class="line">enc = long_to_bytes(int(<span class="symbol">KEY</span>, <span class="number">2</span>))</span><br><span class="line">f = open(<span class="string">'flag.enc'</span>, <span class="string">'wb'</span>)</span><br><span class="line">f.write(enc)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<p>是没有解出来的题目，那么，就留给大佬了~</p>

      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。可联系QQ 643713081，也可以邮件至 643713081@qq.com </span>
    </div>
</article>


<p>
    <a  class="dashang" onclick="dashangToggle()">赏</a>
</p>


<div class="article_copyright">
    <p><span class="copy-title">文章标题:</span>2022 CryptoCTF</p>
    <p><span class="copy-title">文章字数:</span><span class="post-count">16.8k</span></p>
    <p><span class="copy-title">本文作者:</span><a  title="Van1sh">Van1sh</a></p>
    <p><span class="copy-title">发布时间:</span>2022-09-14, 17:16:00</p>
    <p><span class="copy-title">最后更新:</span>2023-01-31, 16:22:22</p>
    <span class="copy-title">原始链接:</span><a class="post-url" href="/2022/09/14/2022 cryptoctf/" title="2022 CryptoCTF">http://jayxv.github.io/2022/09/14/2022 cryptoctf/</a>
    <p>
        <span class="copy-title">版权声明:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
    </p>
</div>





    




    </div>
    <div class="copyright">
        <p class="footer-entry">©2020 Van1sh</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full"><span class="min "></span></button>
<button class="post-toc-menu"><span class="post-toc-menu-icons"></span></button>
<div class="post-toc"><span class="post-toc-title">目录</span>
    <div class="post-toc-content">

    </div>
</div>
<a class="" id="rocket" ></a>

    </div>
</div>
<div class="acParent"></div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">×</a>
    <div class="shang_tit">
        <p>喜欢就点赞,疼爱就打赏</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="扫码支持">
            <img src="/img/weixin.jpg" class="weixin" title="扫码支持">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">支付宝</label></span><span><label><input type="radio" name="pay" value="weixin">微信</label></span>
    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.0.1" ></script>

<script src="/js/script.js?v=1.0.1" ></script>
<script>
    var img_resize = 'default';
    /*作者、标签的自动补全*/
    $(function () {
        $('.search').AutoComplete({
            'data': ['@Van1sh','@FzWjScJ','#Write Up','#docker','#Sage','#CTF','#ECC','#TLS 1.2','#Crypto','#Paillier','#Web','#Files','#Serialization','#Lattice','#Dsa','#LCG','#Rc4','#SM4','#paper','#small private exponent','#SQL','#python','#Knapsack','#Rsa','#continued_fraction','#RE','#DES','#差分密码分析','#操作模式','#number theory','#Abstract algebra','#ETH','#SPN','#线性密码分析','#Book','#Shadowsocks','#Nmap','#XSS','#Linux','#Coppersmith’s Method','#book',],
            'itemHeight': 20,
            'width': 418
        }).AutoComplete('show');
    })
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $(".post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
        .nav .hide-list.fullscreen {
            left: 492px
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    
    .post .pjax article .article-entry>ol, .post .pjax article .article-entry>ul, .post .pjax article>ol, .post .pjax article>ul{
        border: #e2dede solid 1px;
        border-radius: 10px;
        padding: 10px 32px 10px 56px;
    }
    .post .pjax article .article-entry li>ol, .post .pjax article .article-entry li>ul,.post .pjax article li>ol, .post .pjax article li>ul{
        padding-top: 5px;
        padding-bottom: 5px;
    }
    .post .pjax article .article-entry>ol>li, .post .pjax article .article-entry>ul>li,.post .pjax article>ol>li, .post .pjax article>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    .post .pjax article .article-entry li>ol>li, .post .pjax article .article-entry li>ul>li,.post .pjax article li>ol>li, .post .pjax article li>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    
    .nav-right:before {
        content: ' ';
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        opacity: 0.3;
        background: url("https://i.loli.net/2019/07/22/5d3521411f3f169375.png");
        background-repeat: no-repeat;
        background-position: 50% 0;
        -ms-background-size: cover;
        -o-background-size: cover;
        -moz-background-size: cover;
        -webkit-background-size: cover;
        background-size: cover;
    }
    

    
</style>







</html>
